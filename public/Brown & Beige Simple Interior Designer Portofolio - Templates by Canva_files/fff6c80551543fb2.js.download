(globalThis["webpackChunk_canva_web"] = globalThis["webpackChunk_canva_web"] || []).push([[97954],{

/***/ 584145:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(523875);__web_req__(898738);__web_req__(251378);globalThis._456c437108d2d2713799e19380be528d = globalThis._456c437108d2d2713799e19380be528d || {};(function(__c) {var Y;var Ew;var Zp=__c.Zp;var x=__c.x;var p=__c.p;var t=__c.t;var q=__c.q;var pj=__c.pj;var B=__c.B;var ox;var T;var Ww;var qb=__c.qb;var kx;var ba=__c.ba;var Cv;var Sw;var Ow;var Nw;var Kw;var xw;var sw;var tw;var di=__c.di;var g=__c.g;var mv;var Bv;var Av;var zv;var yv;var n=__c.n;var oa=__c.oa;var na=__c.na;var Ke=__c.Ke;
var pwb,qwb,rwb,swb,nv,twb,pv,qv,rv,uwb,vwb,sv,wwb,tv,uv,ywb,vv,zwb,wv,Cwb,Ewb,Dwb,Fwb,Gwb,xv,Hwb,Jwb,Lwb,Bwb,Dv,Ev,Mwb,Nwb,Owb,Pwb,Qwb,Rwb,Swb,Twb,Uwb,Vwb,Wwb,Xwb,Ywb,Zwb,$wb,axb,Fv,bxb,cxb,Gv,dxb,gxb,exb,fxb,Iv,jxb,Jv,ixb,kxb,lxb,mxb,hxb,nxb,oxb,qxb,rxb,Kv,uxb,wxb,Lv,Mv,zxb,xxb,yxb,Bxb,Cxb,Nv,Gxb,Hxb,Ov,Ixb,Jxb,Kxb,Lxb,Pv,Qv,Rv,Mxb,Nxb,Tv,Oxb,Pxb,Qxb,Rxb,Sxb,Vv,Txb,Uxb,Vxb,Wxb,Xxb,Zv,$v,aw,Yxb,bw,$xb,cw,Zxb,dw,ayb,ew,fw,byb,cyb,dyb,iw,eyb,kw,jw,fyb,lw,mw,nw,ow,pw,hyb,iyb,qw,kyb,uw,vw,ww,ryb,tyb,
xyb,vyb,wyb,yyb,zyb,Ayb,Byb,Fyb,Gyb,Hyb,Cw,Iyb,Jyb,Kyb,Lyb,Nyb,Oyb,Myb,Pyb,Ryb,Tyb,Xyb,Yyb,azb,bzb,dzb,gzb,hzb,lzb,pzb,Iw,vzb,xzb,zzb,Lw,Mw,Bzb,Czb,Dzb,Fzb,Izb,Kzb,Lzb,Mzb,Nzb,Pzb,Qzb,Tzb,Vzb,Wzb,Xzb,Yzb,Zzb,aAb,bAb,cAb,dAb,eAb,fAb,hAb,jAb,lAb,uAb,vAb,xAb,yAb,Vw,gyb,zw,Dyb,Xw,Bw,Yw,zAb,Cyb;
__c.owb=function(a={}){return __c.Le(Ke(Ke(Ke(__c.Ge(Ke(Ke(Ke(__c.He("/design/play"),"type",a.oa),"category",a.Ba),"template",a.qe),a.dimensions&&{width:a.dimensions.width,height:a.dimensions.height,units:a.dimensions.units&&__c.qAa(a.dimensions.units)}),"locale",a.locale),"ui",a.za),"layoutQuery",a.eqc))};pwb=function(a){if(a==null||typeof a==="symbol")return String(a);try{return JSON.stringify(a)}catch(b){return String(a)}};
mv=__c.mv=function(a,b,c){var d=[];if(a!==b)throw Error(c==null?__c.ka("{} != {}",pwb(a),pwb(b)):__c.ka(c,...d));};qwb=function(a){const b=new WeakMap;return(c,...d)=>{na(d.length===0);b.has(c)||b.set(c,a(c));return b.get(c)}};rwb=function(a,b){const c=new Map;for(const [d,e]of a){const [f,h]=b(d,e);c.set(f,h)}return c};
swb=function(a,b){na(b.length>0);switch(b.length){case 1:return b[0];case 2:return a.lg(b[0],b[1]);case 3:return a.lg(a.lg(b[0],b[1]),b[2]);case 4:return a.lg(a.lg(b[0],b[1]),a.lg(b[2],b[3]));default:const c=b.slice();for(b=b.length;b>1;){let d=0;for(let e=0;e<b;e+=2)c[d++]=e+1<b?a.lg(c[e],c[e+1]):c[e];b=d}return c[0]}};nv=function(a,b,c){na(a.ni(b,c),"{} != {}",b,c)};twb=function(a,b){return new ov(b(a.Ip),b(a.gq),a.qga,a.yla)};pv=function(a,b){return new ov(a,b,!1,!1)};
qv=function(a){return new ov(void 0,a,!0,!1)};rv=function(a,b){a.qga||(a.qga=b.qga);a.yla||(a.yla=b.yla);return b};uwb=function(a,b=!0){a.qga||(a.qga=b)};vwb=function(a,b=!0){a.yla||(a.yla=b)};sv=function(a){return{type:0,length:a}};wwb=function(a){return{type:1,length:a}};tv=function(a,b){return a.my(1,b).length};
uv=function(a,b){var c=Array.from(b).sort((f,h)=>f-h);if(!c.length)return xwb;na(c[0]>=0);b=new Map;a=a.Fc(c[c.length-1],0);let d=0,e=0;for(const f of c){for(c=a.head;d<f;){oa(c!=null);switch(c.type){case 0:c=a.xu(Math.min(f-d,c.length));d+=c;e+=c;break;case 1:e+=tv(a,c.length);break;default:throw new n(c);}c=a.head}c?.type===1&&(e+=tv(a,c.length));if(d!==f)throw Error();b.set(d,e)}return b};
ywb=function(a,b){var c=Array.from(b).sort((f,h)=>f-h);if(!c.length)return xwb;na(c[0]>=0);b=new Map;a=a.Fc(0,c[c.length-1]);let d=0,e=0;for(const f of c){for(c=a.head;e<f;){oa(c!=null);switch(c.type){case 0:c=a.xu(Math.min(f-e,c.length));d+=c;e+=c;break;case 1:e+=tv(a,Math.min(f-e,c.length));break;default:throw new n(c);}c=a.head}if(e!==f)throw Error();b.set(e,d)}return b};vv=function(a,b){return a?b?(...c)=>{a(...c);b(...c)}:a:b};zwb=function(a){return JSON.stringify(a,(b,c)=>c??null)};wv=function(a){return new Awb(a.PIc)};
Cwb=function(a,b,c,d){var e=Math.max(a.Tn,b.Tn),f=Math.max(a.tw,b.tw);a=a.Fc(void 0,e,f);b=b.Fc(void 0,e,f);e=a.head;for(f=b.head;e||f;){if(e&&e.type===0||f&&f.type===0){const r=a.$s(),u=b.$s(),w=c.$s();e=r;f=u;for(var h=w,k=d,l=e.head,m=f.head;l||m;){if(l&&l.type===0||m&&m.type===0){l=e.cr();m=f.cr();for(const y of Bwb(l,m))h.tc(y,k(y,e.attrs[y],f.attrs[y]))}else if(l&&m)l=Math.min(l.length,m.length),e.fl(l),f.fl(l),h.iy(l);else throw Error(`length mismatch: ${l} x ${m}`);l=e.head;m=f.head}r.finish();
u.finish();w.finish()}else if(e&&f)e=Math.min(e.length,f.length),xv(a,e),xv(b,e),c.rows(e);else throw Error(`length mismatch: ${e} x ${f}`);e=a.head;f=b.head}a.finish();b.finish()};Ewb=function(a,b,c,d){return a.axis.isIdentity(c)&&a.axis.isIdentity(d)||b.items.isEmpty()?b:Dwb("apply",a.PIc,b,c,d)};
Dwb=function(a,b,c,d,e){const f=new yv,[h,k]=a==="apply"?[c.items.Fc(e.pre),e.Fc(c.items.length,0)]:[c.items.Fc(e.post),e.Fc(0,c.items.length)];e=h.head;var l=k.head;for(c=0;e||l;){if(l&&l.type===1)tv(k,l.length),a==="apply"?f.um(l.length):h.fl(l.length);else if(e&&e.type===0){e=h.cr();const [r,u]=a==="apply"?[e.Fc(d.pre),d.Fc(e.length,0)]:[e.Fc(d.post),d.Fc(0,e.length)];e=a;l=new yv;var m=r.head;let w=u.head;for(;m||w;){if(w&&w.type===1)tv(u,w.length),e==="apply"?l.um(w.length):r.fl(w.length);else if(m)m.type===
0?l.grad(r.cr()):w?(m=Math.min(m.length,w.length),r.fl(m),u.xu(m),l.um(m)):(r.fl(m.length),l.um(m.length));else throw Error(`length mismatch: ${m} vs ${w}`);m=r.head;w=u.head}e=l.build();e.isEmpty()||(f.grad(e),c=Math.max(c,e.length));r.finish();u.finish()}else if(e&&l)e=Math.min(l.length,e.length),h.fl(e),k.xu(e),f.um(e);else throw Error("length mismatch");e=h.head;l=k.head}h.finish();k.finish();a=f.build();return zv.of(b,a,c,a.length)};Fwb=function(a){return{type:1,length:a}};
Gwb=function(a,b,c){a=a.Fc(b);b=a.head;let d=0;for(;b;)d=b.type!==0&&a.lHd?d+xv(a,b.length):d+a.iyb((e,f)=>c(e,d,f)),b=a.head;a.finish()};xv=function(a,b){oa(a.sP==null);return a.uBa.fl(b)};Hwb=function(a,b,c,d){return c===d?!0:c&&d?a(b,c.nU,d.nU)&&a(b,c.r,d.r):!1};__c.Iwb=function(a,b,c,d){if(!d)return c;na(a(b,c,d.nU),"{} != {}",c,d.nU);return d.r};Jwb=function(a,b,c,d){return Hwb(a,b,c,d)?void 0:{t:c,b:d}};
__c.Kwb=function(a,b,c){const d={};if(b&&c)for(const f of Bwb(b,c)){var e=Jwb(a,f,b[f],c[f]);e&&(d[f]=e)}else if(b)for(e of Av(b))(c=Jwb(a,e,b[e]))&&(d[e]=c);else if(c)for(const f of Av(c))(b=Jwb(a,f,void 0,c[f]))&&(d[f]=b);return Bv(d)?void 0:d};Lwb=function(a,b,c){return Bwb(b,c).every(d=>{var e=b&&b[d],f=c&&c[d];return e===f?!0:e&&f?Hwb(a,d,e.t,f.t)&&Hwb(a,d,e.b,f.b):!1})};Av=__c.Av=function(a){return Object.keys(a)};
Bwb=function(a,b){return a&&b?[...(new Set([...Av(a),...Av(b)]))]:a?Av(a):b?Av(b):[]};Bv=__c.Bv=function(a){return Av(a).length===0};Cv=__c.Cv=function(a,b){na(Object.getPrototypeOf(a)===Object.prototype);const c={};for(const d in a)c[d]=b(a[d],d);return c};Dv=function(a){return Object.keys(a)};Ev=function(a,b,c){for(const [d,e]of Object.entries(a))c(d,e,b[d])};Mwb=function(a,b){return a.length?b.length?[...(new Set([...a,...b]))]:a:b};
Nwb=function(a,b){const c=Dv(a),d=Dv(b),e=Mwb(c,d);return e.length===c.length&&e.length===d.length&&e.every(f=>a[f]===b[f])};Owb=function(a,b){return{type:0,dB:a,DC:b}};Pwb=function(a){return{type:1,length:a}};Qwb=function(a,b){return a&&b?a.sI===b.sI&&a.rI===b.rI:!a&&!b};Rwb=function(a){return a&&{ao:a.dW,sI:a.rI,dW:a.ao,rI:a.sI}};Swb=function(a,b){Object.entries(a).forEach(([c,d])=>d!=null&&b(d,c))};Twb=function(a){var b=Rwb;const c={};Swb(a,({r:d},e)=>c[e]={r:b(d,e)});return c};
Uwb=function(a,b){const c=Dv(a),d=Dv(b);if(a===b||!c.length&&!d.length)return!0;if(c.length!==d.length)return!1;const e=Mwb(c,d);return c.length===e.length&&d.length===e.length&&e.every(f=>Qwb(a[f].r,b[f].r))};Vwb=function(a,b,c,d){const e={};for(const f of Mwb(Dv(c),Dv(d)))c=a[f],d=b[f],c?d&&(mv(c.dW,d.ao),mv(c.rI,d.sI),c={ao:c.ao,sI:c.sI,dW:d.dW,rI:d.rI}):c=d,e[f]={r:c};return e};
Wwb=function(a,b,c,d){const e={},f={},h=ov.un();for(const k of Mwb(Dv(c),Dv(d))){c=a[k];d=b[k];c&&d?(mv(c.ao,d.ao),mv(c.sI,d.sI),c=qv({ao:d.dW,sI:d.rI,dW:c.dW,rI:c.rI})):c=pv(d,c);const {Ip:l,gq:m}=rv(h,c);f[k]={r:l};e[k]={r:m}}return h.build(f,e)};Xwb=function(a,b={}){return{type:0,length:a,xC:b}};
Ywb=function(a,b,c,d,e){const f={};if(a.G2a.size){for(const h of a.G2a)f[h]={r:void 0},delete a.aNa[h],delete a.bNa[h];a.G2a.clear()}Object.keys(a.I2a).length&&(Ev(a.I2a,a.Pnb,(h,k,l)=>{f[h]={r:{ao:d[h],sI:e[h],dW:k,rI:l}};a.aNa[h]=k;a.bNa[h]=l}),a.I2a={},a.Pnb={});b&&c&&Ev(b,c,(h,k,l)=>{h in a.aNa&&(f[h]={r:{ao:k,sI:l,dW:a.aNa[h],rI:a.bNa[h]}})});return f};Zwb=function(a,b,c){return c&&{ao:c.o,dW:c.n,sI:c.o!=null?a.kCa.encode(b,c.o):void 0,rI:c.n!=null?a.kCa.encode(b,c.n):void 0}};
$wb=function(a,b){const c={};for(const [d,e]of Object.entries(b))e&&(c[d]={r:Zwb(a,d,e.r)});return c};axb=function(a,b,c){const d=a.bHa;if(d){a.bHa=void 0;var e=new Set;Swb(d,({r:f},h)=>{f?(a.mode==="apply"?(mv(c[h],f.sI),a.NZ.tc(h,f.dW,f.rI)):(mv(c[h],f.rI),a.NZ.tc(h,f.ao,f.sI)),a.open.add(h),e.add(h)):(a.NZ.tc(h,b[h],c[h]),a.open.delete(h))});return e}};Fv=function(a,b,c,d){oa(0<=a);oa(0<=b);oa(a<=c);oa(b<=d);return{left:a,top:b,right:c,bottom:d}};
bxb=function(a){const b=a.rows[a.y];if(b!=null)for(;b.cells[a.x]==null&&a.x<b.cells.length;)a.x++};cxb=function(a){for(;a.rows[a.y]==null&&a.y<a.rows.length;)a.y++};Gv=function(a,b){return a.right===b.right&&a.bottom===b.bottom};
dxb=function(a,b,c,d){if(a.axis.isIdentity(c)&&a.axis.isIdentity(d))return b;const e=new Set,f=new Set;b.forEach((m,r,u)=>{e.add(m);f.add(r);switch(u.type){case 1:u.bounds&&e.add(u.bounds.o.right);u.bounds&&f.add(u.bounds.o.bottom);u.bounds&&e.add(u.bounds.n.right);u.bounds&&f.add(u.bounds.n.bottom);break;case 0:u.o&&e.add(u.o.right);u.o&&f.add(u.o.bottom);u.n&&e.add(u.n.right);u.n&&f.add(u.n.bottom);break;default:throw new n(u);}});const h=uv(c,e),k=uv(d,f),l=new Hv;b.forEach((m,r,u)=>{switch(u.type){case 1:l.add(g(h.get(m)),
g(k.get(r)),a.update(u.bounds&&{o:{right:g(h.get(u.bounds.o.right)),bottom:g(k.get(u.bounds.o.bottom))},n:{right:g(h.get(u.bounds.n.right)),bottom:g(k.get(u.bounds.n.bottom))}},u.delta));break;case 0:l.add(g(h.get(m)),g(k.get(r)),a.replace(u.o&&{right:g(h.get(u.o.right)),bottom:g(k.get(u.o.bottom)),state:u.o.state},u.n&&{right:g(h.get(u.n.right)),bottom:g(k.get(u.n.bottom)),state:u.n.state}));break;default:throw new n(u);}});return l.build()};
gxb=function(a,b,c){const d=new Hv;exb(b.Fc(),c.Fc(),(e,f,h,k)=>{b==null&&c==null||d.add(e,f,fxb(a,h,k))});return d.build()};exb=function(a,b,c){var d=a.head;let e=b.head;for(;d||e;){d=d==null?1:e==null?-1:d===e||d.y===e.y&&d.x===e.x?0:d.y<e.y||d.y===e.y&&d.x<e.x?-1:1;if(d<0){const {x:f,y:h,value:k}=a.yC();c(f,h,k,void 0)}else if(d>0){const {x:f,y:h,value:k}=b.yC();c(f,h,void 0,k)}else{const {x:f,y:h,value:k}=a.yC();({value:d}=b.yC());c(f,h,k,d)}d=a.head;e=b.head}a.finish();b.finish()};
fxb=function(a,b,c){if(b==null)return c;if(c==null)return b;switch(b.type){case 0:a:switch(c.type){case 1:oa(b.n!=null);c.bounds&&oa(Gv(b.n,c.bounds.o));a=a.replace(b.o,{...(c.bounds?c.bounds.n:b.n),state:c.delta?a.component.apply(b.n.state,c.delta):b.n.state});break a;case 0:oa(Iv(a,b.n,c.o));a=a.replace(b.o,c.n);break a;default:throw new n(c);}return a;case 1:a:switch(c.type){case 1:b.bounds&&c.bounds&&oa(Gv(b.bounds.n,c.bounds.o));const d=b.bounds&&c.bounds?{o:b.bounds.o,n:c.bounds.n}:b.bounds||
c.bounds;b=b.delta&&c.delta?a.component.lg(b.delta,c.delta):b.delta||c.delta;a=a.update(d,b);break a;case 0:oa(c.o!=null);b.bounds&&oa(Gv(b.bounds.n,c.o));a=a.replace({...(b.bounds?b.bounds.o:c.o),state:b.delta?a.component.rj(c.o.state,b.delta):c.o.state},c.n);break a;default:throw new n(c);}return a;default:throw new n(b);}};Iv=function(a,b,c){return b===c?!0:b&&c?Gv(b,c)&&a.component.ni(b.state,c.state):!1};
jxb=function(a,b,c,d,e,f){const h=d.type===0?d.n:d.bounds&&d.bounds.n,k=h?h.bottom:c;for(let r=Math.max(c,f.fNc);r<=k;r++)hxb(f,r*2),f.$s(),f.iyb((u,w)=>{e.append(Fv(u,w,u,w))}),f.xSa();f.fNc<=k&&hxb(f,(k+1)*2);if(h==null)return{dPa:b}=ixb(e,{left:b,top:c,right:b,bottom:c}),b?a.replace(void 0,void 0):void 0;const {dPa:l,pkb:m}=ixb(e,{left:b,top:c,right:h.right,bottom:h.bottom});if(l){if(m)return a.update({o:{right:h.right,bottom:h.bottom},n:m},void 0);oa(d.type===0);return a.replace(d.n,void 0)}};
Jv=function(a,b){kxb(a,b.left,b.top);a.append(b)};ixb=function(a,b){kxb(a,b.left,b.top);if(a.readBuffer(b.left,b.top))return{dPa:!0,pkb:void 0};let c=b.left,d=b.top;for(var e=b.left+1;e<=b.right;e++){if(a.readBuffer(e,b.top))return{dPa:!0,pkb:{right:c,bottom:d}};c=e}for(e=b.top+1;e<=b.bottom;e++){for(let f=b.left;f<=c;f++)if(a.readBuffer(f,e))return{dPa:!0,pkb:{right:c,bottom:d}};d=e}return{dPa:!1,pkb:void 0}};
kxb=function(a,b,c){c>a.Npb&&(a.buffer.splice(0,c-a.Npb),a.Npb=c,a.f4a=0);b>a.f4a&&a.buffer[0]&&(a.buffer[0].splice(0,b-a.f4a),a.f4a=b)};lxb=function(a,b,c){c-=a.Npb;a=c===0?b-a.f4a:b;oa(c>=0&&a>=0);return{bNc:a,cNc:c}};mxb=function(a,b){a=a.axis.Bd();b=b.Fc();let c=b.head;for(;c;){switch(c.type){case 0:a.Ob(c.length*2);b.xu(c.length);break;case 1:a.expand(c.length*2);tv(b,c.length);break;default:throw new n(c);}c=b.head}return a.build()};
hxb=function(a,b){for(oa(b>=a.o$);b>a.o$;){var c=a.Fc.head;oa(c!=null);c.type===0?(a.$s(),a.xSa()):(c=Math.min(c.length,b-a.o$),xv(a.Fc,c),a.o$+=c)}};nxb=function(a,b){return a===b||a.size===b.size&&Array.from(a.keys()).every(c=>a.get(c)===b.get(c))};oxb=function(a,b){if(!a.size)return b;if(!b.size)return a;const c=new Map;for(const [e,f]of a){var d=b.get(e)||0;(d=f+d)&&c.set(e,d)}for(const [e,f]of b)a.has(e)||c.set(e,f);return c};
qxb=function(a,b,c){return c==null||a.component.isIdentity(c)?pxb:new Map([[b,c]])};rxb=function(a,b){return a.size?b.size?new Set([...a.keys(),...b.keys()]):a.keys():b.keys()};Kv=function(a){return a===1?sxb:{type:0,length:a}};uxb=function(a){return a===1?txb:{type:1,length:a}};wxb=function(a){return a===1?vxb:{type:2,length:a}};Lv=function(a,b){return{type:3,state:a,shift:b}};Mv=function(a,b){return{type:4,delta:a,shift:b}};
zxb=function(a){switch(a.type){case 0:return`R(${a.length})`;case 1:return`X(${a.length})`;case 2:return`T(${a.length})`;case 3:return`I(${xxb(a.state)})${yxb(a.shift)}`;case 4:return`U(${xxb(a.delta)})${yxb(a.shift)}`;default:throw new n(a);}};xxb=function(a){return a!=null?a:"\u22a5"};yxb=function(a){return a!=null?`[${a.La},${a.zj}]`:""};
Bxb=function(a,b){return b&&a.Nva?new Axb(a.Jb.map(c=>c.type===3&&c.shift?Lv(c.state,{La:c.shift.La+b,zj:c.shift.zj+b}):c.type===4&&c.shift?Mv(c.delta,{La:c.shift.La+b,zj:c.shift.zj+b}):c),a.pre,a.post,a.Nva):a};Cxb=function(a,b){na(b.length>0);const c=a.length;b.forEach((d,e)=>a.list[c+e]=d);a.length+=b.length};Nv=function(a,b){const c=g(a.Pj);if(c.type===0)return a.my(0,1),Dxb;if(c.type===1)return a.my(1,1),Exb;if(c.type===2)return a.my(2,1),Fxb;if(c.type!==b)throw Error();a.Pj=a.Jb[a.i++];return c};
Gxb=function(a){return a.every(()=>!1)};Hxb=function(a){na(a.Csa<a.input.length,"{} >= {}",a.Csa,a.input.length);return a.input[a.Csa++]};Ov=function(a,b){b=a.Csa+b;na(b<=a.input.length);const c=a.input.slice(a.Csa,b);a.Csa=b;return c};Ixb=function(a,b){a.cXa||(a.cXa=new Set);na(!a.cXa.has(b),"duplicate modification: {}",b);a.cXa.add(b)};Jxb=function(a,b,c){Ixb(a,b);(a.fUb||(a.fUb=new Map)).set(b,c)};Kxb=function(a,b,c){Ixb(a,b);(a.eUb||(a.eUb=new Map)).set(b,c)};
Lxb=function(a,b){let {La:c,zj:d}=b;var e=a.fUb;a=a.eUb;if(e){const f=e.get(c);f!=null&&(c=f,e.delete(c))}a&&(e=a.get(d),e!=null&&(d=e,a.delete(d)));return c!==b.La||d!==b.zj?{La:c,zj:d}:b};Pv=function(a,b,c){Ixb(a,b);c!=null&&(a.Qob||(a.Qob=new Map)).set(b,c)};Qv=function(a,b,c){(a.eKa||(a.eKa=new Map)).set(b,c)};Rv=function(a,b,c){(a.zJa||(a.zJa=new Map)).set(c,b)};Mxb=function({La:a,zj:b}){return{La:b,zj:a}};Nxb=function(a,b){return a?!!b&&a.La===b.La&&a.zj===b.zj:!b};
Tv=function(a,b,c,d){a.Fj.set(b,new Sv(c,d));return a};Oxb=function(a,b,c,d){a.Fj.set(b,new Uv(c,d));return a};Pxb=function(a,b){return a.size?b.size?new Set([...a.keys(),...b.keys()]):a.keys():b.keys()};
Qxb=function(a,b,c){if(a.axis.isIdentity(c))return b;a=new Set;for(const e of b.values())switch(e.type){case 0:e.oldValue!=null&&a.add(e.oldValue);e.newValue!=null&&a.add(e.newValue);break;case 1:a.add(e.oldValue);a.add(e.newValue);break;default:throw new n(e);}const d=uv(c,a);return di(b,e=>{switch(e.type){case 0:return new Sv(e.oldValue!=null?g(d.get(e.oldValue)):void 0,e.newValue!=null?g(d.get(e.newValue)):void 0);case 1:return new Uv(g(d.get(e.oldValue)),g(d.get(e.newValue)));default:throw new n(e);
}})};Rxb=function(a,b){a=a.length;na(0<=b&&b<a,"{} \u2209 [0, {})",b,a)};Sxb=function(a,b){a=a.length;na(0<b&&b<a,"{} \u2209 (0, {})",b,a)};Vv=function(a){return a>0?0:a===0?1:2};Txb=function(a){na(!0);for(const b of a.sequence){const c=Vv(b);switch(c){case 0:return a.Gf[0].startsWith("\n");case 2:break;case 1:return!1;default:throw new n(c);}}return!1};
Uxb=function(a){const b=a.sequence.length?a.sequence[a.rWd++]:void 0;if(b!=null){var c=Vv(b);switch(c){case 0:return a=a.Gf[a.R7c++],mv(a.length,b),new Wv(a);case 1:return new Xv(a.items[a.yAd++]);case 2:return new Yv(-b);default:throw new n(c);}}};Vxb=function(a,b){return a?b?{ud:vv(a.ud,b.ud),item:vv(a.item,b.item),lm:vv(a.lm,b.lm)}:a:b};Wxb=function(a,b){a=a.U1;na(0<b&&b<a,"{} \u2209 (0, {})",0,a)};Xxb=function(a,b){a=a.DU;na(0<b&&b<a,"{} \u2209 (0, {})",0,a)};
Zv=function(a,b,c){switch(b.type){case 0:case 1:switch(c.type){case 0:case 1:return a.jp(b.state,c.state);case 2:return a.rQ(b.state);default:throw new n(c);}case 2:switch(c.type){case 0:case 1:return a.cfa(c.state);case 2:return a.eV(b.state);default:throw new n(c);}default:throw new n(b);}};$v=function(a){const b=g(a.Pj);a.Pj=a.Jb[a.i++];return b};aw=function(a,b){const c=g(a.Pj),d=c.U1;na(0<b&&b<=d);if(b<d){const [e,f]=c.Nmb(b);a.Pj=f;return e}a.Pj=a.Jb[a.i++];return c};
Yxb=function(a,b){const c=g(a.Pj),d=c.DU;na(0<b&&b<=d);if(b<d){const [e,f]=c.Mmb(b);a.Pj=f;return e}a.Pj=a.Jb[a.i++];return c};bw=function(a,b,c){switch(c.type){case 0:return b;case 1:return na(b.type===1),new Xv(a.component.apply(b.state,c.delta));case 3:return Zxb(a,b,c.oldState),c.newState;default:throw new n(c);}};
$xb=function(a,b,c){switch(c.type){case 0:return b;case 1:return na(b.type===1),new Xv(a.component.rj(b.state,c.delta));case 3:return Zxb(a,b,c.newState),c.oldState;default:throw new n(c);}};cw=function(a,b,c){switch(b.type){case 0:return c.type===0&&b.state===c.state;case 1:return c.type===1&&a.component.ni(b.state,c.state);case 2:return c.type===2&&b.state===c.state;default:throw new n(b);}};Zxb=function(a,b,c){na(cw(a,b,c),"{} != {}",b,c)};dw=function(a){return{start:`${"a/"}${a}`,end:`${"b/"}${a}`}};
ayb=function(a){oa(a.startsWith("a/")||a.startsWith("b/"));return a.substring(2)};ew=function(a){return typeof a==="string"?a.length:1};fw=function(a,b){return a?!!b&&a.from===b.from&&a.to===b.to:!b};byb=function(a,b){let c=0,d=0;for(const e of a.a5)switch(a=e.length,e.type){case 0:b.Ob&&b.Ob(a,c,d);c+=a;d+=a;break;case 1:b.insert&&b.insert(a,c,d);d+=a;break;default:throw new n(e.type);}};cyb=function(a,b,c){let {from:d,to:e}=a;d+=d>b?c:0;e+=e>b?c:0;return a.from!==d||a.to!==e?new gw(d,e):a};
dyb=function(a,b,c){for(const [d,e]of a){const f=cyb(e,b,c);f!==e&&a.set(d,f)}};iw=function(a,b,c,d){for(const [e,f]of a){const h=f.V1,k=f.O1,l=h&&(b!=null?cyb(h,b,d):h),m=k&&(c!=null?cyb(k,c,d):k);l===h&&m===k||a.set(e,new hw(l,m))}};eyb=function(a,b){return a.size?b.size?new Set([...a.keys(),...b.keys()]):a.keys():b.keys()};kw=function(a,b,c,d){const {x:e,y:f,...h}=b;na(a.axis.Bi(e,jw(a,c)));na(a.axis.Bi(f,jw(a,d)));return h};
jw=function(a,b){const c=a.axis.Bd();b.Jb.forEach(d=>{switch(d.type){case 0:c.Ob(d.length);break;case 1:c.expand(d.length);break;case 2:c.Ob(d.length);break;case 3:c.expand(1);break;case 4:c.Ob(1);break;default:throw new n(d);}});return c.build()};fyb=function(a,b){mv(a,b);return a};lw=function(a,b){return{key:a.Sga(b),value:b}};mw=function(a,b,c){if(a.isIdentity(b)||a.isIdentity(c))return c;let d=a.zUa.get(b);d==null&&(d=Symbol(),a.zUa.set(b,d));a.zUa.set(c,d);return c};
nw=function(a){a=gyb(a);oa(a.isBeingObserved!=null);return a.isBeingObserved};ow=function(a,b){let c=a.rows[b];c==null&&(c=a.rows[b]=a.kHd++);return c};pw=function(a,b){let c=a.cols[b];c==null&&(c=a.cols[b]=a.hHd++);return c};hyb=function(a,b,c,d=()=>!0){a.cols.spliceWithArray(b,0,Array(c));for(let e=0;e<a.rows.length;e++){const f=a.get(e,b-1);if(f!=null&&d(f))for(let h=b;h<b+c;h++)a.set(e,h,f)}};
iyb=function(a,b,c,d=()=>!0){a.rows.spliceWithArray(b,0,Array(c));for(let e=0;e<a.cols.length;e++){const f=a.get(b-1,e);if(f!=null&&d(f))for(let h=b;h<b+c;h++)a.set(h,e,f)}};__c.jyb=function(a){return a.filter(()=>!0)};qw=function(a,b){na(Object.getPrototypeOf(a)===Object.prototype);const c={};for(const d in a)c[d]=b(a[d],d);return c};kyb=function(a){const b={};for(const c in a){const d=a[c];na(!(d in b),"non-unique value in record: {}",d);b[d]=c}return b};
sw=__c.sw=function(a,b){return a===rw?b:b===rw?a:new lyb(a,b)};tw=__c.tw=function(a,b){return new myb(a,b)};uw=function(a,...b){return b.every(c=>c===rw)?rw:new a(...b)};vw=function(a){return Object.keys(a).length===0?tw({},{}):new nyb(a)};ww=function(a,b,c){return new oyb(a,b,c)};xw=__c.xw=function(a,b){return b===void 0?uw(pyb,a):new pyb(a,b)};T=__c.T=function(a,b){const c=new qyb(d=>new a(d));return b!=null?sw(c,ryb(b)):c};__c.yw=function(a){return new qyb(b=>a.Gz(b))};
ryb=function(a){var b=zw.structural;return{serialize:c=>b(c,a)?void 0:c,deserialize:c=>c!=null?c:a}};tyb=function(a){return sw(syb,vw({oldState:a,newState:a}))};xyb=function(a,b,c,d){return ww({[0]:sw(sw(uyb,vw({delta:a})),c),[1]:sw(tyb(b),d)},vyb,wyb)};vyb=function(a){return a.type};wyb=function(a){switch(a.type){case "UPDATE":return 0;case "REPLACE":return 1;default:throw new n(a.type);}};yyb=function(a){a.Gca?.reportChanged();a.Gca=void 0};
zyb=function(a){return a.mutable==null||typeof a.mutable!=="object"?new Aw(a):new WeakRef(a)};Ayb=function(a,b){a.domain.isIdentity(b)||(a.fqa==null&&(a.fqa=[]),a.fqa.push(b),a.rz?.reportChanged())};Byb=function(a){a.fqa&&(a.Umb=a.domain.apply(a.Umb,swb(a.domain,a.fqa)),a.fqa=void 0)};Fyb=function(a){a.rz==null&&Cyb()?(a.rz=Dyb(""),a.rz[Eyb]=a,a.rz?.reportObserved(),a.vf?.fj(),Bw(a.rz,()=>{a.rz=void 0;a.vf?.fj()})):a.rz?.reportObserved()};Gyb=function(a){return a};
Hyb=function(a){oa(a.mx!=null,"mutable not connected");return a.mx};Cw=function(a){a.Eya=void 0;a.A4&&a.A4.reportChanged()};Iyb=function(a,b){oa(a.mx!=null);if(a.clients){var c=!1;for(const d of a.clients.keys())try{d.H7(b)}catch(e){try{d.onError(`could not publish to incoming: ${e}`)}catch(f){}a.clients.delete(d);c=!0}c&&!a.clients.size&&(a.clients=void 0)}};Jyb=function(a,b){if(a.clients){for(const c of a.clients.keys())try{c.onError(b)}catch(d){}a.clients=void 0}};
Kyb=function(a){return!!a.clients?.size||a.A4!=null&&nw(a.A4)||a.Wm.yj};Lyb=function(a){const b=qwb(c=>a(c));return c=>c!=null&&typeof c==="object"?b(c):a(c)};Nyb=function(a,b){Gwb(b,a.Pk.HH,(c,d,e)=>{const f=a.grid.get(d,e),h=f?{...f}:{};Myb(c,(k,l)=>{k!=null&&(oa(a.Pk.Kma(l,f?.[l],k.o)),k.n==null?delete h[l]:h[l]=k.n)});h==null||Object.keys(h).length===0?a.grid.delete(d,e):a.grid.set(d,e,h)})};
Oyb=function(a,b,c,d){const e=a.Pk.Ogb(a.Pk.cyc(b,d)),f=a.Pk.KDd(e,(k,l)=>a.Pk.jrd(e,l)),h={};a.Pk.UFb(f,b,(k,l)=>{h[l]={o:c?.[l],n:f[l]}});return h};Myb=function(a,b){for(const c of Object.keys(a))b(a[c],c)};Pyb=function(a,b){return a&&b?[...(new Set([...Object.keys(a),...Object.keys(b)]))]:a?Object.keys(a):b?Object.keys(b):[]};Ryb=function({Mz:a,tf:b}){return{cvb:c=>new Qyb(b,a.cvb(c.Kma),c,Dw,Dw)}};
Ew=__c.Ew=function(a,b){return a.Gpb(ww({[0]:tw(),[1]:sw(tyb(a.type.serializer),b)},c=>c==null?0:c.type,c=>c==null?0:1))};Tyb=function(a){return new Syb(a)};__c.Fw=function(a,b,c){return a.Gpb(xw(xyb(a.type.bE,a.type.Oi,b,c)))};
Xyb=function({Mz:a,Ci:b,tf:c}){const d=e=>new Uyb(c,a.box(a.value((f,h)=>e.As(f,h),f=>e.Ze(f))),e,Dw,e.serializer);return{tc:d,box:e=>new Vyb(c,a.box(e.domain),e,Dw,e.Oi),pf:e=>d(b.optional(e)),Pxb:e=>d(b.Qxb(e)),rKc:e=>new Wyb(c,a.box(a.value((f,h)=>e.As(f,h),f=>e.Ze(f))),e,Dw,e.serializer),Iyf:d(b.string),Om:d(b.boolean),JQa:d(b.double),q3e:d(b.int32),Xbf:d(b.VC),Ybf:d(b.P1),vXa:d(b.cA),zyc:d(b.yyc),Ytc:d(b.Xtc),zHc:d(b.yHc),$p:d(b.optional(b.string)),Yef:d(b.optional(b.boolean)),Zef:d(b.optional(b.double)),
TLd:d(b.optional(b.VC)),cff:d(b.optional(b.P1)),LQb:d(b.optional(b.cA))}};Yyb=function(a,b){return c=>{const {left:d,top:e}=b.Kwc.get();return a.domain.he({cells:(new Hv).add(d,e,a.domain.update(void 0,c)).build()})}};
azb=function(a,b,c){var d=a.grid;var e={left:pw(a.grid,c.left),top:ow(a.grid,c.top),right:pw(a.grid,c.right),bottom:ow(a.grid,c.bottom)};d=new Zyb(d,e,a);b=a.ve.yf(a.type,b,Yyb(a,d),a.vf?a:void 0);b=new $yb(b,d);for(d=c.top;d<=c.bottom;d++)for(e=c.left;e<=c.right;e++)a.grid.set(d,e,b)};
bzb=function(a,b){const c=new Hv,d=new Set;for(let e=b.top;e<=b.bottom;e++)for(let f=b.left;f<=b.right;f++){const h=a.grid.get(e,f);h==null||d.has(h)||(d.add(h),c.add(h.span.left,h.span.top,a.domain.replace({right:h.span.right,bottom:h.span.bottom,state:h.Cg.snapshot()},void 0)))}return a.domain.he({cells:c.build()})};dzb=function({Mz:a,tf:b}){return{Zza:c=>new czb(b,a.Zza(c.domain),c,Dw,Dw)}};gzb=function({Mz:a,tf:b}){return{counter:new ezb(b,a.counter,rw,rw),ltc:new fzb(b,a.ltc,rw,rw)}};
hzb=function(a,b,c){return a.ve.yf(a.valueType,c,d=>a.domain.update(b,d),a.vf?a:void 0)};__c.Gw=function(a,b,c,d){var e=a.Gpb;var f=a.keyType.serializer;c=xyb(xw(a.valueType.bE),xw(a.valueType.Oi),c,d);f=uw(izb,f,c);return e.call(a,sw(f,sw(jzb,b)))};lzb=function({Mz:a,Ci:b,tf:c}){return{Au:(...d)=>{const [e,f]=d.length===1?[b.string,d[0]]:d;return new kzb(c,a.Au(f.domain),e,f,Dw,uw(izb,e.serializer,f.Oi))}}};
__c.Hw=function(a,b){var c=a.At,d=a.values;const e=new Map;for(const f of d)na(!e.has(b[f]),"invalid literal mapping for: {}",f),e.set(b[f],f);return c.call(a,new mzb(b,e))};pzb=function({Mz:a}){return{Lv:b=>new __c.nzb(a.value((c,d)=>b.As(c,d),c=>b.Ze(c)),b,rw,b.serializer),C9c:b=>new ozb(b.domain,b.Oi)}};Iw=function(a,b){return g(a.idb.get().get(b),"ref not found")};__c.Jw=function(a,b,c,d,e,f,h,k){return a.Po(sw(new qzb(a.domain,a.type.bE,a.type.Oi,c,d,e,f,h,k),sw(jzb,b)),a.Oi)};
vzb=function({Mz:a,tf:b}){return{list:c=>new rzb(b,a.list(c.domain),c,Dw,sw(szb,new tzb(uw(uzb,c.Oi)))),Zzc:c=>new rzb(b,a.list(c.domain),c,Dw,sw(szb,new tzb(uw(uzb,c.Oi))))}};xzb=function({Mz:a}){const b=Object.freeze({serialize(c){throw new n(c);},deserialize(c){throw new n(c);}});return{never:new wzb(a.never,b,b)}};
zzb=function({Mz:a,Ci:b}){function c(d){return d instanceof Kw?b.Hwc(d):new yzb(a.option(d.domain),d,xw(d.bE),xw(d.Oi))}return{optional:c,T7:c(b.string),SLd:c(b.boolean),aff:c(b.int32),bff:c(b.Vxd),d2:c(b.double),xYa:c(b.VC),ULd:c(b.P1),Cwc:c(b.cA)}};Lw=function(a,b){let c=a.items[b];c==null&&(c=a.items[b]={});return c};Mw=function(a,b){if(b!=null)return g(a.tpc.get(b))};Bzb=function({Mz:a,tf:b}){return{qk:new Azb(b,a.qk,Dw,rw)}};
Czb=function(a,b,c){const d=a.Bd(),e=b.cursor(0,{...Nw,lm:k=>d.Ob(k)}),f={...Nw,ud:k=>d.Ob(k.length)},h={...Nw,ud:k=>d.rQ(k)};c.forEach({Ob:k=>e.Bja(k,f),delete:k=>e.Bja(k,h),insert:k=>d.insert(k)});return d.build()};
Dzb=function(a,b){const c=new Ow,d=a.cursor();a=k=>{throw Error(String(k));};const e={...Nw,ud:k=>c.Ob(k.length)},f={...Nw,ud:a},h={...Nw,ud:()=>0,lm:a};b.forEach({Ob:k=>d.fY(k,e),update:k=>{throw new n(k);},insert:k=>k.type!==2&&c.insert(k.state),jp:(k,l)=>{k.type===2?(d.fY(k.length,f),l.type!==2&&c.insert(l.state)):(d.fY(k.length,h),l.type===2?c.delete(k.length):(na(k.state===l.state,"non-reflexive change: {} != {}",k,l),c.Ob(k.length)))}});return c.build()};
Fzb=function({Mz:a,tf:b}){return{BY:new Ezb(b,a.BY(a.never),Dw,Dw)}};Izb=function({Mz:a,Ci:b}){const c=new Gzb(a.qk,a.axis,a.qj.lJ);return{qj:b.qk.map(c.wjc,c.VIc,c.xjc,c.WIc,d=>new Hzb(d,c),d=>d.base)}};Kzb=function(a,b,c,d){return Jzb.of(a,{...b,...c,...d})};Lzb=function(...a){const b=new Set;for(const c of a)for(const d in c)na(!b.has(d),'duplicate key: "{}"',d),b.add(d)};
Mzb=function(a){if(a.ez.computed==null)return{Za:{},attributes:{}};const {Za:b,attributes:c,cka:d}=a.ez.computed.create({...a.values,...a.Za,...a.attributes});return{Za:qw(a.ez.computed.Za,(e,f)=>b[f]),attributes:qw(a.ez.computed.attributes,(e,f)=>c[f]),cka:d}};Nzb=function(a,b){const c=qw(a.ez.values,(d,e)=>a.getValue(e));Object.defineProperties(c,b);Object.defineProperty(c,Pw,{enumerable:!1,writable:!1,value:a});return c};
__c.Rw=function(a,{values:b={},Za:c={},attributes:d={},computed:e}){return new Ozb(a.tf,{...a.values,...b},{...a.Za,...c},{...a.attributes,...d},Pzb(a.computed,e),a.qzb,Dw,Dw)};Pzb=function(a,b){if(!a)return b;if(!b)return a;const c=a.create,d=b.create;return{Za:{...a.Za,...b.Za},attributes:{...a.attributes,...b.attributes},create:e=>{const {Za:f,attributes:h,cka:k}=c(e),{Za:l,attributes:m,cka:r}=d({...e,...f,...h});return{Za:{...f,...l},attributes:{...h,...m},cka:k&&r?()=>{k();r()}:k||r}}}};
Qzb=function({Mz:a,tf:b}){const c=new Ozb(b,{},{},{},void 0,(d,e)=>a.value(d,e),Dw,Dw);return{La:d=>__c.Rw(c,d)}};Tzb=function({Mz:a}){return{reference:b=>new Rzb(a.reference,b),bGf:b=>new __c.Szb(b)}};
Vzb=function(a,b,c){const d=b.cells.cursor(b.length),e=new Uzb(a);a=m=>{throw Error(String(m));};const f={...Nw,ud:a},h={...Nw,ud:()=>0,lm:a},k={...Nw,ud:m=>e.Ob(m.length),lm:()=>0},l={...Nw,ud:m=>e.delete(m.length),lm:a};c.forEach({Ob:(m,r)=>{e.jp(r);d.fY(m,k)},insert:(m,r)=>{e.jp(r);m.type!==2&&e.insert(m.state)},jp:(m,r,u)=>{e.jp(u);m.type===2?(d.fY(m.length,f),r.type!==2&&e.insert(r.state)):r.type===2?d.fY(m.length,l):(na(m.state===r.state,"non-reflexive change: {} != {}",m,r),d.fY(m.length,h),
e.Ob(m.length))}});return e.build()};Wzb=function(a,b){if(!b)return{index:0,length:a.charLength};const c=b.index,d=b.index+b.length;a=a.charLength;na(c<=d,"invalid range: {}, {}",c,d);na(0<=c&&d<=a,"range out of bounds: [{}, {}) \u2288 [{}, {})",c,d,0,a);return b};Xzb=function(a,b){a.ve.tu(a.domain.he(void 0,b))};Yzb=function(a,b){na(!a.cells.nga||a.cells.ud().endsWith("\n"),"character stream must be empty or terminated with a \\n");a.forEach({...Nw,ud:(c,d)=>b.xD(d),lm:(c,d)=>b.xD(d)})};
Zzb=function({Mz:a,tf:b}){return{vUd:(c,d)=>{const e=a.PBc(a.never,void 0);return new Sw(b,e,c,d,Dw,Dw)}}};aAb=function({Mz:a,tf:b}){const c=(d,e)=>{const f=a.PBc(d.domain,a.selection);return new __c.$zb(b,f,e,d,Dw,Dw)};return{Sqf:c,wUd:c}};bAb=function(a,b){let c;for(let d=b.top;d<=b.bottom&&!(c=a.fia(d));d++);return c};cAb=function(a,b){let c;for(let d=b.left;d<=b.right&&!(c=a.eia(d));d++);return c};dAb=function(a,b){let c;for(let d=b.bottom;d>=b.top&&!(c=a.fia(d));d--);return c};
eAb=function(a,b){let c;for(let d=b.right;d>=b.left&&!(c=a.eia(d));d--);return c};fAb=function(a,b){const c=a.cT(b.YJa),d=a.gV(b.$Ja),e=a.cT(b.zDb||b.YJa);a=a.gV(b.CDb||b.$Ja);na(c!=null&&d!=null&&e!=null&&a!=null);na(d<=a&&c<=e);return{left:c,top:d,right:e,bottom:a}};hAb=function({Mz:a,Ci:b,tf:c}){return{sheet:(d,e,f,h)=>new gAb(c,a.sheet(d.domain,e.domain,f.domain,h.domain),d,e,f,h,b.qj,a.qj,b.qk,a.axis,Dw,Dw)}};
jAb=function({Mz:a}){return{Xk:(b,c,d)=>new __c.iAb(a.union(qw(b,e=>e.domain),c),b,c,d,Dw,Dw)}};lAb=function({Mz:a}){return{unit:new kAb(a.unit,rw,rw)}};
uAb=function(){const a=(C,F)=>new mAb(C,F,uw(uzb,C.serializer)),b=(C,F)=>{na(Number.isSafeInteger(C)&&Number.isSafeInteger(F)&&C<=F);return new Tw(G=>Number.isSafeInteger(G)&&C<=G&&G<=F,rw)},c=(C,F)=>{na(Number.isFinite(C)&&Number.isFinite(F)&&C<=F);return new Tw(G=>Number.isFinite(G)&&C<=G&&G<=F,rw)},d=new Tw(C=>typeof C==="boolean",rw),e=new Tw(C=>typeof C==="string",rw),f=new Tw(C=>C.length===1,rw),h=b(-2147483648,2147483647),k=new Tw(C=>Number.isSafeInteger(C),rw),l=b(0,2147483647),m=b(1,2147483647),
r=b(0,Number.MAX_SAFE_INTEGER),u=new Tw(C=>Number.isFinite(C),rw),w=c(0,Number.MAX_VALUE),y=new Tw(C=>Number.isFinite(C)&&0<C&&C<=Number.MAX_VALUE,rw),z=a(w),A=a(e);return{value:C=>new Tw(C,rw),literal:(...C)=>C.length===1?new __c.Uw(new Set(C),tw(C[0],C[0])):new __c.Uw(new Set(C),rw),xF:a,n9a:(C,F)=>new nAb(C,F,uw(izb,rw,F.serializer)),ce:(C,F)=>new oAb(C,F,Dw),DZ:(C,F)=>new pAb(C,F,Dw),Hwc:C=>new qAb(C,xw(C.serializer)),Qxb:C=>new rAb(C,xw(C.serializer)),regexp:C=>new sAb(C,rw),Uxd:b,number:c,Scf:()=>
new tAb(Dw),boolean:d,string:e,char:f,int32:h,Vxd:k,VC:l,UOd:m,P1:r,double:u,cA:w,yyc:y,Xtc:z,yHc:A}};vAb=function(a,b){const c=new Map;for(const [d,e]of a)b(e)&&c.set(d,e);return c};xAb=function({Mz:a,tf:b}){return{a0d:new wAb(b,a.w$c(),Dw,Dw)}};yAb=function(a){return new RegExp(`^${a}${"B"}${"[0-9b-df-hj-np-tv-zB-DF-HJ-NP-TV-Z]"}{14}$`)};Vw=__webpack_require__(186901);Ww=__c.Ww=Vw.EW;gyb=Vw.go;zw=Vw.m3;Dyb=Vw.MN;Xw=Vw.O8;Bw=Vw.q$;Yw=Vw.sH;zAb=Vw.tC;Cyb=Vw.Tx;var AAb=__webpack_require__(477176).B7;__webpack_require__(189630);__webpack_require__(562172);__webpack_require__(195354);__webpack_require__(257288);var BAb=__webpack_require__(536618).iB;var Zw=class{};var $w=class extends Zw{static equals(a,b){return a?!!b&&a.equals(b):!b}map(a,b,c,d){return new CAb(this.tf,this,a,b,c,d)}constructor(a){super();this.tf=a}},CAb=class extends $w{isIdentity(a){return this.component.isIdentity(this.IM(a))}lg(a,b){return this.hR(this.component.lg(this.IM(a),this.IM(b)))}transform(a,b){a=this.component.transform(this.IM(a),this.IM(b));return twb(a,c=>this.hR(c))}gj(a){return this.hR(this.component.gj(this.IM(a)))}Bi(a,b){return a===b||this.component.Bi(this.IM(a),this.IM(b))}identity(a){return this.hR(this.component.identity(this.DV(a)))}apply(a,
b){const c=this.DV(a);b=this.component.apply(c,this.IM(b));return c===b?a:mw(this.tf,a,this.bY(b))}rj(a,b){const c=this.DV(a);b=this.component.rj(c,this.IM(b));return c===b?a:mw(this.tf,a,this.bY(b))}Ze(a){return this.bY(this.component.Ze(this.DV(a)))}ni(a,b){return a===b||this.component.ni(this.DV(a),this.DV(b))}equals(a){return this===a}constructor(a,b,c,d,e,f){super(a);this.component=b;this.hR=c;this.IM=d;this.bY=e;this.DV=f}},ov=class{static un(){return new DAb}constructor(a,b,c,d){this.Ip=a;
this.gq=b;this.qga=c;this.yla=d}},DAb=class{build(a,b){return new ov(a,b,this.qga,this.yla)}constructor(){this.yla=this.qga=!1}};var GAb=class{qZ(a){if(this.mode!==a){switch(this.mode){case void 0:break;case 0:this.Jb.push(sv(this.acc));this.pre+=this.acc;this.post+=this.acc;this.acc=0;break;case 1:this.Jb.push(wwb(this.acc));this.post+=this.acc;this.acc=0;break;default:throw new n(this.mode);}this.mode=a}}accumulate(a,b=1){na(b>=0,"{} < 0",b);b&&(this.qZ(a),this.acc+=b);return this}Ob(a){return this.accumulate(0,a)}expand(a){return this.accumulate(1,a)}append(a){switch(a.type){case 0:return this.accumulate(0,a.length);case 1:return this.accumulate(1,
a.length);default:throw new n(a);}}build(){this.mode!==0&&this.qZ();return this.Jb?new EAb(this.Jb,this.pre,this.post):FAb}constructor(){this.Jb=[];this.acc=this.post=this.pre=0;this.mode=void 0}},HAb=class{static create(a,b,c,d=0,e=0){na(d>=0,"{} < 0",d);na(e>=0,"{} < 0",e);b=Math.max(0,d-b,e-c);return new HAb(b?[...a,sv(b)]:a)}get head(){return this.Pj}xu(a){return this.my(0,a).length}my(a,b=1){const c=g(this.Pj);if(c.type!==a)throw Error();const d=c.length;na(0<b&&b<=d,"{} \u2209 (0, {}]",b,d);
if(b<d)switch(a){case 0:return this.Pj=sv(d-b),sv(b);case 1:return this.Pj=wwb(d-b),wwb(b);default:throw new n(a);}else return this.Pj=this.Jb[this.i++],c}finish(){oa(this.Pj==null)}constructor(a){this.Jb=a;this.i=0;this.Pj=a[this.i++]}},EAb=class{isEmpty(){return this.pre===0&&this.post===0&&this.Jb.length===0}Fc(a,b){return HAb.create(this.Jb,this.pre,this.post,a,b)}toString(){return this.Jb.map(a=>{switch(a.type){case 0:return`R(${a.length})`;case 1:return`X(${a.length})`;default:throw new n(a);
}}).join("")}constructor(a,b,c){this.Jb=a;this.pre=b;this.post=c}},FAb=new EAb([],0,0),IAb=class extends $w{Bd(){return new GAb}isIdentity(a){return a.isEmpty()}lg(a,b){if(this.isIdentity(a))return b;if(this.isIdentity(b))return a;const c=this.Bd(),d=a.Fc(0,b.pre),e=b.Fc(a.post,0);let f=d.head,h=e.head;for(;f||h;){if(h)if(h.type===1)c.append(e.my(h.type,h.length));else if(f)if(f.type===1){var k=Math.min(f.length,h.length);d.my(f.type,k);e.my(h.type,k);c.append(wwb(k))}else k=Math.min(f.length,h.length),
d.my(f.type,k),e.my(h.type,k),c.append(sv(k));else throw Error(`length mismatch: ${a} ; ${b}`);else throw Error(`length mismatch: ${a} ; ${b}`);f=d.head;h=e.head}d.finish();e.finish();return c.build()}transform(a,b){if(this.isIdentity(a)||this.isIdentity(b))return pv(b,a);const c=a.Fc(b.pre,0),d=b.Fc(a.pre,0),e=this.Bd(),f=this.Bd();for(var h=c.head,k=d.head;h||k;){if(h?.type===1)k=c.my(h.type,h.length),f.append(sv(k.length)),e.append(k);else if(k?.type===1){var l=d.my(k.type,k.length);f.append(l);
e.append(sv(k.length))}else if(h&&k)l=Math.min(h.length,k.length),h=c.my(h.type,l),k=d.my(k.type,l),f.append(k),e.append(h);else throw Error(`length mismatch (${a} x ${b})`);h=c.head;k=d.head}c.finish();d.finish();return pv(f.build(),e.build())}gj(){return FAb}Bi(a,b){if(a===b)return!0;if(!a||!b||a.pre!==b.pre||a.post!==b.post)return!1;a=a.Fc();b=b.Fc();let c=a.head,d=b.head;for(;c||d;){if(!c||!d)return!1;switch(c.type){case 0:if(d.type!==0||c.length!==d.length)return!1;a.xu(c.length);b.xu(d.length);
break;case 1:if(d.type!==1||c.length!==d.length)return!1;tv(a,c.length);tv(b,d.length);break;default:throw new n(c);}c=a.head;d=b.head}return!0}identity(){return FAb}apply(a){return a}rj(a){return a}Ze(){}ni(a,b){return a===b}equals(a){return this===a||a instanceof IAb}},xwb=new Map;var JAb,LAb,KAb;
JAb=class extends $w{og(){return new Awb(this.xw)}uT(){return zv.empty}he(a={}){return{x:a.x||this.axis.Bd().build(),y:a.y||this.axis.Bd().build(),attrs:a.attrs||wv(this).build()}}isIdentity(a){return this.axis.isIdentity(a.x)&&this.axis.isIdentity(a.y)&&a.attrs.items.isEmpty()}lg(a,b){const c=this.axis.lg(a.x,b.x),d=this.axis.lg(a.y,b.y);a=Ewb(this,a.attrs,b.x,b.y);if(b.attrs.items.isEmpty())return this.he({x:c,y:d,attrs:a});const e=wv(this);Cwb(a,b.attrs,e,(f,h,k)=>{h?k?(oa(this.xw(f,h.n,k.o)),
f={o:h.o,n:k.n}):f=h:f=k;return f});return{x:c,y:d,attrs:e.build()}}mra(a,b,c,d){return this.axis.isIdentity(c)&&this.axis.isIdentity(d)||b.items.isEmpty()?b:Dwb(a,this.xw,b,c,d)}transform(a,b){const c=ov.un(),{Ip:d,gq:e}=rv(c,this.axis.transform(a.x,b.x)),{Ip:f,gq:h}=rv(c,this.axis.transform(a.y,b.y));a=Ewb(this,a.attrs,d,f);b=Ewb(this,b.attrs,e,h);if(a.items.isEmpty()||b.items.isEmpty()){var k=this.he({x:d,y:f,attrs:b});a=this.he({x:e,y:h,attrs:a});return c.build(k,a)}var l=Math.max(a.Tn,b.Tn),
m=Math.max(a.tw,b.tw);a=a.Fc(void 0,l,m);l=b.Fc(void 0,l,m);b=wv(this);m=wv(this);for(var r=a.head,u=l.head;r||u;){if(r&&r.type===0||u&&u.type===0){r=a.$s();u=l.$s();const A=b.$s(),C=m.$s();for(var w=r.head,y=u.head;w||y;){if(w&&w.type===0||y&&y.type===0){w=r.cr();y=u.cr();for(k of Bwb(w,y)){w=k;y=r.attrs[k];var z=u.attrs[k];y&&z?(oa(this.xw(w,y.o,z.o)),w=qv({o:z.n,n:y.n})):w=pv(z,y);const {Ip:F,gq:G}=rv(c,w);A.tc(k,G);C.tc(k,F)}}else if(w&&y)w=Math.min(w.length,y.length),r.fl(w),u.fl(w),A.iy(w),
C.iy(w);else if(w)w=w.length,r.fl(w),A.iy(w),C.iy(w);else if(y)w=y.length,u.fl(w),A.iy(w),C.iy(w);else throw Error();w=r.head;y=u.head}r.finish();u.finish();A.finish();C.finish()}else if(r&&u)r=Math.min(r.length,u.length),xv(a,r),xv(l,r),b.rows(r),m.rows(r);else if(r)r=r.length,xv(a,r),b.rows(r),m.rows(r);else if(u)r=u.length,xv(l,r),b.rows(r),m.rows(r);else throw Error();r=a.head;u=l.head}a.finish();l.finish();k=this.he({x:d,y:f,attrs:m.build()});a=this.he({x:e,y:h,attrs:b.build()});return c.build(k,
a)}gj(a){a=a.attrs.Fc();const b=wv(this);for(var c=a.head;c;){if(c.type===0){c=a.$s();const e=b.$s();for(var d=c.head;d;){if(d.type===0){d=c.cr();for(const f of Av(d))d=c.attrs[f],e.tc(f,d&&{o:d.n,n:d.o})}else d=d.length,c.fl(d),e.iy(d);d=c.head}c.finish();e.finish()}else c=c.length,xv(a,c),b.rows(c);c=a.head}return this.he({attrs:b.build()})}Bi(a,b){return this.axis.Bi(a.x,b.x)&&this.axis.Bi(a.y,b.y)&&a.attrs.equals(b.attrs)}identity(){return{x:this.axis.Bd().build(),y:this.axis.Bd().build(),attrs:wv(this).build()}}apply(a,
b){const c=this.mra("apply",a,b.x,b.y);if(b.attrs.items.isEmpty())return mw(this.tf,a,c);const d=this.og();Cwb(c,b.attrs,d,(e,f,h)=>this.I2c(e,f,h));return mw(this.tf,a,d.build())}rj(a,b){if(b.attrs.items.isEmpty())return mw(this.tf,a,this.mra("unapply",a,b.x,b.y));const c=this.og();Cwb(a,b.attrs,c,(d,e,f)=>this.g5d(d,e,f));return mw(this.tf,a,this.mra("unapply",c.build(),b.x,b.y))}Ze(a,b){if(a instanceof zv&&b==null)return a;a=a.Fc(b);const c=this.og();for(var d=a.head;d;){if(d.type===0){d=a.$s();
const f=c.$s();for(var e=d.head;e;){if(e.type===0){e=d.cr();for(const h of Av(e))(b==null||b(h))&&f.tc(h,d.attrs[h])}else e=e.length,d.fl(e),f.iy(e);e=d.head}d.finish();f.finish()}else d=d.length,xv(a,d),c.rows(d);d=a.head}return c.build()}ni(a,b){return a.equals(b)}equals(a){return this===a?!0:a instanceof JAb?this.xw===a.xw:!1}constructor(a,b,c){super(a);this.xw=b;this.axis=c;this.PIc=(d,e,f)=>{if(e===f)return!0;if(e&&f){const h=e.n,k=f.n;return this.xw(d,e.o,f.o)&&this.xw(d,h,k)}return!e&&!f};
this.I2c=(d,e,f)=>f!=null?(oa(this.xw(d,e,f.o),"{}: {} != {}",d,e,f.o),f.n):e;this.g5d=(d,e,f)=>f!=null?(oa(this.xw(d,e,f.n)),f.o):e}};
LAb=class{isEmpty(){return!this.items.length}Fc(a){return new KAb(this.items,this.length,a)}forEach(a,{grad:b,um:c}){for(const d of this.items)switch(d.type){case 0:b&&b(d.value);break;case 1:c&&c(d.length);break;default:throw new n(d);}(a=Math.max(0,a-this.length))&&c&&c(a)}equals(a,b){if(this===a)return!0;if(this.length!==a.length)return!1;const c=this.Fc();a=a.Fc();for(var d=c.head,e=a.head;d||e;){if(!d||!e)return!1;switch(d.type){case 0:if(e.type!==0)return!1;d=c.cr();e=a.cr();if(d!=null?e==null||
!b(d,e):e!=null)return!1;break;case 1:if(e.type!==1||d.length!==e.length)return!1;c.fl(d.length);a.fl(e.length);break;default:throw new n(d);}d=c.head;e=a.head}return!0}toString(a="C",b="G",c=JSON.stringify){return this.items.map(d=>{switch(d.type){case 1:return`${a}${d.length}`;case 0:return`${b}${c(d.value)}`;default:throw new n(d);}}).join()}constructor(a,b){this.items=a;this.length=b}};__c.MAb=new LAb([],0);
KAb=class{get head(){return this.Pj}fl(a){var b=this.Pj;if(!b||b.type!==1)throw Error(`expected cell, found: ${b&&b.type}`);b=b.length;a=Math.min(a,b);this.Pj=a<b?Fwb(b-a):this.input[this.i++];return a}cr(){const a=this.Pj;if(a&&a.type!==1)return this.Pj=this.input[this.i++],a.value}finish(){oa(this.Pj==null,"stream not empty: {}",this.Pj)}constructor(a,b,c=0){this.i=0;c=Math.max(0,c-b);this.length=b+c;this.input=c?[...a,Fwb(c)]:a;this.Pj=this.input.length?this.input[this.i++]:void 0}};
yv=__c.yv=class{grad(a){if(a==null)return this;oa(this.Aca==null,"nextGrad already set: {}",this.Aca);this.Aca=a;return this}um(a){if(a<=0)return this;this.Aca!=null&&(this.zca&&(this.items.push(Fwb(this.zca)),this.zca=0),this.items.push({type:0,value:this.Aca}),this.Aca=void 0);this.zca+=a;this.BV+=a;return this}build(){this.Aca!=null?(oa(this.zca!==0),this.items.push(Fwb(this.zca)),this.items.push({type:0,value:this.Aca}),this.zca=0,this.Aca=void 0):this.BV-=this.zca;return new LAb(this.items,this.BV)}constructor(){this.items=
[];this.zca=this.BV=0;this.Aca=void 0}};
zv=__c.zv=class{static of(a,b,c,d){return b.isEmpty()?zv.empty:new zv(a,b,c,d)}Fc(a=()=>!0,b=0,c=0){b=Math.max(this.Tn,b);c=Math.max(this.tw,c);const d=this.items.Fc(c);return new NAb(this.xw,d,a,b,c)}serialize(a){const b=a.$s;this.items.forEach(this.items.length,{um:a.rows,grad:c=>{const {iy:d,grad:e,xSa:f}=b();c.forEach(c.length,{um:d,grad:e});f()}})}equals(a){return this===a?!0:a instanceof zv&&this.tw===a.tw&&this.Tn===a.Tn?this.items.equals(a.items,(b,c)=>b.equals(c,(d,e)=>Lwb(this.xw,d,e))):
!1}toString(){return this.items.toString("R","G",a=>a.toString("C","G",zwb))}constructor(a,b,c,d){this.xw=a;this.items=b;this.Tn=c;this.tw=d}};zv.empty=new zv((a,b,c)=>b===c,__c.MAb,0,0);
var NAb=class{get head(){return this.uBa.head}iyb(a){oa(this.sP==null);const b=this.$s();var c=b.head;let d=0;for(;c;){if(c.type===0)b.cr();else{c=b.fl(c.length);if(!Bv(b.attrs)){const e={...b.attrs};for(let f=0;f<c;f++)a(e,d+f)}d+=c}c=b.head}b.finish();return this.head?xv(this,1):0}get lHd(){oa(this.head!=null);oa(this.sP==null);return this.head.type===1&&this.bw.isEmpty()}$s(){oa(this.sP==null);var a=this.uBa.cr();if(a){a=a.Fc(this.Tn);for(var b=this.bw.Fc(this.Tn),c=new yv,d=a.head,e=b.head;d||
e;){if(d&&d.type===0||e&&e.type===0){const h=a.cr(),k=b.cr();b:{d=this.xpa;e=this.REa;if(!h){d=k;break b}const l={...k};for(f in h){if(e&&!e(f))continue;const m=h[f];na(Hwb(d,f,k?.[f],m.t));m.b?l[f]=m.b:delete l[f]}d=Bv(l)?void 0:l}c.grad(d)}else if(d&&e)d=Math.min(d.length,e.length),a.fl(d),b.fl(d),c.um(d);else throw Error("length mismatch");d=a.head;e=b.head}var f=c.build()}else f=this.bw;this.sP=f;return new OAb(this.xpa,this.REa,this.sP.Fc(this.Tn),this.QPb)}finish(){oa(this.sP==null);this.uBa.finish()}constructor(a,
b,c,d,e){this.xpa=a;this.uBa=b;this.REa=c;this.Tn=d;this.tw=e;this.bw=__c.MAb;this.sP=void 0;this.QPb=()=>{oa(this.sP!=null);this.bw=this.sP;this.sP=void 0}}},Awb=class{$s(){oa(this.y2a==null);return this.y2a=new PAb(this.xw,this.m9c)}rows(a){this.KBb.um(a);return this}build(){oa(this.y2a==null);oa(this.bw.isEmpty(),"prevDxs not empty: {}",this.bw);const a=this.KBb.build();return zv.of(this.xw,a,this.Tn,a.length)}constructor(a){this.xw=a;this.KBb=new yv;this.Tn=0;this.bw=__c.MAb;this.y2a=void 0;this.m9c=
b=>{oa(this.y2a!=null);this.Tn=Math.max(this.Tn,b.length);var c=this.bw.Fc(this.Tn);const d=b.Fc(this.Tn),e=new yv;for(var f=c.head,h=d.head;f||h;){if(f&&f.type===0||h&&h.type===0)f=c.cr(),h=d.cr(),f=__c.Kwb(this.xw,f,h),e.grad(f);else if(f&&h)f=Math.min(f.length,h.length),c.fl(f),d.fl(f),e.um(f);else throw Error("length mismatch");f=c.head;h=d.head}c=e.build();c.isEmpty()||this.KBb.grad(c);this.bw=b;this.y2a=void 0}}},OAb=class{get attrs(){return this.HD}get head(){return this.P9a.head}fl(a){return this.P9a.fl(a)}cr(){const a=
this.P9a.cr();this.G$(a);return a}finish(){this.P9a.finish();this.Hi()}G$(a){if(a)for(const b in a){if(!this.REa(b))continue;const c=__c.Iwb(this.xpa,b,this.HD[b],a[b]);c==null?delete this.HD[b]:this.HD[b]=c}}constructor(a,b,c,d){this.xpa=a;this.REa=b;this.P9a=c;this.Hi=d;this.HD={}}},PAb=class{tc(a,b){var c=this.xpa,d=this.HD[a];(b=c(a,d,b)?void 0:{nU:d,r:b})?(this.ME||(this.ME={}),this.ME[a]=b):this.ME&&(delete this.ME[a],Bv(this.ME)&&(this.ME=void 0));return this}attrs(a){for(const b of Av(a))this.tc(b,
a[b]);return this}iy(a){if(a<=0)return this;this.G$();this.Xga.um(a);return this}G$(){if(this.ME){var a=this.ME;this.ME=void 0;for(const b in a){const c=__c.Iwb(this.xpa,b,this.HD[b],a[b]);c==null?delete this.HD[b]:this.HD[b]=c}this.Xga.grad(a)}}finish(){this.G$();oa(Bv(this.HD));const a=this.Xga.build();this.Hi(a)}constructor(a,b){this.xpa=a;this.Hi=b;this.HD={};this.ME=void 0;this.Xga=new yv}};var $Ab=class extends $w{Bd(a){const b=new QAb;return a?new RAb(b,a):b}zC(a,b,c){a=new SAb(a,b);return c?new TAb(a,c):a}og(a){const b=new UAb;return a?new VAb(b,a):b}uT(){return WAb}id(){return XAb}isIdentity(a){return a===XAb||!a.Jb.length}lg(a,b){if(!a.Jb.length)return b;if(!b.Jb.length)return a;const c=this.Bd(),d=a.Fc(0,b.pre);a=b.Fc(a.post,0);b=d.next;for(var e=a.next;e;){if(e.type===1)b=e.length,e=a.k5(b),e=Vwb(d.eI,a.eI,{},e),c.insert(b,e);else if(b)if(b.type===1){b=Math.min(b.length,e.length);
e=d.k5(b);var f=a.xu(b);e=Vwb(d.eI,a.eI,e,f);c.insert(b,e)}else b=Math.min(b.length,e.length),e=d.xu(b),f=a.xu(b),e=Vwb(d.eI,a.eI,e,f),c.Ob(b,e);else throw Error("length mismatch");b=d.next;e=a.next}d.finish();a.finish();return c.build()}transform(a,b){if(!a.Jb.length||!b.Jb.length)return pv(b,a);var c=a.Fc(b.pre,0);const d=b.Fc(a.pre,0);var e=this.Bd();const f=this.Bd(),h=ov.un();for(var k=c.next,l=d.next;k||l;){if(k&&k.type===1){k=k.length;l=c.k5(k);l=Wwb(c.eI,d.eI,l,{});const {Ip:m,gq:r}=rv(h,
l);f.Ob(k,m);e.insert(k,r)}else if(l&&l.type===1){k=l.length;l=d.k5(k);l=Wwb(c.eI,d.eI,{},l);const {Ip:m,gq:r}=rv(h,l);f.insert(k,m);e.Ob(k,r)}else if(k&&l){k=Math.min(k.length,l.length);l=c.xu(k);const m=d.xu(k);l=Wwb(c.eI,d.eI,l,m);const {Ip:r,gq:u}=rv(h,l);f.Ob(k,r);e.Ob(k,u)}else throw Error(`unreachable case: ${k} x ${l}`);k=c.next;l=d.next}c.finish();d.finish();c=f.build();e=e.build();mv(c.post-c.pre,b.post-b.pre);mv(e.post-e.pre,a.post-a.pre);return h.build(c,e)}gj(a){if(!a.Jb.length)return a;
const b=this.Bd();for(const c of a.Jb)switch(c.type){case 0:b.Ob(c.length,Twb(c.xC));break;case 1:b.Ob(c.length,Twb(c.xC));break;default:throw new n(c);}return b.build()}Bi(a,b){return a.equals(b)}identity(){return XAb}apply(a,b){if(!b.Jb.length)return a;const c=new YAb("apply",a,b.pre);b.forEach(c);return mw(this.tf,a,c.result())}rj(a,b){if(!b.Jb.length)return a;const c=new YAb("unapply",a,b.post);b.forEach(c);return mw(this.tf,a,c.result())}Ze(a,b){if(a instanceof ZAb&&b==null)return a;const c=
new UAb;a.forEach(a.length,{grad:(d,e)=>{for(const f of Dv(d))(b==null||b(f))&&c.tc(f,d[f],e[f])},um:d=>{c.um(d)}});return c.build()}ni(a,b){if(a===b)return!0;if(a.length!==b.length)return!1;a=a.Fc();b=b.Fc();let c=a.head,d=b.head;for(;c||d;){if(!c||!d)return!1;switch(c.type){case 1:if(d.type!==1||c.length!==d.length)return!1;a.fl(c.length);b.fl(d.length);break;case 0:if(d.type!==0||!Nwb(c.DC,d.DC))return!1;a.cr();b.cr();break;default:throw new n(c);}c=a.head;d=b.head}return!0}equals(a){return this===
a||a instanceof $Ab}},aBb=Owb({},{}),ZAb=class{Fc(a){return new bBb(this,a)}cursor(a,b){return new cBb(this,a,b)}forEach(a,{grad:b,um:c}){for(const d of this.items)switch(d.type){case 0:b&&b(d.dB,d.DC);break;case 1:c&&c(d.length);break;default:throw new n(d);}(a=Math.max(0,a-this.length))&&c&&c(a)}map(a,{grad:b,um:c}){const d=this.items.map(e=>{switch(e.type){case 0:return b(e.dB,e.DC);case 1:return c(e.length);default:throw new n(e);}});(a=Math.max(0,a-this.length))&&d.push(c(a));return d}reduce({grad:a,
um:b},c){return this.items.reduce((d,e)=>{switch(e.type){case 0:return a?a(d,e.dB,e.DC):d;case 1:return b?b(d,e.length):d;default:throw new n(e);}},c)}slice(a,b){na(0<=a&&a<=b,"invalid range: [{}, {})",a,b);var c=this.length;if(0===a&&b>=c)return this;if(a===b||a>=c)return WAb;const d=new UAb;c=this.cursor(b);c.move(a);d.attrs(c.wda,c.xda);c.move(b-a,{cells:(e,f,h,k)=>d.attrs(f,k).um(e)});return d.build()}toString(){return`${this.items.map(a=>{switch(a.type){case 0:const b=[];for(const [c,d]of Object.entries(a.DC))b.push(`${c}:${d!=
null?`<${d}|`:""}`);return`G{${b.join(",")}}`;case 1:return`R${a.length}`;default:throw new n(a);}}).join("")}`}constructor(a,b,c={}){this.items=a;this.length=b;this.attributes=c;a=a.length?a[a.length-1]:void 0;na(!a||a.type!==1)}},WAb=new ZAb([],0),eBb=class{Fc(a,b){return new dBb(this,a,b)}forEach(a){for(const b of this.Jb)switch(b.type){case 0:a.Ob(b.length,b.xC);break;case 1:a.insert(b.length,b.xC);break;default:throw new n(b);}}map(a){return this.Jb.map(b=>{switch(b.type){case 0:return a.Ob(b.length,
b.xC);case 1:return a.insert(b.length,b.xC);default:throw new n(b);}})}equals(a){if(this===a)return!0;if(this.pre!==a.pre||this.post!==a.post||this.Jb.length!==a.Jb.length)return!1;for(let b=0;b<this.Jb.length;b++){const c=this.Jb[b],d=a.Jb[b];if(c!==d)switch(c.type){case 0:case 1:if(c.type!==d.type||c.length!==d.length||!Uwb(c.xC,d.xC))return!1;break;default:throw new n(c);}}return!0}toString(){return`[${this.Jb.map(a=>{let b;switch(a.type){case 0:b="R";break;case 1:b="I";break;default:throw new n(a);
}const c=[];Swb(a.xC,({r:e},f)=>{e?c.push(`+"${f.toString()}":${e.sI!=null?`"${e.sI}"`:"null"}=>${e.rI!=null?`"${e.rI}"`:"null"}`):c.push(`-"${f.toString()}"`)});const d=c.length?`{${c.join(",")}}`:"";return`${b}${a.length}${d}`}).toString()}]`}constructor(a,b,c){this.Jb=a;this.pre=b;this.post=c}},XAb=new eBb([],0,0),QAb=class{append(a,b){na(b>=0,"{} < 0",b);if(!b)return this;var c=this.Onb;this.op&&this.op.type===a&&!Dv(c).length?this.op={...this.op,length:this.op.length+b}:(this.op!=null&&this.Jb.push(this.op),
this.op={type:a,length:b,xC:c},this.Onb={});for(const [d,e]of Object.entries(c))(c=e&&e.r)?this.open[d]=c:delete this.open[d];switch(a){case 0:this.pre+=b;this.post+=b;break;case 1:this.post+=b;break;default:throw new n(a);}return this}jp(a,b){if(a==null)return this;if(typeof a==="object")for(const [c,d]of Object.entries(a))this.jp(c,d&&d.r);else Qwb(this.open[a],b)?delete this.Onb[a]:this.Onb[a]={r:b};return this}Ob(a,b,c){this.jp(b,c);return this.append(0,a)}insert(a,b,c){this.jp(b,c);return this.append(1,
a)}build(){const a=this.op;a!=null&&(!Object.keys(this.open).length&&a.type===0&&[...Object.values(a.xC)].every(b=>!b||!b.r)?(this.pre-=a.length,this.post-=a.length):this.Jb.push(a),this.op=void 0);return new eBb(this.Jb,this.pre,this.post)}constructor(){this.Jb=[];this.open={};this.Onb={};this.post=this.pre=0}},dBb=class{get eI(){return this.i5a}get next(){return this._next}yC(a,b){const c=g(this._next);oa(c.type===a,"{} != {}",c.type,a);na(0<b&&b<=c.length,"{} \u2209 ({}, {}]",b,0,c.length);for(const [d,
e]of Object.entries(c.xC)){const f=e&&e.r;f?this.i5a[d]=f:delete this.i5a[d]}b<c.length?this._next={type:a,length:c.length-b,xC:{}}:(this._next=this.i<this.input.length?this.input[this.i++]:void 0,!this._next&&this.wKa&&(this._next=Xwb(this.wKa,Cv(this.i5a,()=>({r:void 0}))),this.wKa=0));return c.xC}xu(a){return this.yC(0,a)}k5(a){return this.yC(1,a)}finish(){oa(!this._next)}constructor(a,b=0,c=0){this.i=0;this.i5a={};this.input=a.Jb;this._next=this.i<this.input.length?this.input[this.i++]:void 0;
this.wKa=Math.max(0,b-a.pre,c-a.post);!this._next&&this.wKa&&(this._next=Xwb(this.wKa),this.wKa=0)}},SAb=class{Ob(a){this.right.move(a);return this}insert(a){const b=Ywb(this,{},{},this.right.wda,this.right.xda);this.NZ.insert(a,b);return this}open(a,b,c){this.G2a.delete(a);a in this.bNa&&this.bNa[a]===c||(this.I2a[a]=b,this.Pnb[a]=c);return this}close(a){delete this.I2a[a];delete this.Pnb[a];a in this.aNa&&this.G2a.add(a);return this}S7(a,b){Ev(a,b,(c,d,e)=>this.open(c,d,e))}bN(a){for(const b of Dv(a))this.close(b);
return this}build(){return this.NZ.build()}constructor(a,b){this.NZ=new QAb;this.aNa={};this.bNa={};this.G2a=new Set;this.I2a={};this.Pnb={};this.right=a.cursor(b,{cells:(c,d,e,f,h)=>this.NZ.Ob(c,Ywb(this,d,f,e,h))})}},bBb=class{get head(){return this.Pj}get wda(){return this.HD}get xda(){return this.gtb}fl(a){var b=this.Pj;if(!b||b.type!==1)throw Error(`expected cell, found: ${b&&b.type}`);b=b.length;a=Math.min(a,b);this.Pj=a<b?Pwb(b-a):this.input[this.i++];return a}apply(a){Ev(a.dB,a.DC,(b,c,d)=>
{c!=null&&d!=null?(this.HD[b]=c,this.gtb[b]=d):(delete this.HD[b],delete this.gtb[b])})}cr(){const a=this.Pj;if(!a||a.type===1)return aBb;this.Pj=this.input[this.i++];this.apply(a);return a}finish(){oa(!this.Pj)}constructor(a,b=0){this.i=0;this.HD={};this.gtb={};b=Math.max(0,b-a.length);this.length=a.length+b;this.input=b?[...a.items,Pwb(b)]:a.items;this.Pj=this.input.length?this.input[this.i++]:void 0}},cBb=class{get nK(){return this.Fc.length-this.Cya}get wda(){return this.Fc.wda}get xda(){return this.Fc.xda}move(a,
b){var c=this.JWa;b=c?b?{cells:vv(c.cells,b.cells)}:c:b;na(a>=0,"{} < 0",a);a=this.Cya+a;for(na(a<=this.Fc.length,"{} > {}",a,this.Fc.length);this.Cya<a;){c=this.Fc.cr();const d=this.Fc.fl(a-this.Cya);this.Cya+=d;b&&b.cells&&b.cells(d,c.dB,this.wda,c.DC,this.xda)}}finish(){this.Fc.cr();this.Fc.finish()}constructor(a,b,c){this.JWa=c;this.Cya=0;this.Fc=new bBb(a,b)}},UAb=class{tc(a,b,c){this.RYb[a]!==c?(this.dB[a]=b,this.DC[a]=c):(delete this.dB[a],delete this.DC[a]);return this}attrs(a,b){Ev(a,b,(c,
d,e)=>this.tc(c,d,e));return this}um(a){a>0&&(Object.keys(this.dB).length&&(this.length&&(this.items.push(Pwb(this.length)),this.length=0),this.items.push(Owb(this.dB,this.DC)),Ev(this.dB,this.DC,(b,c,d)=>{c!=null?(this.as[b]=c,this.RYb[b]=d,(this.attributes[b]??(this.attributes[b]=new Set)).add(c)):(delete this.as[b],delete this.RYb[b])}),this.dB={},this.DC={}),this.length+=a,this.BV+=a);return this}append(a,b=0){a.forEach(b,{grad:(c,d)=>this.attrs(c,d),um:c=>this.um(c)});return this}build(){for(const a of Dv(this.as))this.tc(a,
void 0,void 0);for(const a of Dv(this.dB))this.tc(a,void 0,void 0);Object.keys(this.dB).length?(oa(!!this.length,"attributes still open: {}",this.dB),this.items.push(Pwb(this.length)),this.items.push(Owb(this.dB,this.DC)),this.length=0,this.dB={},this.DC={}):this.BV-=this.length;return new ZAb(this.items,this.BV,this.attributes)}constructor(){this.items=[];this.attributes={};this.as={};this.RYb={};this.length=this.BV=0;this.dB={};this.DC={}}},RAb=class{Ob(a,b,c){if(b==null)return this.un.Ob(a),this;
typeof b==="object"?this.un.Ob(a,$wb(this,b)):this.un.Ob(a,b,Zwb(this,b,c));return this}insert(a,b,c){if(b==null)return this.un.insert(a),this;typeof b==="object"?this.un.insert(a,$wb(this,b)):this.un.insert(a,b,Zwb(this,b,c));return this}jp(a,b){if(a==null)return this;typeof a==="object"?this.un.jp($wb(this,a)):this.un.jp(a,Zwb(this,a,b));return this}build(){return this.un.build()}constructor(a,b){this.un=a;this.kCa=b}},VAb=class{encode(a,b){return b!=null?this.kCa.encode(a,b):void 0}tc(a,b){this.un.tc(a,
b,this.encode(a,b));return this}attrs(a){this.un.attrs(a,Cv(a,(b,c)=>this.encode(c,b)));return this}um(a){this.un.um(a);return this}append(a,b){this.un.append(a,b);return this}build(){return this.un.build()}constructor(a,b){this.un=a;this.kCa=b}},TAb=class{encode(a,b){return b!=null?this.kCa.encode(a,b):void 0}Ob(a){this.generator.Ob(a);return this}insert(a){this.generator.insert(a);return this}open(a,b,c){this.generator.open(a,b,c!=null?c:this.encode(a,b));return this}close(a){this.generator.close(a);
return this}S7(a){this.generator.S7(a,Cv(a,(b,c)=>this.encode(c,b)))}bN(a){this.generator.bN(a);return this}build(){return this.generator.build()}constructor(a,b){this.generator=a;this.kCa=b}},YAb=class{Ob(a,b){na(a>0);this.bHa=b;this.Fc.move(a);if(this.bHa)throw Error("ddas not consumed");return this}insert(a,b){na(a>0);this.bHa=b;this.mode==="apply"?(axb(this,this.Fc.wda,this.Fc.xda),this.NZ.um(a)):(this.q0b=!0,this.Fc.move(a),this.q0b=!1);if(this.bHa)throw Error("ddas not consumed");return this}result(){for(const a of this.open)this.NZ.tc(a,
this.Fc.wda[a],this.Fc.xda[a]);this.open.clear();this.Fc.move(this.Fc.nK);this.Fc.finish();return this.NZ.build()}constructor(a,b,c){this.mode=a;this.NZ=new UAb;this.open=new Set;this.bHa=void 0;this.q0b=!1;this.Fc=b.cursor(c,{cells:(d,e,f,h,k)=>{const l=axb(this,f,k);Ev(e,h,(m,r,u)=>{this.open.has(m)?na(!!l?.has(m),"unexpected gradient: {}: {}",m,u):this.NZ.tc(m,r,u)});this.q0b||this.NZ.um(d)}})}};var Syb=class{toString(){return`U(${this.delta})`}constructor(a){this.delta=a;this.type=0}},fBb=class{toString(){return`R(${this.oldState}, ${this.newState})`}constructor(a,b){this.oldState=a;this.newState=b;this.type=1}},gBb=class extends Zw{update(a){return this.component.isIdentity(a)?void 0:new Syb(a)}replace(a,b){return new fBb(a,b)}isIdentity(a){return a==null||a.type===0&&this.component.isIdentity(a.delta)}constructor(a){super();this.component=a}};var hBb=class extends $w{update(a){return this.base.update(a)}replace(a,b){return this.base.replace(a,b)}isIdentity(a){return this.base.isIdentity(a)}lg(a,b){if(a==null)return b;if(b==null)return a;switch(a.type){case 0:switch(b.type){case 0:return this.update(this.component.lg(a.delta,b.delta));case 1:return this.replace(this.component.rj(b.oldState,a.delta),b.newState);default:throw new n(b);}case 1:switch(b.type){case 0:return this.replace(a.oldState,this.component.apply(a.newState,b.delta));case 1:return nv(this.component,
a.newState,b.oldState),this.replace(a.oldState,b.newState);default:throw new n(b);}default:throw new n(a);}}transform(a,b){if(a==null||b==null)return pv(b,a);switch(a.type){case 0:switch(b.type){case 0:return twb(this.component.transform(a.delta,b.delta),c=>this.update(c));case 1:return a=this.component.apply(b.oldState,a.delta),new ov(this.replace(a,b.newState),void 0,!1,!0);default:throw new n(b);}case 1:switch(b.type){case 0:return b=this.component.apply(a.oldState,b.delta),qv(this.replace(b,a.newState));
case 1:return nv(this.component,a.oldState,b.oldState),qv(this.replace(b.newState,a.newState));default:throw new n(b);}default:throw new n(a);}}gj(a){if(a==null)return a;switch(a.type){case 0:return this.update(this.component.gj(a.delta));case 1:return this.replace(a.newState,a.oldState);default:throw new n(a);}}Bi(a,b){return a===b?!0:a==null||b==null?a===b:a.type===0&&b.type===0?this.component.Bi(a.delta,b.delta):a.type===1&&b.type===1?this.component.ni(a.oldState,b.oldState)&&this.component.ni(a.newState,
b.newState):!1}identity(){}apply(a,b){if(b==null)return a;switch(b.type){case 0:return mw(this.tf,a,this.component.apply(a,b.delta));case 1:return nv(this.component,a,b.oldState),b.newState;default:throw new n(b);}}rj(a,b){if(b==null)return a;switch(b.type){case 0:return mw(this.tf,a,this.component.rj(a,b.delta));case 1:return nv(this.component,a,b.newState),b.oldState;default:throw new n(b);}}Ze(a){return this.component.Ze(a)}ni(a,b){return this.component.ni(a,b)}equals(a){return this===a||a instanceof
hBb&&this.component.equals(a.component)}constructor(a,b,c){super(a);this.component=b;this.base=c}};var jBb=class{get Tn(){return this.grid.Tn}get tw(){return this.grid.tw}get rows(){return this.grid.rows}forEach(a){this.grid.forEach((b,c,d)=>{a(d.state,Fv(b,c,d.right,d.bottom))})}map(a){const b=new iBb;this.forEach((c,d)=>{b.add(d,a(c,d))});return b.build()}get(a,b){var c=this.grid.rows[b];if(c!=null&&(c=c.cells[a],c!=null))return{span:Fv(a,b,c.right,c.bottom),state:c.state}}values(){const a=[];this.forEach((b,c)=>{a.push({span:c,state:b})});return a}Fc(){return this.grid.Fc()}constructor(a){this.grid=
a}},iBb=class{add(a,b){Jv(this.W8c,a);this.XBc.add(a.left,a.top,a.right,a.bottom,{right:a.right,bottom:a.bottom,state:b});return this}build(){const a=this.XBc.build();return a.isEmpty?kBb:new jBb(a)}constructor(){this.XBc=new lBb;this.W8c=new mBb}},nBb=class{constructor(a,b){this.type=0;this.o=a&&{right:a.right,bottom:a.bottom,state:a.state};this.n=b&&{right:b.right,bottom:b.bottom,state:b.state}}},oBb=class{constructor(a,b){this.bounds=a;this.delta=b;this.type=1}},Hv=class{add(a,b,c){if(c==null)return this;
switch(c.type){case 1:return this.addUpdate(a,b,c);case 0:let e=a,f=b;if(c.o){var d=Fv(a,b,c.o.right,c.o.bottom);Jv(this.Auc,d);e=Math.max(e,c.o.right);f=Math.max(f,c.o.bottom)}c.n&&(d=Fv(a,b,c.n.right,c.n.bottom),Jv(this.Ltc,d),e=Math.max(e,c.n.right),f=Math.max(f,c.n.bottom));this.wDa.add(a,b,e,f,c);return this;default:throw new n(c);}}addUpdate(a,b,c){let d=a,e=b;if(c.bounds?.o){var f=Fv(a,b,c.bounds.o.right,c.bounds.o.bottom);Jv(this.Auc,f);d=Math.max(d,c.bounds.o.right);e=Math.max(e,c.bounds.o.bottom)}c.bounds?.n&&
(f=Fv(a,b,c.bounds.n.right,c.bounds.n.bottom),Jv(this.Ltc,f),d=Math.max(d,c.bounds.n.right),e=Math.max(e,c.bounds.n.bottom));this.wDa.add(a,b,d,e,c);return this}build(){return this.wDa.build()}constructor(){this.wDa=new lBb;this.Auc=new mBb;this.Ltc=new mBb}},qBb=class{get isEmpty(){return this.rows.length===0}forEach(a){this.rows.forEach(({cells:b},c)=>{b.forEach((d,e)=>{a(e,c,d)})})}values(){const a=[];this.forEach((b,c,d)=>a.push([b,c,d]));return a}Fc(){return new pBb(this.rows)}constructor(a,
b,c){this.rows=a;this.Tn=b;this.tw=c}},pBb=class{get head(){const a=this.rows[this.y];return a?.cells[this.x]&&{x:this.x,y:this.y,value:a.cells[this.x]}}yC(){const a=g(this.head),b=g(this.rows[this.y]);this.x++;bxb(this);b.cells[this.x]==null&&(this.y++,this.x=0,cxb(this),bxb(this));return a}finish(){oa(this.head==null)}constructor(a){this.rows=a;this.x=this.y=0;cxb(this);bxb(this)}},lBb=class{add(a,b,c,d,e){na(a<=c);na(b<=d);this.AY==null||this.AY.y<b?(this.flush(),this.rows.length&&oa(this.rows.length<=
b),this.AY={y:b,maxY:d,cells:[]},this.AY.cells[a]=e):this.AY.y===b?(oa(this.AY.cells.length<=a),this.AY.maxY=Math.max(this.AY.maxY,d),this.AY.cells[a]=e):oa(this.AY.y>b);this.Tn=Math.max(this.Tn,c+1);this.tw=Math.max(this.tw,d+1);return this}flush(){if(this.AY){const {y:a,...b}=this.AY;this.rows[a]=b;this.AY=void 0}}build(){this.flush();return new qBb(this.rows,this.Tn,this.tw)}constructor(){this.rows=[];this.tw=this.Tn=0}},kBb=new jBb(new qBb([],0,0)),rBb=class extends $w{og(){return new iBb}uT(){return kBb}replace(a,
b){return new nBb(a,b)}update(a,b){a=a==null||Gv(a.o,a.n)?void 0:a;b=b==null||this.component.isIdentity(b)?void 0:b;return a!=null||b!=null?new oBb(a,b):void 0}he(a={}){const b=a.cells||(new Hv).build();return{x:a.x||this.axis.Bd().build(),y:a.y||this.axis.Bd().build(),cells:b,Hv:a.Hv||this.Hv.project(b)}}isIdentity(a){return this.axis.isIdentity(a.x)&&this.axis.isIdentity(a.y)&&a.cells.isEmpty&&this.Hv.isIdentity(a.Hv)}lg(a,b){const c=dxb(this,a.cells,b.x,b.y),d=this.Hv.expand(a.Hv,b.x,b.y);return{x:this.axis.lg(a.x,
b.x),y:this.axis.lg(a.y,b.y),cells:gxb(this,c,b.cells),Hv:this.Hv.lg(d,b.Hv)}}transform(a,b){const c=ov.un(),{Ip:d,gq:e}=rv(c,this.axis.transform(a.x,b.x)),{Ip:f,gq:h}=rv(c,this.axis.transform(a.y,b.y)),k=dxb(this,a.cells,d,f),l=dxb(this,b.cells,e,h);a=this.Hv.expand(a.Hv,d,f);b=this.Hv.expand(b.Hv,e,h);const {Ip:m,gq:r}=rv(c,this.Hv.transform(a,b)),u=new mBb,w=this.Hv.cursor(a,Math.max(k.Tn,l.Tn),Math.max(k.tw,l.tw)),y=new Hv,z=new Hv;exb(k.Fc(),l.Fc(),(A,C,F,G)=>{if(F!=null||G!=null){a:if(F==null||
G==null)var K=pv(G,F);else switch(F.type){case 1:b:{switch(G.type){case 1:K=ov.un();const {Ip:Q,gq:S}=F.delta&&G.delta?rv(K,this.component.transform(F.delta,G.delta)):pv(G.delta,F.delta);if(F.bounds&&G.bounds){F=F.bounds;G=G.bounds;oa(Gv(F.o,G.o));const ca={right:Math.min(F.n.right,G.n.right),bottom:Math.min(F.n.bottom,G.n.bottom)},X=ov.un();uwb(X,!Gv(G.n,ca));vwb(X,!Gv(F.n,ca));F=X.build({o:G.n,n:ca},{o:F.n,n:ca});F=rv(K,F)}else F=pv(G.bounds,F.bounds);const {Ip:U,gq:W}=F;K=K.build(this.update(U,
Q),this.update(W,S));break b;case 0:oa(G.o!=null);F.bounds&&oa(Gv(F.bounds.o,G.o));K=new ov(this.replace({...(F.bounds?F.bounds.n:G.o),state:F.delta?this.component.apply(G.o.state,F.delta):G.o.state},G.n),void 0,!1,!0);break b;default:throw new n(G);}K=void 0}break a;case 0:b:switch(G.type){case 1:oa(F.o!=null);G.bounds&&oa(Gv(F.o,G.bounds.o));K=qv(this.replace({...(G.bounds?G.bounds.n:F.o),state:G.delta?this.component.apply(F.o.state,G.delta):F.o.state},F.n));break b;case 0:oa(Iv(this,F.o,G.o));
K=qv(this.replace(G.n,F.n));break b;default:throw new n(G);}break a;default:throw new n(F);}var {Ip:M,gq:N}=rv(c,K);M&&(K=jxb(this,A,C,M,u,w))&&(M=fxb(this,M,K),N=fxb(this,N,K),uwb(c));M&&z.add(A,C,M);N&&y.add(A,C,N)}});w.finish();return c.build({x:d,y:f,cells:z.build(),Hv:m},{x:e,y:h,cells:y.build(),Hv:r})}gj(a){const b=new Hv;a.cells.forEach((d,e,f)=>{if(f!=null)switch(f.type){case 1:f=this.update(f.bounds&&{o:f.bounds.n,n:f.bounds.o},f.delta&&this.component.gj(f.delta));b.add(d,e,f);break;case 0:b.add(d,
e,this.replace(f.n,f.o));break;default:throw new n(f);}});const c=b.build();return{x:this.axis.gj(a.x),y:this.axis.gj(a.y),cells:c,Hv:this.Hv.project(c)}}Bi(a,b){var c;if(c=this.axis.Bi(a.x,b.x)&&this.axis.Bi(a.y,b.y))a:{c=a.cells;var d=b.cells;if(c.Tn!==d.Tn||c.tw!==d.tw)c=!1;else{c=c.Fc();d=d.Fc();for(var e=c.head,f=d.head;e||f;){var h;(h=e==null)||(h=f==null)||(h=e.x!==f.x||e.y!==f.y)||(e=e.value,f=f.value,h=!(e===f||(e==null||f==null?e===f:e.type===0&&f.type===0?Iv(this,e.o,f.o)&&Iv(this,e.n,
f.n):e.type===1&&f.type===1&&(e.bounds&&f.bounds?Gv(e.bounds.o,f.bounds.o)&&Gv(e.bounds.n,f.bounds.n):e.bounds===f.bounds)&&(e.delta&&f.delta?this.component.Bi(e.delta,f.delta):e.delta===f.delta))));if(h){c=!1;break a}c.yC();d.yC();e=c.head;f=d.head}c=!0}}return c&&this.Hv.Bi(a.Hv,b.Hv)}identity(){return this.he()}apply(a,b){const c=this.mra(a,b.x,b.y),d=this.og();exb(c.Fc(),b.cells.Fc(),(e,f,h,k)=>{if(h!=null||k!=null)if(k==null)oa(h!=null),d.add(Fv(e,f,h.right,h.bottom),h.state);else switch(k.type){case 1:oa(h!=
null);k.bounds&&oa(Gv(k.bounds.o,h));d.add({...(k.bounds?k.bounds.n:h),left:e,top:f},k.delta?this.component.apply(h.state,k.delta):h.state);break;case 0:k.o&&(oa(h!=null),oa(Iv(this,h,k.o)));k.n&&d.add({left:e,top:f,right:k.n.right,bottom:k.n.bottom},k.n.state);break;default:throw new n(k);}});return mw(this.tf,a,d.build())}mra(a,b,c){if(this.axis.isIdentity(b)&&this.axis.isIdentity(c))return a;const d=new Set,e=new Set;a.forEach((l,m)=>{d.add(m.left);d.add(m.right);e.add(m.top);e.add(m.bottom)});
const f=uv(b,d),h=uv(c,e),k=new iBb;a.forEach((l,m)=>{m={left:g(f.get(m.left)),right:g(f.get(m.right)),top:g(h.get(m.top)),bottom:g(h.get(m.bottom))};k.add(m,l)});return k.build()}rj(a,b){const c=this.og();exb(a.Fc(),b.cells.Fc(),(d,e,f,h)=>{if(f!=null||h!=null)if(h==null)oa(f!=null),c.add(Fv(d,e,f.right,f.bottom),f.state);else switch(h.type){case 1:oa(f!=null);h.bounds&&oa(Gv(h.bounds.n,f));c.add({...(h.bounds?h.bounds.o:f),left:d,top:e},h.delta?this.component.rj(f.state,h.delta):f.state);break;
case 0:h.n&&(oa(f!=null),oa(Iv(this,f,h.n)));h.o&&c.add({left:d,top:e,right:h.o.right,bottom:h.o.bottom},h.o.state);break;default:throw new n(h);}});return mw(this.tf,a,this.Dob(c.build(),b.x,b.y))}Dob(a,b,c){if(this.axis.isIdentity(b)&&this.axis.isIdentity(c))return a;const d=new Set,e=new Set;a.forEach((l,m)=>{d.add(m.left);d.add(m.right);e.add(m.top);e.add(m.bottom)});const f=ywb(b,d),h=ywb(c,e),k=new iBb;a.forEach((l,m)=>{m={left:g(f.get(m.left)),right:g(f.get(m.right)),top:g(h.get(m.top)),bottom:g(h.get(m.bottom))};
k.add(m,l)});return k.build()}Ze(a){return a.map(b=>this.component.Ze(b))}ni(a,b){if(a===b)return!0;a=a.Fc();b=b.Fc();let c=a.head,d=b.head;for(;c||d;){if(c==null||d==null||c.x!==d.x||c.y!==d.y||c.value.bottom!==d.value.bottom||c.value.right!==d.value.right||!this.component.ni(c.value.state,d.value.state))return!1;a.yC();b.yC();c=a.head;d=b.head}return!0}equals(a){return this===a||a instanceof rBb&&this.component.equals(a.component)}constructor(a,b,c,d){super(a);this.component=b;this.Hv=c;this.axis=
d}},mBb=class{append(a){for(let b=a.top;b<=a.bottom;b++)for(let c=a.left;c<=a.right;c++){oa(!this.readBuffer(c,b));const {bNc:d,cNc:e}=lxb(this,c,b);this.buffer[e]||(this.buffer[e]=[]);this.buffer[e][d]=!0}}readBuffer(a,b){const {bNc:c,cNc:d}=lxb(this,a,b);return this.buffer[d]&&this.buffer[d][c]}constructor(){this.buffer=[];this.f4a=this.Npb=0}},sBb=class extends $w{isIdentity(a){return a.items.isEmpty()}lg(a,b){if(this.isIdentity(a))return b;if(this.isIdentity(b))return a;const c=this.ONa.og();
Cwb(a,b,c,(d,e,f)=>e||f);return c.build()}transform(a,b){return pv(b,a)}gj(a){return a}Bi(a,b){return a.equals(b)}identity(){return this.id}apply(a){return a}rj(a){return a}Ze(){}ni(a,b){return a===b}equals(a){return this===a||a instanceof sBb}Bd(){return new tBb(()=>this.ONa.og(),a=>swb(this,a))}cursor(a,b,c){return new uBb(a,b,c)}project(a){const b=this.Bd();a.forEach((c,d,e)=>{switch(e.type){case 1:e.bounds&&b.add(Fv(c,d,e.bounds.n.right,e.bounds.n.bottom));break;case 0:e.n&&b.add(Fv(c,d,e.n.right,
e.n.bottom));break;default:throw new n(e);}});return b.build()}expand(a,b,c){b=this.ONa.he({x:mxb(this,b),y:mxb(this,c)});return this.ONa.apply(a,b)}constructor(a,b,c){super(a);this.ONa=b;this.axis=c;this.id=this.ONa.og().build()}},tBb=class{add(a){const b=this.wDa(),c=a.left*2,d=a.top*2,e=a.right*2;a=a.bottom*2;b.rows(d);b.$s().iy(c).attrs({value:!0}).iy(e-c+1).attrs({value:void 0}).finish();b.rows(a-d+1);b.$s().iy(c).attrs({value:void 0}).iy(e-c+1).attrs({value:void 0}).finish();this.HBb.push(b.build());
return this}build(){return this.HBb.length?this.reduce(this.HBb):this.wDa().build()}constructor(a,b){this.wDa=a;this.reduce=b;this.HBb=[]}},uBb=class{get fNc(){oa(this.o$%2===0);return this.o$/2}$s(){oa(this.Jna===0);this.pM=this.Fc.$s();return this}get value(){oa(this.pM!=null);return this.pM.attrs.value}iyb(a){oa(this.pM!=null);for(var b=this.pM.head;b!=null;){if(b.type===0)this.pM.cr();else if(b=this.pM.fl(b.length),this.o$%2===0&&this.pM.attrs.value)for(let c=0;c<b;c++)this.Jna%2===0&&a(this.Jna/
2,this.o$/2),this.Jna++;else this.Jna+=b;b=this.pM.head}return this}xSa(){for(oa(this.pM!=null);this.pM.head;)this.pM.head.type===0?this.pM.cr():this.pM.fl(this.pM.head.length);this.pM.finish();this.pM=void 0;this.Jna=0;return this}finish(){hxb(this,this.Fc.tw);this.Fc.head&&(this.$s(),this.xSa());this.Fc.finish()}constructor(a,b,c){this.Jna=this.o$=0;this.Fc=a.Fc(void 0,b*2,c*2)}};var vBb=class extends $w{increment(a){return a}isIdentity(a){return a===0}lg(a,b){return a+b}transform(a,b){return pv(b,a)}Bi(a,b){return a===b}identity(){return 0}apply(a,b){return a+b}rj(a,b){return a-b}Ze(a){return a}ni(a,b){return a===b}},wBb=class extends vBb{gj(a){return 0-a}equals(a){return this===a||a instanceof wBb}},xBb=class extends vBb{increment(a){na(a>=0);return super.increment(a)}lg(a,b){na(a>=0);na(b>=0);return super.lg(a,b)}transform(a,b){na(a>=0);na(b>=0);return super.transform(a,
b)}gj(a){na(a>=0);return 0}apply(a,b){na(b>=0);return super.apply(a,b)}rj(a,b){na(b>=0);return super.rj(a,b)}equals(a){return this===a||a instanceof xBb}};var yBb=new Map,zBb=class extends $w{isIdentity(a){return!a.size||Array.from(a.values()).every(b=>b===0)}lg(a,b){return oxb(a,b)}transform(a,b){return pv(b,a)}gj(a){return a.size?di(a,b=>-b):a}Bi(a,b){return nxb(a,b)}identity(){return yBb}apply(a,b){return mw(this.tf,a,oxb(a,b))}rj(a,b){return mw(this.tf,a,oxb(a,this.gj(b)))}Ze(a){return new Map(a)}ni(a,b){return nxb(a,b)}equals(a){return this===a||a instanceof zBb}};var pxb=new Map,ABb=class extends $w{create(a,b){return qxb(this,a,this.component.replace(void 0,b))}update(a,b){return qxb(this,a,this.component.update(b))}replace(a,b,c){return qxb(this,a,this.component.replace(b,c))}delete(a,b){return qxb(this,a,this.component.replace(b,void 0))}identity(){return pxb}isIdentity(a){return!a.size||Array.from(a.values()).every(b=>this.component.isIdentity(b))}gj(a){if(!a.size)return a;const b=new Map;for(const [c,d]of a)a=this.component.gj(d),a!=null&&b.set(c,a);
return b}lg(a,b){if(!a.size)return b;if(!b.size)return a;const c=new Map;for(const d of rxb(a,b)){const e=this.component.lg(a.get(d),b.get(d));e!=null&&c.set(d,e)}return c}transform(a,b){if(!a.size||!b.size)return pv(b,a);const c=new Map,d=new Map,e=ov.un();for(const f of rxb(a,b)){const h=rv(e,this.component.transform(a.get(f),b.get(f)));h.gq!=null&&c.set(f,h.gq);h.Ip!=null&&d.set(f,h.Ip)}return e.build(d,c)}apply(a,b){if(!b.size)return a;const c=new Map(a);b.forEach((d,e)=>{d=this.component.apply(a.get(e),
d);d!=null?c.set(e,d):c.delete(e)});return mw(this.tf,a,c)}rj(a,b){if(!b.size)return a;const c=new Map(a);b.forEach((d,e)=>{d=this.component.rj(a.get(e),d);d!=null?c.set(e,d):c.delete(e)});return mw(this.tf,a,c)}Ze(a){const b=new Map;for(const [c,d]of a)a=this.component.Ze(d),a!=null&&b.set(c,a);return b}ni(a,b){return a===b||a.size===b.size&&Array.from(rxb(a,b)).every(c=>{const d=a.get(c);c=b.get(c);return d!=null&&c!=null&&this.component.ni(d,c)})}Bi(a,b){return a===b||a.size===b.size&&Array.from(rxb(a,
b)).every(c=>{const d=a.get(c);c=b.get(c);return d!=null&&c!=null&&this.component.Bi(d,c)})}equals(a){return this===a||a instanceof ABb&&this.component.equals(a)}constructor(a,b){super(a);this.component=b}};var BBb=class extends Zw{isIdentity(a){return a==null||this.component.isIdentity(a)}constructor(a){super();this.component=a;na(!(a instanceof BBb))}};var sxb={type:0,length:1},txb={type:1,length:1},vxb={type:2,length:1},Axb=class{toString(){return this.Jb.map(zxb).join("")}constructor(a,b,c,d){this.Jb=a;this.pre=b;this.post=c;this.Nva=d}},CBb=new Axb([],0,0,0),DBb=class{qZ(a){if(this.mode!==a){switch(this.mode){case void 0:break;case 0:this.Jb.push(Kv(this.acc));this.pre+=this.acc;this.post+=this.acc;this.acc=0;break;case 1:this.Jb.push(uxb(this.acc));this.post+=this.acc;this.acc=0;break;case 2:this.Jb.push(wxb(this.acc));this.pre+=this.acc;this.post+=
this.acc;this.acc=0;break;case 3:case 4:break;default:throw new n(this.mode);}this.mode=a}}accumulate(a,b=1){na(b>=0,"{} < 0",b);b&&(this.qZ(a),this.acc+=b);return this}bkb({La:a,zj:b}){const c=this.Jb.length,d=this.MY||(this.MY=new Map),e=this.ala||(this.ala=new Map);na(!d.has(a),"duplicate record: {}",a);na(!e.has(b),"duplicate recall: {}",b);d.set(a,c);e.set(b,c)}append(a,b){switch(a.type){case 0:return this.Ob(a.length);case 1:return this.expand(a.length);case 2:return this.eV(a.length);case 3:var c=
a.shift;if(!b&&(b=a.state,c&&c.La===c.zj&&(c=void 0,a=Lv(b)),b==null&&c==null))return this.expand();this.qZ(a.type);c&&this.bkb(c);this.Jb.push(a);this.post++;return this;case 4:c=a.shift;if(!b)if(b=a.delta,c&&c.La===c.zj&&(c=void 0,a=Mv(b)),b==null){if(c==null)return this.Ob()}else if(b.type===1&&b.oldState==null&&b.newState==null&&c==null)return this.eV();this.qZ(a.type);c&&this.bkb(c);this.Jb.push(a);this.pre++;this.post++;return this;default:throw new n(a);}}Ob(a){return a==null||typeof a==="number"?
this.accumulate(0,a):this.append(Mv(void 0,a))}expand(a){return a==null||typeof a==="number"?this.accumulate(1,a):this.append(Lv(void 0,a))}eV(a){return a==null||typeof a==="number"?this.accumulate(2,a):this.append(Mv(this.component.replace(void 0,void 0),a))}insert(a,b){return this.append(Lv(a,b))}update(a,b){return this.append(Mv(a!=null?this.component.update(a):void 0,b))}cfa(a){return this.append(Mv(this.component.replace(void 0,a)))}rQ(a){return this.append(Mv(this.component.replace(a,void 0)))}jp(a,
b,c){return this.append(Mv(this.component.replace(a,b),c))}build(a){this.mode!==0&&this.qZ();if(a?.s2b())return a.oFb(this.Jb);if(!this.MY&&!this.ala)return new Axb(this.Jb,this.pre,this.post,0);a=this.Jb;const b=g(this.MY);var c=[...b.keys()];if(c.some((h,k)=>h!==k)){const h=new Map;c.forEach((k,l)=>h.set(k,l));for(const k of b.values())switch(c=a[k],c.type){case 3:var d=c.shift,e=h.get(d.La),f=h.get(d.zj);if(e!==d.La||f!==d.zj)a[k]=Lv(c.state,{La:e,zj:f});break;case 4:d=c.shift;e=h.get(d.La);f=
h.get(d.zj);if(e!==d.La||f!==d.zj)a[k]=Mv(c.delta,{La:e,zj:f});break;case 0:case 1:case 2:throw Error(`INSERT | UPDATE expected: ${zxb(c)}`);default:throw new n(c);}}return new Axb(a,this.pre,this.post,b.size)}constructor(a){this.component=a;this.Jb=[];this.acc=this.post=this.pre=0;this.ala=this.MY=this.mode=void 0}},EBb=class{bkb(a,{La:b,zj:c}){const d=this.MY||(this.MY=new Map),e=this.ala||(this.ala=new Map);oa(!d.has(b),"already recorded: {}",b);oa(!e.has(c),"already recalled: {}",c);d.set(b,a);
e.set(c,this.length)}append(a,b){b?this.bkb(a,b):a!=null&&(this.list[this.length]=a);this.length++;return this}expand(a=1){na(a>=0,"{} < 0",a);this.length+=a;return this}build(){const a=this.list;if(this.MY||this.ala){const c=g(this.MY);var b=g(this.ala);mv(c.size,b.size);for(const [d,e]of b)oa(c.has(d),"recall has no record: {}",d),b=c.get(d),b!=null&&(a[e]=b)}this.Ghc!=null&&mv(this.length,this.Ghc);return a}constructor(a){this.Ghc=a;this.list=[];this.length=0;this.ala=this.MY=void 0}},FBb=class extends Zw{static of(a){return new FBb(new gBb(new BBb(a)))}Bd(){return new DBb(this.component)}isIdentity(a){return!a.Jb.length||
a.Jb.every(b=>{switch(b.type){case 0:return!0;case 4:return!b.shift&&this.component.isIdentity(b.delta);case 2:case 1:case 3:return!1}throw new n(b);})}constructor(a){super();this.component=a}};var GBb={type:0,length:1},Exb=Lv(),Dxb=Mv(),Fxb=Mv(new fBb),ax=class{static create(a,b,c){na(b>=0,"{} < 0",b);na(c>=0,"{} < 0",c);a=(b=Math.max(0,b-a.pre,c-a.post))?[...a.Jb,Kv(b)]:a.Jb;return new ax(a)}get head(){return this.Pj}my(a,b=1){const c=g(this.Pj);if(c.type!==a)throw Error();const d=c.length;na(0<b&&b<=d,"{} \u2209 (0, {}]",b,d);if(b<d)switch(a){case 0:return this.Pj=Kv(d-b),Kv(b);case 1:return this.Pj=uxb(d-b),uxb(b);case 2:return this.Pj=wxb(d-b),wxb(b);default:throw new n(a);}else return this.Pj=
this.Jb[this.i++],c}constructor(a){this.Jb=a;this.i=0;this.Pj=a[this.i++]}},HBb=class{static create(a,b){a.length<b&&(a=a.slice(),a.length=b);return new HBb(a)}finish(){mv(this.Csa,this.input.length)}constructor(a){this.input=a;this.Csa=0}},IBb=class{s2b(){return!!this.cXa}oFb(a){const b=new DBb(this.component);for(const c of a)switch(c.type){case 3:b.append(this.Wic(c));break;case 4:b.append(this.Xic(c));break;case 0:case 1:case 2:b.append(c);break;default:throw new n(c);}return b.build()}constructor(a){this.component=
a;this.eUb=this.fUb=this.cXa=void 0}},JBb=class extends IBb{Wic(a){if(!a.shift)return a;const b=a.state,c=a.shift;var d=this.Qob?.get(c.La);d=this.component.apply(b,d);const e=Lxb(this,c);return d!==b||e!==c?Lv(d,e):a}Xic(a){if(!a.shift)return a;const b=a.delta,c=a.shift;var d=this.Qob?.get(c.La);d=this.component.lg(b,d);const e=Lxb(this,c);return d!==b||e!==c?Mv(d,e):a}constructor(...a){super(...a);this.Qob=void 0}},KBb=class extends IBb{s2b(){return super.s2b()||!!this.zJa||!!this.eKa}Wic(a){if(!a.shift)return a;
const b=a.shift,c=Lxb(this,b);if(c!==b)throw Error(`${JSON.stringify(c)} != ${JSON.stringify(b)}`);return a}Xic(a){const b=a.delta,c=a.shift;var d=this.zJa;if(d){var e=d.get(a);if(e==null)e=a.delta;else{d.delete(a);d=g(this.eKa);var f=d.get(e);d.delete(e);e=f}}else e=a.delta;d=c&&Lxb(this,c);return e!==b||d!==c?Mv(e,d):a}oFb(a){a=super.oFb(a);if(this.zJa?.size)throw Error(`unconsumed setSurrogates: ${[...this.zJa.values()]}`);if(this.eKa?.size)throw Error(`unconsumed subSurrogates: ${[...this.eKa.keys()]}`);
return a}constructor(...a){super(...a);this.eKa=this.zJa=void 0}},LBb=class extends $w{Bd(){return this.base.Bd()}isIdentity(a){return this.base.isIdentity(a)}lg(a,b){if(!a.Jb.length)return b;if(!b.Jb.length)return a;const c=this.component,d=this.Bd(),e=new JBb(c),f=ax.create(a,0,b.pre),h=ax.create(Bxb(b,a.Nva),a.post,0);for(var k=f.head,l=h.head;k||l;){if(l)if(l.type===1)d.append(h.my(l.type,l.length));else if(l.type===3)d.append(Nv(h,l.type));else if(k)if(k.type===1)switch(l.type){case 2:case 0:var m=
Math.min(k.length,l.length);f.my(k.type,m);h.my(l.type,m);d.append(uxb(m));break;case 4:m=Nv(f,k.type);l=Nv(h,l.type);k=l.shift;d.append(Lv(c.apply(m.state,l.delta),k));break;default:throw new n(l);}else if(k.type===3){m=Nv(f,k.type);l=Nv(h,l.type);k=m.shift;var r=l.shift;k==null?d.append(Lv(c.apply(m.state,l.delta),r)):r==null?(d.append(m),Pv(e,k.zj,l.delta)):(d.append(Lv(m.state,{La:k.La,zj:r.zj})),Pv(e,k.zj,l.delta),Kxb(e,r.La,k.zj))}else k.type===4||l.type===4?(l=Nv(f,4),m=Nv(h,4),k=l.shift,r=
m.shift,k==null?d.append(Mv(c.lg(l.delta,m.delta),r)):r==null?(d.append(l),Pv(e,k.zj,m.delta)):(d.append(Mv(l.delta,{La:k.La,zj:r.zj})),Pv(e,k.zj,m.delta),Kxb(e,r.La,k.zj))):(m=Math.min(k.length,l.length),k=f.my(k.type,m),l=h.my(l.type,m),d.append(k.type===2||l.type===2?wxb(m):Kv(m)));else throw Error(`length mismatch: ${a} ; ${b}`);else throw Error(`length mismatch: ${a} ; ${b}`);k=f.head;l=h.head}return d.build(e)}transform(a,b){if(!a.Jb.length||!b.Jb.length)return pv(b,a);const c=this.component,
d=ax.create(a,b.pre,0),e=ax.create(Bxb(b,a.Nva),a.pre,0),f=this.Bd(),h=this.Bd(),k=ov.un(),l=new KBb(c),m=new KBb(c);for(var r=d.head,u=e.head;r||u;){if(r?.type===3)if(u=Nv(d,r.type),u.shift){var w=u.shift;r=Mv();h.append(r,"nocollapse");f.append(u);Rv(l,w.zj,r);Qv(l,w.La)}else h.append(GBb),f.append(u);else if(r?.type===1)u=d.my(r.type,r.length),h.append(Kv(u.length)),f.append(u);else if(u?.type===3)if(u=Nv(e,u.type),u.shift){r=u.shift;w=r.La;r=r.zj;var y=-w-1,z=Mv(void 0,{La:-r-1,zj:r});h.append(u);
f.append(z);Rv(m,r,z);Qv(m,w);Jxb(m,y,w)}else h.append(u),f.append(GBb);else if(u?.type===1)w=e.my(u.type,u.length),h.append(w),f.append(Kv(u.length));else if(r&&u)if(r.type===4||u.type===4){w=Nv(d,r.type);r=Nv(e,u.type);const {Ip:A,gq:C}=rv(k,c.transform(w.delta,r.delta));u=w.shift;r=r.shift;if(u)if(r){w=r.La;r=r.zj;y=u.La;u=u.zj;z=-w-1;const F=Mv(void 0,{La:-r-1,zj:r}),G=Mv(void 0,{La:w,zj:r});h.append(G);f.append(F);Rv(l,u,G);Rv(m,r,F);Qv(l,y,A);Qv(m,w,C);Jxb(m,z,y);Kxb(m,w,u)}else w=u.La,r=u.zj,
y=Mv(),h.append(y,"nocollapse"),f.append(Mv(C,u)),Rv(l,r,y),Qv(l,w,A);else r?(u=r.La,w=r.zj,y=-u-1,z=Mv(void 0,{La:-w-1,zj:w}),h.append(Mv(A,r)),f.append(z),Rv(m,w,z),Qv(m,u,C),Jxb(m,y,u)):(h.append(Mv(A)),f.append(Mv(C)))}else w=Math.min(r.length,u.length),r=d.my(r.type,w),u=e.my(u.type,w),r.type===2&&u.type===2?h.append(Kv(u.length)):h.append(u),f.append(r);else throw Error(`length mismatch (${a} x ${b})`);r=d.head;u=e.head}return k.build(h.build(l),f.build(m))}gj(a){if(!a.Jb.length)return a;const b=
this.Bd(),c=new JBb(this.component);for(const d of a.Jb)switch(d.type){case 0:case 1:case 2:b.Ob(d.length);break;case 4:a=this.component.gj(d.delta);const e=d.shift&&Mxb(d.shift);e?(b.Ob(e),Pv(c,e.zj,a)):b.append(Mv(a));break;case 3:a=d.shift&&Mxb(d.shift);d.state!=null?a?(b.Ob(a),Pv(c,a.zj,this.component.replace(d.state,void 0))):b.rQ(d.state):b.Ob(a);break;default:throw new n(d);}return b.build(c)}Bi(a,b){if(a===b)return!0;if(a.pre!==b.pre||a.post!==b.post||a.Jb.length!==b.Jb.length)return!1;for(let c=
0;c<a.Jb.length;c++)if(!this.KQb(a.Jb[c],b.Jb[c]))return!1;return!0}KQb(a,b){switch(a.type){case 0:case 1:case 2:return a.type===b.type&&a.length!==b.length;case 3:return a.type===b.type&&this.component.ni(a.state,b.state)&&Nxb(a.shift,b.shift);case 4:return a.type===b.type&&this.component.Bi(a.delta,b.delta)&&Nxb(a.shift,b.shift);default:throw new n(a);}}og(a){return new EBb(a)}identity(){return CBb}apply(a,b){if(!b.Jb.length)return a;const c=HBb.create(a,b.pre),d=new EBb(Math.max(a.length,b.pre)+
(b.post-b.pre));b=b.pre<a.length?[...b.Jb,Kv(a.length-b.pre)]:b.Jb;for(const e of b)switch(e.type){case 0:Cxb(d,Ov(c,e.length));break;case 1:d.expand(e.length);break;case 2:oa(Gxb(Ov(c,e.length)));d.expand(e.length);break;case 3:d.append(e.state,e.shift);break;case 4:d.append(this.component.apply(Hxb(c),e.delta),e.shift);break;default:throw new n(e);}c.finish();return mw(this.tf,a,Object.freeze(d.build()))}rj(a,b){if(!b.Jb.length)return a;const {unshift:c,F5d:d}=this.unshift(b);b=d;a=this.apply(a,
c);const e=HBb.create(a,b.post),f=new EBb(Math.max(a.length,b.post)+(b.pre-b.post));b=b.post<a.length?[...b.Jb,Kv(a.length-b.post)]:b.Jb;for(const h of b)switch(h.type){case 0:Cxb(f,Ov(e,h.length));break;case 1:oa(Gxb(Ov(e,h.length)));break;case 2:oa(Gxb(Ov(e,h.length)));f.expand(h.length);break;case 3:nv(this.component,h.state,Hxb(e));break;case 4:f.append(this.component.rj(Hxb(e),h.delta));break;default:throw new n(h);}e.finish();return mw(this.tf,a,Object.freeze(f.build()))}unshift(a){const b=
this.Bd(),c=this.Bd();for(const d of a.Jb)switch(d.type){case 0:b.append(d);c.append(d);break;case 1:case 2:b.append(Kv(d.length));c.append(d);break;case 4:d.shift?(b.Ob(Mxb(d.shift)),c.append(Mv(d.delta))):(b.Ob(),c.append(d));break;case 3:d.shift?(b.Ob(Mxb(d.shift)),c.append(Lv(d.state))):(b.Ob(),c.append(d));break;default:throw new n(d);}return{unshift:b.build(),F5d:c.build()}}Ze(a){const b=[];a.forEach((c,d)=>{c=this.component.Ze(c);c!=null&&(b[d]=c)});return Object.freeze(b)}ni(a,b){if(a===b)return!0;
if(a.length!==b.length)return!1;const c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(let e=0;e<c.length;e++)if(c[e]!==d[e]||!this.component.ni(a[c[e]],b[d[e]]))return!1;return!0}equals(a){return this===a||a instanceof LBb&&this.component.equals(a.component)}constructor(a,b){super(a);this.component=b;this.base=new FBb(this.component)}};var MBb=class extends $w{isIdentity(a){throw new n(a);}lg(a){throw new n(a);}transform(a){throw new n(a);}gj(a){throw new n(a);}Bi(a){throw new n(a);}identity(a){throw new n(a);}apply(a){throw new n(a);}rj(a){throw new n(a);}Ze(a){throw new n(a);}ni(a){throw new n(a);}equals(a){return this===a||a instanceof MBb}};var bx=class extends $w{isIdentity(a){return this.base.isIdentity(a)}lg(a,b){na(a==null===(b==null));return a!=null&&b!=null?this.component.lg(a,b):void 0}transform(a,b){na(a==null===(b==null));return a!=null&&b!=null?this.component.transform(a,b):pv(b,a)}gj(a){return a!=null?this.component.gj(a):void 0}Bi(a,b){return a!=null&&b!=null&&this.component.Bi(a,b)||a==null&&b==null}identity(a){return a!=null?this.component.identity(a):void 0}apply(a,b){na(a==null===(b==null));return a!=null&&b!=null?this.component.apply(a,
b):void 0}rj(a,b){na(a==null===(b==null));return a!=null&&b!=null?this.component.rj(a,b):void 0}Ze(a){return a!=null?this.component.Ze(a):void 0}ni(a,b){return a===b||a!=null&&b!=null&&this.component.ni(a,b)}equals(a){return this===a||a instanceof bx&&this.component.equals(a.component)}constructor(a,b){super(a);this.component=b;this.base=new BBb(this.component);na(!(b instanceof bx))}};var NBb=new Map,OBb=class{ordinal(a,b){b!=null?this.cNa.set(a,b):this.cNa.delete(a);return this}Fj(a){a.forEach((b,c)=>this.cNa.set(c,b));return this}build(){return this.cNa.size?this.cNa:NBb}constructor(){this.cNa=new Map}},Sv=class{toString(){return`R(${this.oldValue??"_"},${this.newValue??"_"})`}constructor(a,b){this.oldValue=a;this.newValue=b;this.type=0}},Uv=class{toString(){return`U(${this.oldValue},${this.newValue})`}constructor(a,b){this.oldValue=a;this.newValue=b;this.type=1}},cx=class{static create(a,
b,c,d){a=a.isIdentity(c);const e=d.size===0;return a&&e?b:new cx(a?b.axis:c,e?b.Fj:d)}toString(){const a=[...this.Fj].map(([b,c])=>`"${b}":${c}`).join(",");return`{${this.axis}|${a}}`}constructor(a,b){this.axis=a;this.Fj=b}},PBb=class{static create(a,b){return new PBb(a,b,a.Bd())}Ob(a){this.Boa.Ob(a);return this}expand(a){this.Boa.expand(a);return this}build(){return cx.create(this.axis,this.lJ,this.Boa.build(),this.Fj)}constructor(a,b,c){this.axis=a;this.lJ=b;this.Boa=c;this.Fj=new Map}},QBb=class extends $w{og(){return new OBb}Bd(){return PBb.create(this.axis,
this.lJ)}replace(a,b,c){return Tv(this.Bd(),a,b,c).build()}update(a,b,c){return Oxb(this.Bd(),a,b,c).build()}he(a,b){return cx.create(this.axis,this.lJ,a,b)}isIdentity(a){return this.axis.isIdentity(a.axis)&&!a.Fj.size}lg(a,b){if(this.isIdentity(a))return b;if(this.isIdentity(b))return a;const c=Qxb(this,a.Fj,b.axis),d=new Map;for(const k of Pxb(c,b.Fj)){var e=c.get(k);const l=b.Fj.get(k);if(e&&l){var f=d,h=f.set;a:{mv(e.newValue,l.oldValue);switch(e.type){case 0:e=new Sv(e.oldValue,l.newValue);break a;
case 1:switch(l.type){case 0:e=new Sv(e.oldValue,l.newValue);break a;case 1:e=new Uv(e.oldValue,l.newValue);break a;default:throw new n(l);}default:throw new n(e);}e=void 0}h.call(f,k,e)}else e?d.set(k,e):l&&d.set(k,l)}return cx.create(this.axis,this.lJ,this.axis.lg(a.axis,b.axis),d)}transform(a,b){if(this.isIdentity(a)||this.isIdentity(b))return pv(b,a);const c=ov.un(),{Ip:d,gq:e}=rv(c,this.axis.transform(a.axis,b.axis));a=Qxb(this,a.Fj,d);const f=Qxb(this,b.Fj,e);b=new Map;const h=new Map;for(var k of Pxb(a,
f)){var l=a.get(k);const m=f.get(k);if(l&&m){a:{mv(l.oldValue,m.oldValue);switch(l.type){case 0:l=qv(new Sv(m.newValue,l.newValue));break a;case 1:switch(m.type){case 0:l=new ov(new Sv(l.newValue,m.newValue),void 0,!1,!0);break a;case 1:l=qv(new Uv(m.newValue,l.newValue));break a;default:throw new n(m);}default:throw new n(l);}l=void 0}const {Ip:r,gq:u}=rv(c,l);u&&b.set(k,u);r&&h.set(k,r)}else l?b.set(k,l):m&&h.set(k,m)}k=cx.create(this.axis,this.lJ,d,h);a=cx.create(this.axis,this.lJ,e,b);return c.build(k,
a)}gj(a){const b=a.Fj.size===0?a.Fj:di(a.Fj,c=>{switch(c.type){case 0:return new Sv(c.newValue,c.oldValue);case 1:return new Uv(c.newValue,c.oldValue);default:throw new n(c);}});return cx.create(this.axis,this.lJ,this.axis.gj(a.axis),b)}Bi(a,b){if(a===b)return!0;if(!this.axis.Bi(a.axis,b.axis)||a.Fj.size!==b.Fj.size)return!1;for(const e of a.Fj.keys()){var c=a.Fj.get(e),d=b.Fj.get(e);if(c!==d&&(c==null||d==null||c.type!==d.type||c.oldValue!==d.oldValue||c.newValue!==d.newValue))return!1}return!0}identity(){return this.lJ}apply(a,
b){if(this.isIdentity(b)||!a.size&&!b.Fj.size)return a;const c=this.mra(a,b.axis);if(!b.Fj.size)return mw(this.tf,a,c);const d=new Map(c);for(const [e,f]of b.Fj)b=c.get(e),mv(b,f.oldValue),f.newValue!=null?d.set(e,f.newValue):d.delete(e);return mw(this.tf,a,d)}mra(a,b){if(this.axis.isIdentity(b))return a;const c=new Set(a.values()),d=uv(b,c);return di(a,e=>g(d.get(e)))}rj(a,b){if(this.isIdentity(b)||!a.size&&!b.Fj.size)return a;if(!b.Fj.size)return mw(this.tf,a,this.Dob(a,b.axis));const c=new Map(a);
for(const [d,e]of b.Fj){const f=a.get(d);mv(f,e.newValue);e.oldValue!=null?c.set(d,e.oldValue):c.delete(d)}return mw(this.tf,a,this.Dob(c,b.axis))}Dob(a,b){if(this.axis.isIdentity(b))return a;const c=new Set(a.values()),d=ywb(b,c);return di(a,e=>g(d.get(e)))}Ze(a){return new Map(a)}ni(a,b){return a===b?!0:a.size===b.size&&[...a.keys()].every(c=>a.get(c)===b.get(c))}equals(a){return this===a||a instanceof QBb}constructor(a,b){super(a);this.axis=b;this.uT=NBb;this.lJ=new cx(this.axis.Bd().build(),new Map)}};var RBb,Wv,Xv,Yv,VBb,SBb,TBb,WBb,XBb,YBb,ex,fx,$Bb,aCb,bCb,ZBb;RBb=class{};Wv=class extends RBb{get length(){return this.state.length}F1b(a){Rxb(this,a);return this.state.charAt(a)}uM(a){Sxb(this,a);return[new Wv(this.state.substring(0,a)),new Wv(this.state.substring(a))]}NJ(){return this}toString(){return this.state}constructor(a){super();this.state=a;this.type=0;na(!!a)}};
Xv=class extends RBb{get length(){return 1}F1b(a){Rxb(this,a);return this.state}uM(a){Sxb(this,a);throw Error();}NJ(a){return new Xv(a(this.state))}toString(){return`[${this.state}]`}constructor(a){super();this.state=a;this.type=1}};
Yv=class extends RBb{get length(){return this.state}F1b(a){Rxb(this,a)}uM(a){Sxb(this,a);return[new Yv(a),new Yv(this.state-a)]}NJ(){return this}toString(){return this.state<=7?"\u00b7".repeat(this.state):`\u00b7\u00b7(${this.state})\u00b7\u00b7`}constructor(a){super();this.state=a;this.type=2;na(!!a)}};
__c.dx=class{get length(){return this.nga+this.Wp+this.gJc}Fc(a){return new SBb(this,a)}cursor(a,b){return new TBb(this,a,b)}WKb(a){if(this.sequence.length!==0){na(a>=0,"{} < 0",a);var b=0,c=0;for(const d of this.sequence){const e=Vv(d),f=Math.abs(d)||1;if(a<f)switch(e){case 0:return this.Gf[b].charAt(a);case 1:return this.items[c];case 2:return;default:throw new n(e);}switch(e){case 0:mv(this.Gf[b].length,f);b++;break;case 1:c++;break;case 2:break;default:throw new n(e);}a-=f}}}NJ(a){return new __c.dx(this.sequence,
this.Gf,this.items.map(b=>a(b)),this.nga,this.Wp,this.gJc)}ud(){return this.Gf.join("")}forEach(a,b){let c=0,d=0;for(const e of this.sequence){const f=Vv(e);switch(f){case 0:mv(this.Gf[c].length,e);b.ud?.(this.Gf[c]);c++;break;case 1:b.item(this.items[d]);d++;break;case 2:b.lm?.(-e);break;default:throw new n(f);}}(a=Math.max(0,a-this.length))&&b.lm?.(a)}map(a,b){let c=0,d=0;const e=this.sequence.map(f=>{const h=Vv(f);switch(h){case 0:return mv(this.Gf[c].length,f),b.ud(this.Gf[c++]);case 1:return b.item(this.items[d++]);
case 2:return b.lm(-f);default:throw new n(h);}});(a=Math.max(0,a-this.length))&&e.push(b.lm(a));return e}reduce(a,b){let c=0,d=0;return this.sequence.reduce((e,f)=>{const h=Vv(f);switch(h){case 0:return mv(this.Gf[c].length,f),a.ud(e,this.Gf[c++]);case 1:return a.item(e,this.items[d++]);case 2:return a.lm?a.lm(e,-f):e;default:throw new n(h);}},b)}slice(a,b){na(0<=a&&a<=b,"invalid range: [{}, {})",a,b);var c=this.length;if(0===a&&b>=c)return this;if(a===b||a>=c)return __c.UBb;const d=new VBb;c=this.cursor(b);
c.fY(a);c.fY(b-a,{item:e=>d.item(e),ud:e=>d.Gf(e),lm:e=>d.E9(e)});return d.build()}toString(){let a=0,b=0;return this.sequence.map(c=>{const d=Vv(c);switch(d){case 0:return mv(this.Gf[a].length,c),this.Gf[a++];case 1:return`[${this.items[b++]}]`;case 2:return-c<7?"\u00b7".repeat(-c):`\u00b7\u00b7(${c})\u00b7\u00b7`;default:throw new n(d);}}).join("")}constructor(a,b,c,d,e,f){this.sequence=a;this.Gf=b;this.items=c;this.nga=d;this.Wp=e;this.gJc=f;a=a.length?a[a.length-1]:void 0;na(a==null||a>=0)}};
__c.UBb=new __c.dx([],[],[],0,0,0);
VBb=class{b9(a){this.mode!==a&&(this.flush(),this.mode=a)}flush(){if(this.mode!=null){switch(this.mode){case 0:this.ud.push(this.rIa);this.sequence.push(this.rIa.length);this.w7a+=this.rIa.length;this.rIa="";break;case 2:this.sequence.push(-this.t_a);this.Ynb+=this.t_a;this.t_a=0;break;default:throw new n(this.mode);}this.mode=void 0}}region(a){switch(a.type){case 0:return this.Gf(a.state);case 1:return this.item(a.state);case 2:return this.E9(a.state);default:throw new n(a);}}Gf(a){a&&(this.b9(0),
this.rIa+=a);return this}item(a){this.flush();this.items.push(a);this.sequence.push(0);this.VKb++;return this}E9(a){a>0&&(this.b9(2),this.t_a+=a);return this}append(a,b=0){a.forEach(b,{ud:c=>this.Gf(c),item:c=>this.item(c),lm:c=>this.E9(c)});return this}get length(){return this.w7a+this.VKb+this.Ynb}build(){this.mode!==2&&this.flush();return this.length?new __c.dx(this.sequence,this.ud,this.items,this.w7a,this.VKb,this.Ynb):__c.UBb}constructor(){this.sequence=[];this.ud=[];this.items=[];this.mode=
void 0;this.rIa="";this.Ynb=this.VKb=this.w7a=this.t_a=0}};
SBb=class{get head(){return this.Pj}get prevValue(){return this.kjb?.F1b(this.kjb.length-1)}fl(a){const b=g(this.Pj),c=b.length;na(0<a&&a<=c,"{} \u2209 (0, {}]",a,c);if(a<c)return a=b.uM(a),this.Pj=a[1],this.kjb=a[0];this.Pj=Uxb(this);return this.kjb=b}finish(){oa(this.Pj==null,"unconsumed reader head: {}",this.Pj)}constructor(a,b=0){this.yAd=this.R7c=this.rWd=0;this.kjb=void 0;this.sequence=(b=Math.max(0,b-a.length))?[...a.sequence,-b]:a.sequence;this.Gf=a.Gf;this.items=a.items;this.Pj=Uxb(this)}};
TBb=class{get prevValue(){return this.Fc.prevValue}move(a,b,c){for(c=Vxb(this.JWa,c);a;){var d=this.Fc.head;if(d)switch(d=this.Fc.fl(b||d.type!==2?Math.min(d.length,a):d.length),d.type){case 0:c&&c.ud?.(d.state);a-=d.length;break;case 1:c&&c.item?.(d.state);a-=d.length;break;case 2:c&&c.lm?.(d.state);b&&(a-=d.length);break;default:throw new n(d);}else na(b,"not enough characters or items: {}",a),c&&c.lm?.(a),a-=a}}fY(a,b){this.move(a,!0,b)}Bja(a,b){this.move(a,!1,b)}tgb(){const a=Vxb(this.JWa),b=
this.Fc.head;b&&b.type===2&&(this.Fc.fl(b.length),a&&a.lm?.(b.length))}moveBefore(a,b){mv(a.length,1);b=Vxb(this.JWa,b);let c=!1;for(;!c;){var d=this.Fc.head;if(!d)break;const e=d.type===0?d.state.indexOf(a):-1;if(d=(c=e!==-1)?e:d.length)switch(d=this.Fc.fl(d),d.type){case 0:b&&b.ud?.(d.state);break;case 1:b&&b.item?.(d.state);break;case 2:b&&b.lm?.(d.state);break;default:throw new n(d);}}return c}finish(){this.Fc.finish()}constructor(a,b,c){this.JWa=c;this.Fc=a.Fc(b)}};WBb=class{};
XBb=class extends WBb{get U1(){return this.length}get DU(){return this.length}Nmb(a){Wxb(this,a);return this.uM(a)}Mmb(a){Xxb(this,a);return this.uM(a)}uM(a){return[new XBb(a),new XBb(this.length-a)]}map(){return this}toString(){return`R${this.length}`}constructor(a){super();this.length=a;this.type=0}};
YBb=class extends WBb{get U1(){return 1}get DU(){return 1}Nmb(a){Wxb(this,a);throw Error();}Mmb(a){Xxb(this,a);throw Error();}map(a){return new YBb(a(this.delta))}toString(){return`U[${this.delta}]`}constructor(a){super();this.delta=a;this.type=1}};
ex=class extends WBb{get U1(){return 0}get DU(){return this.state.length}Nmb(a){Wxb(this,a);throw Error();}Mmb(a){Xxb(this,a);const [b,c]=this.state.uM(a);return[new ex(b),new ex(c)]}map(a,b){return new ex(this.state.NJ(b))}toString(){switch(this.state.type){case 0:case 1:return`I${this.state}`;case 2:return`X${this.state.length}`;default:throw new n(this.state);}}constructor(a){super();this.state=a;this.type=2}};
fx=class extends WBb{get U1(){return this.oldState.length}get DU(){return this.newState.length}Nmb(a){Wxb(this,a);return this.uM(a)}Mmb(a){Xxb(this,a);return this.uM(a)}uM(a){const [b,c]=this.oldState.uM(a),[d,e]=this.newState.uM(a);return[new fx(b,d),new fx(c,e)]}map(a,b){return new fx(this.oldState.NJ(b),this.newState.NJ(b))}toString(){return this.oldState.type===2?this.newState.type===2?`\u25e0${this.oldState.state}`:`\u2191${this.newState}`:this.newState.type===2?`\u2193${this.oldState}`:`\u25e1[${this.oldState}|${this.newState}]`}constructor(a,
b){super();this.oldState=a;this.newState=b;this.type=3;mv(a.length,b.length)}};
$Bb=class{Fc(a,b){return new ZBb(this,a,b)}forEach(a,b=this.pre,c=this.post){for(const d of this.Jb)switch(d.type){case 0:a.Ob?.(d.length);break;case 1:a.update?.(d.delta);break;case 2:a.insert?.(d.state);break;case 3:a.jp?.(d.oldState,d.newState);break;default:throw new n(d);}(b=Math.max(0,b-this.pre,c-this.post))&&a.Ob?.(b)}map(a){return this.Jb.map(b=>{switch(b.type){case 0:return a.Ob(b.length);case 1:return a.update(b.delta);case 2:return a.insert(b.state);case 3:return a.jp(b.oldState,b.newState);
default:throw new n(b);}})}NJ(a,b){const c=this.Jb.map(d=>d.map(a,b));return new $Bb(c,this.pre,this.post)}toString(){return`[${this.Jb.toString()}]`}constructor(a,b,c){this.Jb=a;this.pre=b;this.post=c}};aCb=new $Bb([],0,0);
bCb=class{b9(a,b,c){if(this.MU!==a||this.rOb!==b||this.QNb!==c)switch(this.flush(),this.MU=a,this.rOb=b,this.QNb=c,a){case 0:break;case 2:c===0&&(this.mR="");break;case 3:b===0&&(this.Xja="");c===0&&(this.mR="");break;default:throw new n(a);}}flush(){if(this.MU!=null){switch(this.MU){case 0:this.push(new XBb(this.acc));this.acc=0;break;case 2:var a=this.mR!=null?new Wv(this.mR):new Yv(this.acc);this.push(new ex(a));this.mR=void 0;this.acc=0;break;case 3:a=this.Xja!=null?new Wv(this.Xja):new Yv(this.acc);
const b=this.mR!=null?new Wv(this.mR):new Yv(this.acc);this.push(new fx(a,b));this.mR=this.Xja=void 0;this.acc=0;break;default:throw new n(this.MU);}this.QNb=this.rOb=this.MU=void 0}}push(a){this.Jb.push(a);this.pre+=a.U1;this.post+=a.DU}op(a){switch(a.type){case 0:return this.Ob(a.length);case 1:return this.update(a.delta);case 2:return this.I6(a.state);case 3:return Zv(this,a.oldState,a.newState);default:throw new n(a);}}I6(a){switch(a.type){case 0:return this.insert(a.state);case 1:return this.insert(a.state);
case 2:return this.expand(a.state);default:throw new n(a);}}Ob(a){na(a>=0);a&&(this.b9(0),this.acc+=a);return this}update(a){if(this.isIdentity(a))return this.Ob(1);this.flush();this.Jb.push(new YBb(a));this.pre++;this.post++;return this}expand(a){na(a>=0);a&&(this.b9(2,void 0,2),this.acc+=a);return this}insert(a){typeof a==="string"?a&&(this.b9(2,void 0,0),this.mR+=a):(this.flush(),this.push(new ex(new Xv(a))));return this}eV(a){na(a>=0);a&&(this.b9(3,2,2),this.acc+=a);return this}cfa(a){typeof a===
"string"?a&&(this.b9(3,2,0),this.acc+=a.length,this.mR+=a):(this.flush(),this.push(new fx(new Yv(1),new Xv(a))));return this}rQ(a){typeof a==="string"?a&&(this.b9(3,0,2),this.acc+=a.length,this.Xja+=a):(this.flush(),this.push(new fx(new Xv(a),new Yv(1))));return this}jp(a,b){typeof a==="string"?typeof b==="string"?(mv(a.length,b.length),a&&(this.b9(3,0,0),this.Xja+=a,this.mR+=b)):(mv(a.length,1),this.flush(),this.push(new fx(new Wv(a),new Xv(b)))):typeof b==="string"?(mv(1,b.length),this.flush(),
this.push(new fx(new Xv(a),new Wv(b)))):(this.flush(),this.push(new fx(new Xv(a),new Xv(b))));return this}build(){this.MU!==0&&this.flush();return new $Bb(this.Jb,this.pre,this.post)}constructor(a){this.isIdentity=a;this.Jb=[];this.post=this.pre=0;this.QNb=this.rOb=this.MU=void 0;this.acc=0;this.mR=this.Xja=void 0}};ZBb=class{get head(){return this.Pj}finish(){oa(this.Pj==null)}constructor(a,b=0,c=0){this.Jb=(b=Math.max(0,b-a.pre,c-a.post))?[...a.Jb,new XBb(b)]:a.Jb;this.i=0;this.Pj=this.Jb[this.i++]}};
__c.gx=class extends $w{Bd(){return new bCb(a=>this.component.isIdentity(a))}og(){return new VBb}id(){return aCb}uT(){return __c.UBb}isIdentity(a){return!a.Jb.length||a.Jb.every(b=>b.type===0)}lg(a,b){if(!a.Jb.length)return b;if(!b.Jb.length)return a;const c=a.Fc(0,b.pre),d=b.Fc(a.post,0),e=this.Bd();for(;;){let h=c.head;var f=d.head;if(!f)break;f.type===2?(h=void 0,f=$v(d)):h&&(f=Math.min(h.DU,f.U1),h=Yxb(c,f),f=aw(d,f));if(f.type===2)e.I6(f.state);else if(h)h.type===2?e.I6(bw(this,h.state,f)):f.type===
0?e.op(h):h.type===0?e.op(f):h.type===1?f.type===1?e.update(this.component.lg(h.delta,f.delta)):Zv(e,$xb(this,f.oldState,h),f.newState):Zv(e,h.oldState,bw(this,h.newState,f));else throw Error(`length mismatch: ${a} ; ${b}`);}c.finish();d.finish();return e.build()}transform(a,b){if(!a.Jb.length||!b.Jb.length)return pv(b,a);const c=this.Bd(),d=this.Bd(),e=a.Fc(b.pre,0),f=b.Fc(a.pre,0),h=ov.un();for(;;){var k=e.head,l=f.head;if(!k&&!l)break;k&&k.type===2?(k=$v(e),l=void 0):l&&l.type===2?(k=void 0,l=
$v(f)):k&&l&&(l=Math.min(k.U1,l.U1),k=aw(e,l),l=aw(f,l));if(k&&k.type===2)d.Ob(k.DU),c.op(k);else if(l&&l.type===2)d.op(l),c.Ob(l.DU);else if(k&&l)k.type===0||l.type===0?(d.op(l),c.op(k)):k.type===3?(d.Ob(k.DU),Zv(c,bw(this,k.oldState,l),k.newState),uwb(h,l.type===3?!cw(this,k.newState,l.newState):!this.component.isIdentity(l.delta))):l.type===3?(Zv(d,bw(this,l.oldState,k),l.newState),c.Ob(l.DU),vwb(h,!this.component.isIdentity(k.delta))):(k=rv(h,this.component.transform(k.delta,l.delta)),d.update(k.Ip),
c.update(k.gq));else throw Error(`length mismatch (${a} x ${b})`);}e.finish();f.finish();return h.build(d.build(),c.build())}gj(a){if(!a.Jb.length)return a;const b=this.Bd();for(const c of a.Jb)switch(c.type){case 0:b.Ob(c.length);break;case 1:b.update(this.component.gj(c.delta));break;case 2:a=c.state;a.type===2?b.Ob(a.length):b.rQ(a.state);break;case 3:a=c.oldState;const d=c.newState;a.type===2&&d.type===2?b.Ob(a.length):Zv(b,d,a);break;default:throw new n(c);}return b.build()}Bi(a,b){if(a===b)return!0;
if(a.Jb.length!==b.Jb.length)return!1;for(let c=0;c<a.Jb.length;c++)if(!this.KQb(a.Jb[c],b.Jb[c]))return!1;return!0}KQb(a,b){switch(a.type){case 0:return b.type===0&&a.length===b.length;case 1:return b.type===1&&this.component.Bi(a.delta,b.delta);case 2:return b.type===2&&cw(this,a.state,b.state);case 3:return b.type===3&&cw(this,a.oldState,b.oldState)&&cw(this,a.newState,b.newState);default:throw new n(a);}}identity(){return aCb}apply(a,b){if(!b.Jb.length)return a;const c=this.og(),d=a.Fc(b.pre);
for(b=b.Fc(a.length,0);;){let f=d.head;var e=b.head;if(!e)break;e.type===2?(f=void 0,e=$v(b)):f&&(e=Math.min(f.length,e.U1),f=d.fl(e),e=aw(b,e));if(e.type===2)c.region(e.state);else if(f)c.region(bw(this,f,e));else break}d.finish();b.finish();return mw(this.tf,a,c.build())}rj(a,b){if(!b.Jb.length)return a;const c=this.og(),d=a.Fc(b.post);for(b=b.Fc(0,a.length);;){let f=d.head;var e=b.head;if(!f||!e)break;e.type===2?(f=d.fl(e.DU),e=$v(b)):(e=Math.min(f.length,e.DU),f=d.fl(e),e=Yxb(b,e));if(e.type===
2)Zxb(this,f,e.state);else if(f)c.region($xb(this,f,e));else break}d.finish();b.finish();return mw(this.tf,a,c.build())}Ze(a){return this.component instanceof MBb&&a instanceof __c.dx?a:a.NJ(b=>this.component.Ze(b))}ni(a,b){if(a===b)return!0;if(a.length!==b.length)return!1;a=a.Fc();b=b.Fc();let c=a.head,d=b.head;for(;c||d;){if(!c||!d||!cw(this,c,d))return!1;a.fl(c.length);b.fl(d.length);c=a.head;d=b.head}return!0}equals(a){return this===a||a instanceof __c.gx&&this.component.equals(a.component)}constructor(a,
b){super(a);this.component=b}};__c.gx.prototype.WD=ba(119);Nw=__c.Nw={item:a=>{throw new n(a);}};var cCb=new Map,hx=class{static from(a){if(a instanceof hx)return a;if(Array.isArray(a)){const [b,c]=a;return new hx(b,c)}return new hx(a.start,a.end)}toString(){return`[${this.start},${this.end}]`}constructor(a,b){this.start=a;this.end=b}},dCb=class{range(a,b){b?this.g_.set(a,hx.from(b)):this.g_.delete(a);return this}Ve(a){a.forEach((b,c)=>this.g_.set(c,hx.from(b)));return this}build(){return this.g_.size?this.g_:cCb}constructor(){this.g_=new Map}},eCb=class{toString(){return`R(${this.oldValue??
"_"},${this.newValue??"_"})`}constructor(a,b){this.oldValue=a;this.newValue=b;this.type="replace"}},ix=class{static from(a){if(a instanceof ix)return a;if(Array.isArray(a)){const [b,c]=a;return new ix(b,c)}return new ix(a.oldValue,a.newValue)}toString(){return`[${this.oldValue},${this.newValue}]`}constructor(a,b){this.oldValue=a;this.newValue=b}},fCb=class{toString(){return`U(${this.start??"_"},${this.end??"_"})`}constructor(a,b){this.start=a;this.end=b;this.type="update"}},jx=class{static create(a,
b,c,d){a=a.isIdentity(c);const e=d.size===0;return a&&e?b:new jx(a?b.axis:c,e?b.Ve:d)}toString(){return`{${this.axis}|${[...this.Ve].map(([a,b])=>`"${a}":${b}`).join(",")}}`}constructor(a,b){this.axis=a;this.Ve=b}},gCb=class{static create(a,b){return new gCb(a,b,a.Bd())}Ob(a){this.Boa.Ob(a);return this}expand(a){this.Boa.expand(a);return this}B_a(a,b,c){this.Ve.set(a,new eCb(b&&hx.from(b),c&&hx.from(c)));return this}createRange(a,b){return this.B_a(a,void 0,b)}build(){return jx.create(this.axis,this.lJ,
this.Boa.build(),this.Ve)}constructor(a,b,c){this.axis=a;this.lJ=b;this.Boa=c;this.Ve=new Map}};oa(!0);
var Gzb=class{constructor(a,b,c){this.qk=a;this.axis=b;this.lJ=c;this.z_b=d=>dw(d);this.WIc=d=>{const e=new Map;for(const [f,h]of d)d=dw(f),e.set(d.start,h.start),e.set(d.end,h.end);return e};this.mrd=d=>ayb(d);this.xjc=d=>{const e=new Map;d=new Map(d);for(const f of d.keys()){const h=ayb(f),k=dw(h),l=g(d.get(k.start)),m=g(d.get(k.end));d.delete(k.start);d.delete(k.end);e.set(h,hx.from({start:l,end:m}))}if(d.size)throw Error();return e};this.VIc=d=>{var e=this.qk;const f=e.Bd();for(const [k,l]of d.Ve)switch(l.type){case "replace":var h=
dw(k);Tv(f,h.start,l.oldValue?l.oldValue.start:void 0,l.newValue?l.newValue.start:void 0);Tv(f,h.end,l.oldValue?l.oldValue.end:void 0,l.newValue?l.newValue.end:void 0);break;case "update":h=dw(k);l.start&&Oxb(f,h.start,l.start.oldValue,l.start.newValue);l.end&&Oxb(f,h.end,l.end.oldValue,l.end.newValue);break;default:throw new n(l);}return e.he(d.axis,f.build().Fj)};this.wjc=d=>{var e=this.axis,f=this.lJ;const h=new Map,k=new Map(d.Fj);for(const [r,u]of k){const w=ayb(r),y=dw(w);switch(u.type){case 0:var l=
g(k.get(y.start)),m=g(k.get(y.end));oa(l.type===u.type);oa(m.type===u.type);oa(l.oldValue!=null===(m.oldValue!=null));oa(l.newValue!=null===(m.newValue!=null));k.delete(y.start);k.delete(y.end);h.set(w,new eCb(l.oldValue!=null&&m.oldValue!=null?hx.from([l.oldValue,m.oldValue]):void 0,l.newValue!=null&&m.newValue!=null?hx.from([l.newValue,m.newValue]):void 0));break;case 1:l=k.get(y.start);m=k.get(y.end);l&&oa(l.type===u.type);m&&oa(m.type===u.type);k.delete(y.start);k.delete(y.end);h.set(w,new fCb(l?
ix.from(l):void 0,m?ix.from(m):void 0));break;default:throw new n(u);}}if(k.size)throw Error();return jx.create(e,f,d.axis,h)}}},hCb=class extends $w{static create(a,b,c){var d=new jx(c.Bd().build(),new Map);d=new Gzb(b,c,d);return new hCb(b.map(d.wjc,d.VIc,d.xjc,d.WIc),c,a)}og(){return new dCb}Bd(){return gCb.create(this.axis,this.lJ)}replace(a,b,c){return this.Bd().B_a(a,b,c).build()}update(a,b,c){var d=this.Bd();d.Ve.set(a,new fCb(b&&ix.from(b),c&&ix.from(c)));return d.build()}he(a,b){return jx.create(this.axis,
this.lJ,a,b)}isIdentity(a){return this.z_.isIdentity(a)}lg(a,b){return this.z_.lg(a,b)}transform(a,b){return this.z_.transform(a,b)}gj(a){return this.z_.gj(a)}Bi(a,b){return this.z_.Bi(a,b)}identity(a){return this.z_.identity(a)}apply(a,b){return this.z_.apply(a,b)}rj(a,b){return this.z_.rj(a,b)}Ze(a){return this.z_.Ze(a)}ni(a,b){return this.z_.ni(a,b)}equals(a){return this.z_.equals(a)}constructor(a,b,c){super(c);this.z_=a;this.axis=b;this.uT=cCb;this.lJ=new jx(this.axis.Bd().build(),new Map)}};var iCb=class extends $w{get target(){typeof this.ref==="function"&&(this.ref=this.ref());return this.ref}isIdentity(a){return this.target.isIdentity(a)}lg(a,b){return this.target.lg(a,b)}transform(a,b){return this.target.transform(a,b)}gj(a){return this.target.gj(a)}Bi(a,b){return this.target.Bi(a,b)}identity(a){return this.target.identity(a)}apply(a,b){return this.target.apply(a,b)}rj(a,b){return this.target.rj(a,b)}Ze(a){return this.target.Ze(a)}ni(a,b){return this.target.ni(a,b)}equals(a){return this===
a||a instanceof iCb&&this.target.equals(a.target)}constructor(a,b){super(a);this.ref=b}};var kCb,jCb,lx,lCb,mCb,nCb,oCb;
kx=__c.kx=class{WKb(a){return this.cells.WKb(a)}cursor(a,b){return new jCb(this,a,b)}forEach(a){this.cursor(0,a).fY(this.length)}NJ(a){return new kx(this.cells.NJ(a),this.attrs,this.wc,this.oJa)}slice(a,b){na(0<=a&&a<=b,"invalid range: [{}, {})",a,b);if(0===a&&b>=this.length)return this;const c=this.cells.slice(a,b),d=this.attrs.slice(a,b);return new kx(c,d,this.wc?.slice(a,b),this.oJa)}toString(){return`${this.cells.toString()}|${this.attrs.toString()}`}constructor(a,b,c,d){this.cells=a;this.attrs=
b;this.wc=c;this.oJa=d;this.length=Math.max(a.length,b.length)}};
kCb=class{items(a){return this.Gf(a)}Gf(a){this.J_.Gf(a);this.XM.um(a.length);return this}item(a){this.J_.item(a);this.XM.um(1);return this}E9(a){this.J_.E9(a);this.XM.um(a);return this}tc(a,b,c){this.XM.tc(a,b,c);return this}attrs(a,b){this.XM.attrs(a,b);return this}append(a,b=0){this.J_.append(a.cells,b);this.XM.append(a.attrs,b);return this}vlb(a){this.z0a?.Ve(a);return this}build(){return new kx(this.J_.build(),this.XM.build(),this.z0a?.build(),this.oJa)}constructor(a,b,c,d){this.J_=a;this.XM=
b;this.z0a=c;this.oJa=d}};
jCb=class{get prevValue(){return this.c.prevValue}get wda(){return this.a.wda}get xda(){return this.a.xda}fY(a,b){this.Cja=b;this.c.fY(a);this.Cja=void 0}Bja(a,b){this.Cja=b;this.c.Bja(a);this.Cja=void 0}tgb(){this.Cja=void 0;this.c.tgb();this.Cja=void 0}moveBefore(a,b){this.Cja=b;a=this.c.moveBefore(a);this.Cja=void 0;return a}finish(){this.c.finish();this.a.finish()}constructor(a,b=0,c){b=Math.max(a.length,b);let d,e;this.a=a.attrs.cursor(b,{cells:(h,k,l,m,r)=>{var u=g(d);const w=u.length;na(0<
h&&h<=w);h<w?(u=u.uM(h),h=u[0],d=u[1]):(h=u,d=void 0);if(e)switch(h.type){case 0:e.ud&&e.ud(h.state,k,l,m,r);break;case 1:e.item&&e.item(h.state,k,l,m,r);break;case 2:e.lm&&e.lm(h.state,k,l,m,r);break;default:throw new n(h);}}});const f=h=>{d=h;var k=this.Cja;e=k?c?{ud:vv(k.ud,c.ud),item:vv(k.item,c.item),lm:vv(k.lm,c.lm)}:k:c;this.a.move(h.length);oa(d==null);e=void 0};this.c=a.cells.cursor(b,{ud:h=>f(new Wv(h)),item:h=>f(new Xv(h)),lm:h=>f(new Yv(h))})}};
lx=class{forEach(a){const b=this.MI.Fc(this.pre,this.post);this.TI.forEach({Ob:c=>{for(;c>0;){var d=g(b.next);switch(d.type){case 1:throw Error("op mismatch: retain|insert");case 0:d=Math.min(d.length,c);const e=b.xu(d);a.Ob&&a.Ob(d,e,b.eI);c-=d;break;default:throw new n(d);}}},update:c=>{var d=g(b.next);switch(d.type){case 1:throw Error("op mismatch: retain|insert");case 0:d=b.xu(1);a.update&&a.update(c,d,b.eI);break;default:throw new n(d);}},insert:c=>{for(;;){var d=g(b.next);switch(d.type){case 1:d=
Math.min(d.length,c.length);const e=b.k5(d);if(d===c.length){a.insert&&a.insert(c,e,b.eI);return}const [f,h]=c.uM(d);a.insert&&a.insert(f,e,b.eI);c=h;break;case 0:throw Error("op mismatch: insert|retain");default:throw new n(d);}}},jp:(c,d)=>{for(;;){var e=g(b.next);switch(e.type){case 1:throw Error("op mismatch: change|insert");case 0:e=Math.min(e.length,c.length);const f=b.xu(e);if(e===c.length){a.jp&&a.jp(c,d,f,b.eI);return}const [h,k]=c.uM(e),[l,m]=d.uM(e);a.jp&&a.jp(h,l,f,b.eI);c=k;d=m;break;
default:throw new n(e);}}}},this.pre,this.post);b.finish()}NJ(a,b){return new lx(this.TI.NJ(a,b),this.MI,this.xA)}toString(){return`${this.TI.toString()}|${this.MI.toString()}|${this.xA?.toString()}}`}constructor(a,b,c){this.TI=a;this.MI=b;this.xA=c;this.pre=Math.max(this.TI.pre,this.MI.pre);this.post=Math.max(this.TI.post,this.MI.post)}};
lCb=class{I6(a,b){this.cells.I6(a);this.attrs.insert(a.length,b);this.wc?.insert(a.length);return this}Ob(a,b){this.cells.Ob(a);this.attrs.Ob(a,b);this.wc?.Ob(a);return this}update(a){this.cells.update(a);this.attrs.Ob(1);this.wc?.Ob(1);return this}expand(a){this.cells.expand(a);this.attrs.insert(a);this.wc?.insert(a);return this}insert(a,b){const c=ew(a);this.cells.insert(a);this.attrs.insert(c,b);this.wc?.insert(c);return this}eV(a){this.cells.eV(a);this.attrs.Ob(a);this.wc?.Ob(a);return this}cfa(a){const b=
ew(a);this.cells.cfa(a);this.attrs.Ob(b);this.wc?.Ob(b);return this}rQ(a){const b=ew(a);this.cells.rQ(a);this.attrs.Ob(b);this.wc?.Ob(b);return this}replace(a,b){const c=ew(a);this.cells.jp(a,b);this.attrs.Ob(c);this.wc?.Ob(c);return this}build(){return new lx(this.cells.build(),this.attrs.build(),this.wc?.build())}constructor(a,b,c){this.cells=a;this.attrs=b;this.wc=c}};
mCb=class{Ob(a){this.Gf.Ob(a);this.attrs.Ob(a);this.wc?.Ob(a);return this}insert(a){const b=typeof a==="string"?a.length:1;this.Gf.insert(a);this.attrs.insert(b);this.wc?.insert(b);return this}delete(a){const b=typeof a==="string"?a.length:1;this.Gf.rQ(a);this.attrs.Ob(b);this.wc?.Ob(b);return this}open(a,b,c){this.attrs.open(a,b,c);return this}update(a){this.Gf.update(a);this.attrs.Ob(1);this.wc?.Ob(1);return this}S7(a){this.attrs.S7(a)}close(a){this.attrs.close(a);return this}bN(a){this.attrs.bN(a);
return this}build(){return new lx(this.Gf.build(),this.attrs.build(),this.wc?.build())}constructor(a,b,c){this.Gf=a;this.attrs=b;this.wc=c}};
nCb=class{I6(a,b){const c=a.length;this.cells.I6(a);this.attrs.insert(c,b);this.wc?.insert(c);return this}Ob(a,b){this.cells.Ob(a);this.attrs.Ob(a,b);this.wc?.Ob(a);return this}update(a){this.cells.update(a);this.attrs.Ob(1);this.wc?.Ob(1);return this}expand(a){this.cells.expand(a);this.attrs.insert(a);this.wc?.insert(a);return this}insert(a,b){const c=ew(a);this.cells.insert(a);this.attrs.insert(c,b);this.wc?.insert(c);return this}eV(a){this.cells.eV(a);this.attrs.Ob(a);this.wc?.Ob(a);return this}cfa(a){const b=
ew(a);this.cells.cfa(a);this.attrs.Ob(b);this.wc?.Ob(b);return this}rQ(a){const b=ew(a);this.cells.rQ(a);this.attrs.Ob(b);this.wc?.Ob(b);return this}replace(a,b){const c=ew(a);this.cells.jp(a,b);this.attrs.Ob(c);this.wc?.Ob(c);return this}build(){return new lx(this.cells.build(),this.attrs.build(),this.wc?.build())}constructor(a,b,c){this.cells=a;this.attrs=b;this.wc=c}};
oCb=class{items(a){return this.Gf(a)}Gf(a){this.J_.Gf(a);this.XM.um(a.length);return this}item(a){this.J_.item(a);this.XM.um(1);return this}E9(a){this.J_.E9(a);this.XM.um(a);return this}tc(a,b){this.XM.tc(a,b);return this}attrs(a){this.XM.attrs(a);return this}append(a,b=0){this.J_.append(a.cells,b);this.XM.append(a.attrs,b);return this}vlb(a){this.z0a?.Ve(a);return this}build(){return new kx(this.J_.build(),this.XM.build(),this.z0a?.build(),this.oJa)}constructor(a,b,c,d){this.J_=a;this.XM=b;this.z0a=
c;this.oJa=d}};
__c.pCb=class extends $w{Bd(a){const b=this.cells.Bd(),c=this.wc?.Bd();return a?new nCb(b,this.attrs.Bd(a),c):new lCb(b,this.attrs.Bd(),c)}zC(a,b){return new mCb(this.cells.Bd(),this.attrs.zC(a.attrs,a.length,b),this.wc?.Bd())}og(a){const b=this.cells.og();return a?new oCb(b,this.attrs.og(a),this.wc?.og(),this.wc):new kCb(b,this.attrs.og(),this.wc?.og(),this.wc)}he(a=this.cells.id(),b=this.attrs.id()){var c=this.wc?.id();na(!this.wc===!c);return new lx(a,b,c)}bvb(a,b){return this.attrs.zC(a.attrs,a.length,
b)}isIdentity(a){na(!this.wc===!a.xA);return this.cells.isIdentity(a.TI)&&this.attrs.isIdentity(a.MI)&&(!this.wc||this.wc.isIdentity(a.xA))}lg(a,b){na(!this.wc===!a.xA);na(!this.wc===!b.xA);return new lx(this.cells.lg(a.TI,b.TI),this.attrs.lg(a.MI,b.MI),this.wc?.lg(a.xA,b.xA))}transform(a,b){na(!this.wc===!a.xA);na(!this.wc===!a.xA);const c=ov.un(),d=rv(c,this.cells.transform(a.TI,b.TI)),e=rv(c,this.attrs.transform(a.MI,b.MI));a=rv(c,this.wc?.transform(a.xA,b.xA)||pv());return c.build(new lx(d.Ip,
e.Ip,a.Ip),new lx(d.gq,e.gq,a.gq))}gj(a){na(!this.wc===!a.xA);return new lx(this.cells.gj(a.TI),this.attrs.gj(a.MI),this.wc?.gj(a.xA))}Bi(a,b){na(!this.wc===!a.xA);na(!this.wc===!b.xA);return this.cells.Bi(a.TI,b.TI)&&this.attrs.Bi(a.MI,b.MI)&&(!this.wc||this.wc.Bi(a.xA,b.xA))}identity(){return this.id}apply(a,b){na(!this.wc===!a.wc);na(!this.wc===!b.xA);return mw(this.tf,a,new kx(this.cells.apply(a.cells,b.TI),this.attrs.apply(a.attrs,b.MI),this.wc?.apply(a.wc,b.xA),this.wc))}rj(a,b){na(!this.wc===
!a.wc);na(!this.wc===!b.xA);return mw(this.tf,a,new kx(this.cells.rj(a.cells,b.TI),this.attrs.rj(a.attrs,b.MI),this.wc?.rj(a.wc,b.xA),this.wc))}Ze(a,b){na(!this.wc===!a.wc);const c=this.cells.Ze(a.cells);b=this.attrs.Ze(a.attrs,b);const d=this.wc?.Ze(a.wc);return c===a.cells&&b===a.attrs&&d===a.wc&&a instanceof kx?a:new kx(c,b,d,this.wc)}ni(a,b){if(a===b)return!0;na(!this.wc===!a.wc);na(!this.wc===!b.wc);return this.cells.ni(a.cells,b.cells)&&this.attrs.ni(a.attrs,b.attrs)&&(!this.wc||this.wc.ni(a.wc,
b.wc))}equals(a){return this===a?!0:a instanceof __c.pCb?this.cells.equals(a.cells)&&this.attrs.equals(a.attrs)&&$w.equals(this.wc,a.wc):!1}constructor(a,b,c,d){super(a);this.cells=b;this.attrs=c;this.wc=d;this.id=this.he()}};__c.pCb.prototype.WD=ba(118);var gw,qCb,rCb,sCb,hw,uCb,tCb,wCb,xCb,yCb,vCb;gw=class{static from(a){if(a instanceof gw)return a;if(Array.isArray(a)){const [b,c]=a;return new gw(b,c)}return new gw(a.from,a.to)}toString(){return`[${this.from},${this.to}]`}constructor(a,b){this.from=a;this.to=b}};
qCb=class{get isEmpty(){return!this.Ve.size}slice(a,b){na(0<=a&&a<=b,"invalid range: [{}, {})",a,b);const c=new Map;for(const [e,f]of this.Ve){var d=b<f.from||f.to<a?void 0:new gw(Math.max(f.from,a)-a,Math.min(f.to,b)-a);d&&c.set(e,d)}return new qCb(c)}toString(){return[...this.Ve].map(([a,b])=>`"${a}":${b}`).join(",")}constructor(a=new Map){this.Ve=a}};rCb=new qCb;
sCb=class{range(a,b){b?this.g_.set(a,gw.from(b)):this.g_.delete(a);return this}Ve(a){a.forEach((b,c)=>this.g_.set(c,gw.from(b)));return this}build(){return this.g_.size?new qCb(this.g_):rCb}constructor(){this.g_=new Map}};hw=class{toString(){return`${this.V1||"_"}->${this.O1||"_"}`}constructor(a,b){this.V1=a;this.O1=b}};uCb=class{toString(){return`${tCb[this.type]}${this.length}`}constructor(a,b){this.type=a;this.length=b}};tCb={[0]:"R",[1]:"I"};
wCb=class{Fc(a,b){return new vCb(this,a,b)}toString(){const a=this.a5.join(""),b=[...this.Ve].map(([c,d])=>`"${c}":${d}`).join(",");return`{${a}|${b}}`}constructor(a,b,c,d){this.a5=a;this.Ve=b;this.pre=c;this.post=d}};xCb=new wCb([],new Map,0,0);
yCb=class{append(a,b){na(b>=0,"{} < 0",b);if(!b)return this;this.MU===a?this.length+=b:(this.MU!=null&&this.Jb.push(new uCb(this.MU,this.length)),this.MU=a,this.length=b);switch(a){case 0:this.pre+=b;this.post+=b;break;case 1:this.post+=b;break;default:throw new n(a);}return this}Ob(a){return this.append(0,a)}insert(a){return this.append(1,a)}createRange(a,b){return this.B_a(a,void 0,b)}B_a(a,b,c){b=new hw(b&&gw.from(b),c&&gw.from(c));this.Ve.set(a,b);return this}Tva(a){a.forEach((b,c)=>this.Ve.set(c,
b));return this}build(){const a=this.MU,b=this.length;a===0?(this.pre-=b,this.post-=b):a!=null&&this.Jb.push(new uCb(a,b));return this.Jb.length||this.Ve.size?new wCb(this.Jb,this.Ve,this.pre,this.post):xCb}constructor(){this.Jb=[];this.MU=void 0;this.post=this.pre=this.length=0;this.Ve=new Map}};
vCb=class{get next(){return this._next}get hSb(){return this.h5a}get ajb(){return this.Dya}get Ksa(){return this.Dya-this.h5a}yC(a,b){const c=g(this._next);oa(c.type===a,"{} != {}",c.type,a);na(0<b&&b<=c.length,"{} \u2209 ({}, {}]",b,0,c.length);this._next=b<c.length?new uCb(a,c.length-b):this.i<this.input.length?this.input[this.i++]:void 0}xu(a){this.yC(0,a);this.h5a+=a;this.Dya+=a}k5(a){this.yC(1,a);this.Dya+=a}finish(){oa(!this._next)}constructor(a,b=0,c=0){this.Dya=this.h5a=this.i=0;this.input=
(b=Math.max(0,b-a.pre,c-a.post))?[...a.a5,new uCb(0,b)]:a.a5;this._next=this.i<this.input.length?this.input[this.i++]:void 0}};
__c.zCb=class extends $w{og(){return new sCb}Bd(){return new yCb}isIdentity(a){return!a.a5.length&&!a.Ve.size}lg(a,b){if(this.isIdentity(a))return b;if(this.isIdentity(b))return a;const c=new Map,d=new Map,e=new Map;for(var f of eyb(a.Ve,b.Ve)){var h=a.Ve.get(f),k=b.Ve.get(f);h&&k?(na(fw(h.O1,k.V1)),e.set(f,new hw(h.V1,k.O1))):h?c.set(f,h):k&&d.set(f,k)}f=this.Bd();h=a.Fc(0,b.pre);a=b.Fc(a.post,0);b=h.next;for(k=a.next;k;){if(k.type===1)b=k.length,iw(c,void 0,h.ajb+a.Ksa,b),a.k5(b),f.insert(b);else if(b)b.type===
1?(b=Math.min(b.length,k.length),iw(d,a.hSb-h.Ksa,void 0,-b),h.k5(b),a.xu(b),f.insert(b)):(b=Math.min(b.length,k.length),h.xu(b),a.xu(b),f.Ob(b));else throw Error("length mismatch");b=h.next;k=a.next}h.finish();a.finish();f.Tva(e);f.Tva(c);f.Tva(d);return f.build()}transform(a,b){if(this.isIdentity(a)||this.isIdentity(b))return pv(b,a);var c=new Map,d=new Map;const e=new Map,f=ov.un();for(var h of eyb(a.Ve,b.Ve)){var k=a.Ve.get(h),l=b.Ve.get(h);k&&l?(na(fw(k.V1,l.V1)),e.set(h,new hw(l.O1,k.O1)),uwb(f)):
k?c.set(h,k):l&&d.set(h,l)}k=a.Fc(b.pre,0);l=b.Fc(a.pre,0);h=this.Bd();const m=this.Bd();var r=k.next;let u=l.next;for(;r||u;){if(r&&r.type===1)r=r.length,iw(d,l.hSb+k.Ksa,l.ajb+k.Ksa,r),k.k5(r),m.Ob(r),h.insert(r);else if(u&&u.type===1)r=u.length,iw(c,k.hSb+l.Ksa,k.ajb+l.Ksa,r),iw(e,void 0,k.ajb+l.Ksa,r),l.k5(r),m.insert(r),h.Ob(r);else if(r&&u)r=Math.min(r.length,u.length),k.xu(r),l.xu(r),m.Ob(r),h.Ob(r);else throw Error(`unreachable case: ${r} x ${u}`);r=k.next;u=l.next}k.finish();l.finish();d=
m.Tva(d).build();c=h.Tva(c).Tva(e).build();mv(d.post-d.pre,b.post-b.pre);mv(c.post-c.pre,a.post-a.pre);return f.build(d,c)}gj(a){if(!a.Ve.size)return xCb;const b=new Map(a.Ve);byb(a,{insert:(c,d,e)=>iw(b,e,void 0,c)});a=di(b,c=>new hw(c.O1,c.V1));return new wCb([],a,0,0)}Bi(a,b){if(a===b)return!0;if(a.a5.length!==b.a5.length||a.Ve.size!==b.Ve.size)return!1;for(let e=0;e<a.a5.length;e++){var c=a.a5[e],d=b.a5[e];if(c.type!==d.type||c.length!==d.length)return!1}for(const e of a.Ve.keys())if(c=a.Ve.get(e),
d=b.Ve.get(e),c?!(d&&fw(c.V1,d.V1)&&fw(c.O1,d.O1)):d)return!1;return!0}id(){return xCb}identity(){return xCb}apply(a,b){if(this.isIdentity(b)||!a.Ve.size&&!b.Ve.size)return a;const c=this.og(),d=new Map(a.Ve);for(const [e,f]of b.Ve)na(fw(a.Ve.get(e),f.V1)),d.delete(e),c.range(e,f.O1);byb(b,{insert:(e,f,h)=>dyb(d,h,e)});return mw(this.tf,a,c.Ve(d).build())}rj(a,b){if(this.isIdentity(b)||!a.Ve.size&&!b.Ve.size)return a;const c=this.og(),d=new Map(a.Ve);for(const [e,f]of b.Ve)na(fw(a.Ve.get(e),f.O1)),
d.delete(e),c.range(e,f.V1);byb(b,{insert:(e,f)=>dyb(d,f,-e)});return mw(this.tf,a,c.Ve(d).build())}Ze(a){if(a instanceof qCb)return a;const b=this.og();for(const [c,d]of a.Ve)b.range(c,[d.from,d.to]);return b.build()}ni(a,b){const c=a.Ve,d=b.Ve;return a===b||c===d?!0:c.size===d.size&&[...c.keys()].every(e=>fw(c.get(e),d.get(e)))}equals(a){return this===a||a instanceof __c.zCb}constructor(...a){super(...a);this.uT=rCb}};__c.zCb.prototype.WD=ba(117);var ACb=class extends $w{he(a){return{rows:a.rows||this.rows.Bd().build(),cols:a.cols||this.cols.Bd().build(),Jn:a.Jn||this.qk.Bd().build().Fj,Kn:a.Kn||this.qj.Bd().build().Ve,vn:a.vn||this.qk.Bd().build().Fj,wn:a.wn||this.qj.Bd().build().Ve,cells:a.cells||kw(this,this.cells.he({}),this.cols.Bd().build(),this.rows.Bd().build()),attrs:a.attrs||kw(this,this.attrs.he({}),this.cols.Bd().build(),this.rows.Bd().build())}}isIdentity(a){return this.rows.isIdentity(a.rows)&&this.cols.isIdentity(a.cols)&&a.Jn.size===
0&&a.Kn.size===0&&a.vn.size===0&&a.wn.size===0&&a.cells.cells.isEmpty&&this.cells.Hv.isIdentity(a.cells.Hv)&&a.attrs.attrs.items.isEmpty()}lg(a,b){const c=jw(this,a.cols),d=jw(this,a.rows),e=jw(this,b.cols),f=jw(this,b.rows),h=this.rows.lg(a.rows,b.rows),k=this.cols.lg(a.cols,b.cols),l=this.qk.lg(this.qk.he(d,a.Jn),this.qk.he(f,b.Jn)).Fj,m=this.qj.lg(this.qj.he(d,a.Kn),this.qj.he(f,b.Kn)).Ve,r=this.qk.lg(this.qk.he(c,a.vn),this.qk.he(e,b.vn)).Fj,u=this.qj.lg(this.qj.he(c,a.wn),this.qj.he(e,b.wn)).Ve,
w=this.cells.lg(this.cells.he({...a.cells,x:c,y:d}),this.cells.he({...b.cells,x:e,y:f}));a=this.attrs.lg(this.attrs.he({...a.attrs,x:c,y:d}),this.attrs.he({...b.attrs,x:e,y:f}));return{rows:h,cols:k,Jn:l,Kn:m,vn:r,wn:u,cells:kw(this,w,k,h),attrs:kw(this,a,k,h)}}transform(a,b){const c=jw(this,a.cols),d=jw(this,a.rows),e=jw(this,b.cols),f=jw(this,b.rows),h=ov.un(),{Ip:k,gq:l}=rv(h,this.rows.transform(a.rows,b.rows)),{Ip:m,gq:r}=rv(h,this.cols.transform(a.cols,b.cols)),{Ip:{Fj:u},gq:{Fj:w}}=rv(h,this.qk.transform(this.qk.he(d,
a.Jn),this.qk.he(f,b.Jn))),{Ip:{Ve:y},gq:{Ve:z}}=rv(h,this.qj.transform(this.qj.he(d,a.Kn),this.qj.he(f,b.Kn))),{Ip:{Fj:A},gq:{Fj:C}}=rv(h,this.qk.transform(this.qk.he(c,a.vn),this.qk.he(e,b.vn))),{Ip:{Ve:F},gq:{Ve:G}}=rv(h,this.qj.transform(this.qj.he(c,a.wn),this.qj.he(e,b.wn))),{Ip:K,gq:M}=rv(h,this.cells.transform(this.cells.he({...a.cells,x:c,y:d}),this.cells.he({...b.cells,x:e,y:f}))),{Ip:N,gq:Q}=rv(h,this.attrs.transform(this.attrs.he({...a.attrs,x:c,y:d}),this.attrs.he({...b.attrs,x:e,y:f})));
a={rows:k,cols:m,Jn:u,Kn:y,vn:A,wn:F,cells:kw(this,K,m,k),attrs:kw(this,N,m,k)};b={rows:l,cols:r,Jn:w,Kn:z,vn:C,wn:G,cells:kw(this,M,r,l),attrs:kw(this,Q,r,l)};return h.build(a,b)}gj(a){const b=jw(this,a.cols),c=jw(this,a.rows),d=this.rows.gj(a.rows),e=this.cols.gj(a.cols),f=this.qk.gj(this.qk.he(c,a.Jn)).Fj,h=this.qj.gj(this.qj.he(c,a.Kn)).Ve,k=this.qk.gj(this.qk.he(b,a.vn)).Fj,l=this.qj.gj(this.qj.he(b,a.wn)).Ve,m=this.cells.gj({...a.cells,x:b,y:c});a=this.attrs.gj(this.attrs.he({...a.attrs,x:b,
y:c}));return{rows:d,cols:e,Jn:f,Kn:h,vn:k,wn:l,cells:kw(this,m,e,d),attrs:kw(this,a,e,d)}}Bi(a,b){return this.rows.Bi(a.rows,b.rows)&&this.cols.Bi(a.cols,b.cols)&&this.qk.Bi(this.qk.he(this.axis.identity(),a.Jn),this.qk.he(this.axis.identity(),b.Jn))&&this.qj.Bi(this.qj.he(this.axis.identity(),a.Kn),this.qj.he(this.axis.identity(),b.Kn))&&this.qk.Bi(this.qk.he(this.axis.identity(),a.vn),this.qk.he(this.axis.identity(),b.vn))&&this.qj.Bi(this.qj.he(this.axis.identity(),a.wn),this.qj.he(this.axis.identity(),
b.wn))&&this.cells.Bi(this.cells.he(a.cells),this.cells.he(b.cells))&&this.attrs.Bi(this.attrs.he(a.attrs),this.attrs.he(b.attrs))}identity(a){return{rows:this.rows.identity(a.rows),cols:this.cols.identity(a.cols),Jn:this.qk.identity(a.Jn).Fj,Kn:this.qj.identity(a.Kn).Ve,vn:this.qk.identity(a.vn).Fj,wn:this.qj.identity(a.wn).Ve,cells:this.cells.identity(a.cells),attrs:this.attrs.identity(a.attrs)}}apply(a,b){if(this.isIdentity(b))return a;const c=jw(this,b.cols),d=jw(this,b.rows),e=this.rows.apply(a.rows,
b.rows),f=this.cols.apply(a.cols,b.cols),h=this.qk.apply(a.Jn,this.qk.he(d,b.Jn)),k=this.qj.apply(a.Kn,this.qj.he(d,b.Kn)),l=this.qk.apply(a.vn,this.qk.he(c,b.vn)),m=this.qj.apply(a.wn,this.qj.he(c,b.wn)),r=this.cells.apply(a.cells,{...b.cells,x:c,y:d});b=this.attrs.apply(a.attrs,this.attrs.he({...b.attrs,x:c,y:d}));return mw(this.tf,a,Object.freeze({rows:e,cols:f,Jn:h,Kn:k,vn:l,wn:m,cells:r,attrs:b}))}rj(a,b){if(this.isIdentity(b))return a;const c=jw(this,b.cols),d=jw(this,b.rows),e=this.rows.rj(a.rows,
b.rows),f=this.cols.rj(a.cols,b.cols),h=this.qk.rj(a.Jn,this.qk.he(d,b.Jn)),k=this.qj.rj(a.Kn,this.qj.he(d,b.Kn)),l=this.qk.rj(a.vn,this.qk.he(c,b.vn)),m=this.qj.rj(a.wn,this.qj.he(c,b.wn)),r=this.cells.rj(a.cells,{...b.cells,x:c,y:d});b=this.attrs.rj(a.attrs,this.attrs.he({...b.attrs,x:c,y:d}));return mw(this.tf,a,Object.freeze({rows:e,cols:f,Jn:h,Kn:k,vn:l,wn:m,cells:r,attrs:b}))}Ze(a){return Object.freeze({rows:this.rows.Ze(a.rows),cols:this.cols.Ze(a.cols),Jn:this.qk.Ze(a.Jn),Kn:this.qj.Ze(a.Kn),
vn:this.qk.Ze(a.vn),wn:this.qj.Ze(a.wn),cells:this.cells.Ze(a.cells),attrs:this.attrs.Ze(a.attrs)})}ni(a,b){return a===b?!0:this.rows.ni(a.rows,b.rows)&&this.qk.ni(a.Jn,b.Jn)&&this.qj.ni(a.Kn,b.Kn)&&this.qk.ni(a.vn,b.vn)&&this.qj.ni(a.wn,b.wn)&&this.cols.ni(a.cols,b.cols)&&this.cells.ni(a.cells,b.cells)&&this.attrs.ni(a.attrs,b.attrs)}equals(a){return this===a?!0:a instanceof ACb?this.rows.equals(a.rows)&&this.cols.equals(a.cols)&&this.cells.equals(a.cells)&&this.attrs.equals(a.attrs):!1}constructor(a,
b,c,d,e,f,h,k){super(a);this.rows=b;this.cols=c;this.cells=d;this.attrs=e;this.axis=f;this.qj=h;this.qk=k}};var BCb=class extends $w{isIdentity(a){return this.base.isIdentity(a)}lg(a,b){const c=fyb(a.key,b.key);return{key:c,value:this.components[c].lg(a.value,b.value)}}transform(a,b){const c=fyb(a.key,b.key);a=this.components[c].transform(a.value,b.value);return twb(a,d=>({key:c,value:d}))}gj(a){return{key:a.key,value:this.components[a.key].gj(a.value)}}Bi(a,b){return a.key===b.key&&this.components[a.key].Bi(a.value,b.value)}identity(a){return{key:a.key,value:this.components[a.key].identity(a.value)}}apply(a,
b){const c=fyb(a.key,b.key);return mw(this.tf,a,Object.freeze({key:c,value:this.components[c].apply(a.value,b.value)}))}rj(a,b){const c=fyb(a.key,b.key);return mw(this.tf,a,Object.freeze({key:c,value:this.components[c].rj(a.value,b.value)}))}Ze(a){return Object.freeze({key:a.key,value:this.components[a.key].Ze(a.value)})}ni(a,b){return a===b?!0:a.key===b.key&&this.components[a.key].ni(a.value,b.value)}equals(a){if(this===a)return!0;const b=this.components,c=a.components;a=Object.keys(b);const d=Object.keys(c);
return a.length===d.length&&a.every(e=>e in c&&b[e].equals(c[e]))}constructor(a,b,c){super(a);this.components=b;this.base=c}};var CCb=class extends $w{isIdentity(a){return this.sum.isIdentity(a)}lg(a,b){return this.sum.lg(a,b)}transform(a,b){return this.sum.transform(a,b)}gj(a){return this.sum.gj(a)}Bi(a,b){return this.sum.Bi(a,b)}identity(a){return this.sum.identity(lw(this,a))}apply(a,b){var c=this.tf;b=this.sum.apply(lw(this,a),b).value;return mw(c,a,b)}rj(a,b){var c=this.tf;b=this.sum.rj(lw(this,a),b).value;return mw(c,a,b)}Ze(a){return this.sum.Ze(lw(this,a)).value}ni(a,b){return a===b||this.sum.ni(lw(this,a),lw(this,
b))}equals(a){return this===a||a instanceof CCb&&this.sum.equals(a.sum)}constructor(a,b,c){super(a);this.sum=b;this.Sga=c}};var DCb=class extends $w{isIdentity(){return!0}lg(){return 1}transform(){return pv(1,1)}gj(){return 1}Bi(){return!0}identity(){return 1}apply(){return 1}rj(){return 1}Ze(){return 1}ni(){return!0}equals(a){return this===a||a instanceof DCb}constructor(...a){super(...a);this.unit=1}};var ECb=class extends Zw{isIdentity(){return!0}};var FCb=class extends $w{isIdentity(a){return this.base.isIdentity(a)}lg(){}transform(){return pv()}gj(){}Bi(){return!0}identity(){}apply(a){return a}rj(a){return a}Ze(a){return this.copy(a)}ni(a,b){return this.As(a,b)}equals(a){return this===a}constructor(a,b,c){super(a);this.As=b;this.copy=c;this.base=new ECb}};var GCb=class extends Zw{isIdentity(a){return this.components[a.key].isIdentity(a.value)}constructor(a){super();this.components=a}};var HCb=class{isIdentity(a){const b=typeof a;switch(b){case "bigint":case "function":case "symbol":throw Error(`unexpected type ${b}`);case "boolean":case "number":case "string":case "undefined":return!0;case "object":return a==null;default:throw new n(b);}}get(a){if(this.isIdentity(a))return a;let b=this.zUa.get(a);b==null&&(b=Symbol(),this.zUa.set(a,b));return b}constructor(){this.zUa=new WeakMap}};var ICb=new HCb;var mx=class{get(){this.reportObserved();return this.value}reportObserved(){this.rz||!Cyb()?this.rz?.reportObserved():(this.rz=Dyb(""),this.rz.reportObserved(),this.vf?.fj(),Bw(this.rz,()=>{this.rz=void 0;this.vf?.fj()}))}set(a){zw.identity(this.value,a)||(this.value=a,this.rz?.reportChanged())}get $F(){return this.rz!=null&&nw(this.rz)}constructor(a,b){this.value=a;this.vf=b;this.rz=void 0}};var JCb=class{static C(a){qb(a,{bVb:Ww,Exb:Ww})}get Tn(){return this.cols.length}get tw(){return this.rows.length}get $F(){return Xw(()=>{if(nw(this.rows)||nw(this.cols))return!0;for(const a of this.values.values())if(a.$F)return!0;return!1})}get bVb(){const a=new Map;this.rows.forEach((b,c)=>a.set(b,c));return a}get Exb(){const a=new Map;this.cols.forEach((b,c)=>a.set(b,c));return a}get(a,b){a=this.rows[a];b=this.cols[b];if(a!=null&&b!=null){var c=this.values.get(this.Tea(a,b));c==null&&Cyb()&&(c=
new mx(void 0,this.vf?this:void 0),this.values.set(this.Tea(a,b),c));return c?.get()}}set(a,b,c){a=ow(this,a);b=pw(this,b);const d=this.values.get(this.Tea(a,b));d?d.set(c):this.values.set(this.Tea(a,b),new mx(c,this.vf?this:void 0))}delete(a,b){a=this.rows[a];b=this.cols[b];a!=null&&b!=null&&(this.values.get(this.Tea(a,b))?.set(void 0),this.values.delete(this.Tea(a,b)))}forEach(a){for(const c of this.rows)for(const d of this.cols){var b=this.values.get(this.Tea(c,d));b!=null&&(b=b.get(),b!=null&&
a(b,c,d))}}Tea(a,b){return`${a}:${b}`}constructor(a){this.vf=a;this.kHd=(JCb.C(this),0);this.hHd=0;this.rows=Yw.array([],{deep:!1});this.cols=Yw.array([],{deep:!1});this.values=new Map;this.fj=()=>{this.vf?.fj()};this.vf&&(zAb(this.rows,this.fj),Bw(this.rows,this.fj),zAb(this.cols,this.fj),Bw(this.cols,this.fj))}};var rw=Object.freeze({serialize:a=>a,deserialize:a=>a}),Dw=Object.freeze({serialize(){throw Error("serialization not implemented");},deserialize(){throw Error("serialization not implemented");}}),lyb=class{serialize(a){return this.b.serialize(this.a.serialize(a))}deserialize(a){return this.a.deserialize(this.b.deserialize(a))}constructor(a,b){this.a=a;this.b=b}},KCb=class{get serializer(){this.D5b==null&&(this.D5b=this.Osd());return this.D5b}serialize(a){return this.serializer.serialize(a)}deserialize(a){return this.serializer.deserialize(a)}constructor(a){this.Osd=
a}},myb=class{serialize(){return this.to}deserialize(){return this.from}constructor(a,b){this.from=a;this.to=b}},mzb=class{serialize(a){return this.CWd[a]}deserialize(a){return this.Zfd.get(a)}constructor(a,b){this.CWd=a;this.Zfd=b}},uzb=class{serialize(a){return a.map(b=>this.serializer.serialize(b))}deserialize(a){return a.map(b=>this.serializer.deserialize(b))}constructor(a){this.serializer=a}},szb=Object.freeze({serialize(a){let b=0,c=0;const d=__c.jyb(a),e=[];a.forEach((f,h)=>{if(f=h-c)b&&(e.push(b),
b=0),e.push(-f);b++;c=h+1});return[d,e]},deserialize([a,b]){const c=[];let d=0;for(const e of b)e<0?d+=-e:e>0&&(a.slice(0,e).forEach(f=>c[d++]=f),a=a.slice(e));a.length&&a.forEach(e=>c[d++]=e);return c}}),izb=class{serialize(a){return rwb(a,(b,c)=>[this.Hpc.serialize(b),this.eMc.serialize(c)])}deserialize(a){return rwb(a,(b,c)=>[this.Hpc.deserialize(b),this.eMc.deserialize(c)])}constructor(a,b){this.Hpc=a;this.eMc=b}},tzb=class{serialize([a,b]){return[this.QDc.serialize(a),this.RDc.serialize(b)]}deserialize([a,
b]){return[this.QDc.deserialize(a),this.RDc.deserialize(b)]}constructor(a){this.QDc=a;this.RDc=rw}},nyb=class{serialize(a){return qw(this.sic,(b,c)=>b.serialize(a[c]))}deserialize(a){return qw(this.sic,(b,c)=>b.deserialize(a[c]))}constructor(a){this.sic=a}},oyb=class{serialize(a){return this.SI[this.zhd(a)].serialize(a)}deserialize(a){return this.SI[this.yhd(a)].deserialize(a)}constructor(a,b,c){this.SI=a;this.zhd=b;this.yhd=c}},pyb=class{serialize(a){return a!=null?this.serializer.serialize(a):this.defaultValue}deserialize(a){return a!==
this.defaultValue?this.serializer.deserialize(a):void 0}constructor(a,b){this.serializer=a;this.defaultValue=b}},qyb=class{serialize(a){return this.construct(a)}deserialize(a){return a}constructor(a){this.construct=a}},uyb=Object.freeze({serialize:a=>a,deserialize:a=>new Syb(a.delta)}),syb=Object.freeze({serialize:a=>a,deserialize:a=>new fBb(a.oldState,a.newState)}),jzb=Object.freeze({serialize:a=>({Jb:a}),deserialize:a=>a.Jb}),qzb=class{serialize(a){return a.Jb.map(b=>{switch(b.type){case 0:return this.GBc.serialize(b);
case 1:return this.Fhc.serialize(b);case 2:return this.HBc.serialize(b);case 3:return this.pnc.serialize({state:b.state!=null?this.Oi.serialize(b.state):void 0,shift:b.shift&&this.k1a.serialize(b.shift)});case 4:const c=b.shift&&this.k1a.serialize(b.shift);b=b.delta;if(b==null)return this.V0b.serialize({delta:void 0,shift:c});switch(b.type){case 0:return this.V0b.serialize({delta:b.delta!=null?this.bE.serialize(b.delta):void 0,shift:c});case 1:return this.q$b.serialize({oldState:b.oldState!=null?
this.Oi.serialize(b.oldState):void 0,newState:b.newState!=null?this.Oi.serialize(b.newState):void 0,shift:c});default:throw new n(b);}default:throw new n(b);}})}deserialize(a){const b=this.domain.Bd();for(const c of a)switch(c.type){case "RETAIN":a=this.GBc.deserialize(c);b.Ob(a.length);break;case "EXPAND":a=this.Fhc.deserialize(c);b.expand(a.length);break;case "RETOMB":a=this.HBc.deserialize(c);b.eV(a.length);break;case "INSERT":a=this.pnc.deserialize(c);b.insert(a.state!=null?this.Oi.deserialize(a.state):
void 0,a.shift&&this.k1a.deserialize(a.shift));break;case "UPDATE":a=this.V0b.deserialize(c);b.update(a.delta!=null?this.bE.deserialize(a.delta):void 0,a.shift&&this.k1a.deserialize(a.shift));break;case "CHANGE":a=this.q$b.deserialize(c);b.jp(a.oldState!=null?this.Oi.deserialize(a.oldState):void 0,a.newState!=null?this.Oi.deserialize(a.newState):void 0,a.shift&&this.k1a.deserialize(a.shift));break;default:throw new n(c);}return b.build()}constructor(a,b,c,d,e,f,h,k,l){var m=T(__c.nx);this.domain=
a;this.bE=b;this.Oi=c;this.k1a=m;this.GBc=d;this.Fhc=e;this.HBc=f;this.pnc=h;this.V0b=k;this.q$b=l}},LCb=class{serialize(a){return a.value}deserialize(a){return{key:this.key,value:a}}constructor(a){this.key=a}};var NCb=class{fj(){this.vf?.fj()}get yj(){return this.Cg.yj||this.Gca!=null&&nw(this.Gca)}get mutable(){this.Cg instanceof MCb&&(this.Gca=this.Cg.QGc,this.Cg=this.Lyb(this.context,this.context.metrics?.CBd,this.mx?this:void 0,Gyb,this.vf?this:void 0,Xw(()=>this.Cg.snapshot())));return this.Cg.mutable}snapshot(){return this.Cg.snapshot()}ji(a){yyb(this);this.Cg.ji(a)}destroy(a){this.Cg.destroy(a);this.mx=void 0;this.context.metrics?.hLb.D$b(this)}H7(a){yyb(this);g(this.mx).H7(this.xJb(a))}onError(a){g(this.mx).onError(a)}constructor(a,
b,c,d,e,f,h){this.context=a;this.Lyb=c;this.mx=e;this.xJb=f;this.vf=h;this.Gca=void 0;this.Cg=new MCb(b,d,this.vf?this:void 0);a.metrics?.hLb.qbc(this)}},OCb=class{fj(){if(this.zU!=null){var a=this.yj;!a||this.zU instanceof Aw?!a&&this.zU instanceof Aw&&(a=this.zU.deref(),a!=null&&(this.zU=zyb(a))):(a=this.zU.deref(),a!=null&&(this.zU=new Aw(a)))}this.vf?.fj()}get yj(){return this.d9.yj||this.Gca!=null&&nw(this.Gca)||!!this.zU?.deref()?.yj}get mutable(){var a=this.zU?.deref();if(a!=null)return a.mutable;
this.Gca=this.d9.QGc;a=this.dJ(this.context,this.context.metrics?.CBd,this,Gyb,this,Xw(()=>this.d9.snapshot()));this.zU=a.yj?new Aw(a):zyb(a);return a.mutable}snapshot(){var a=this.zU?.deref();return a!=null?(a=a.snapshot(),this.d9.setState(a),a):this.d9.snapshot()}ji(a){yyb(this);const b=this.zU?.deref();b!=null?(Ayb(this.d9,a),b.ji(a)):this.d9.ji(a)}destroy(a){this.zU?.deref()?.destroy(a);this.d9.destroy(a);this.mx=void 0;this.context.metrics?.hLb.D$b(this)}H7(a){yyb(this);Ayb(this.d9,a);g(this.mx).H7(this.xJb(a))}onError(a){g(this.mx).onError(a)}constructor(a,
b,c,d,e,f,h){this.context=a;this.dJ=c;this.mx=e;this.xJb=f;this.vf=h;this.Gca=this.zU=void 0;this.d9=new MCb(b,d,this.vf);this.d9[Eyb]=this;a.metrics?.hLb.qbc(this)}},MCb=class{get yj(){return this.rz!=null&&nw(this.rz)}get state(){Byb(this);return this.Umb}setState(a){this.Umb=a;this.fqa=void 0}snapshot(){Fyb(this);return this.state}get QGc(){return this.rz}ji(a){Ayb(this,a);Byb(this)}destroy(a){nv(this.domain,this.state,a)}constructor(a,b,c){this.domain=a;this.vf=c;this.fqa=this.rz=void 0;this.Umb=
b}},Aw=class{deref(){return this.value}constructor(a){this.value=a}},Eyb=Symbol("parentRef");var PCb=Symbol();var QCb=class{get mutable(){return this.Wm}yf(a,b,c,d,e){return a.aJ(this.context,b,this,c,d,e)}H7(a){const b=Hyb(this);Cw(this);Iyb(this,a);b.H7(this.MJc(a))}onError(a){this.mx&&(this.Wm.onError?.(a),this.mx.onError(a),this.mx=void 0,Jyb(this,"mutable failure"))}ji(a){this.mx&&(this.apply(a),Iyb(this,a))}apply(a){Hyb(this);try{this.Wm.ji(a)}catch(b){throw this.onError(b),b;}}tu(a){this.apply(a);if(!this.domain.isIdentity(a)){const b=Hyb(this);Iyb(this,a);b.H7(this.MJc(a))}}fj(){if(this.vf!=null){var a=
Kyb(this);this.PVa!==a&&(this.PVa=a,this.vf.fj())}}get yj(){this.PVa==null&&(this.PVa=Kyb(this));return this.PVa}snapshot(){if(this.A4==null&&Cyb()){const a=Dyb("");this.A4=a;Bw(this.A4,()=>{oa(this.A4===a);this.A4=void 0;this.fj()})}this.A4&&(this.A4.reportObserved(),this.fj());this.Eya==null&&(this.Eya=Xw(()=>this.Wm.ZM()),mw(this.tf,this,this.Eya));return this.Eya}destroy(a){this.metric?.D$b(this);this.Wm.destroy(a);this.mx&&(this.mx=void 0,Jyb(this,"mutable disconnected"))}constructor(a,b,c,d,
e,f,h,k,l){this.tf=a;this.context=b;this.metric=c;this.mx=d;this.MJc=e;this.domain=f;this.vf=h;this.clients=void 0;this.Wm=k(this,this.vf?this:void 0,l);this.mx=d;this.Eya=l;mw(this.tf,this.Eya,this);this.metric?.qbc(this);this.vf&&(this.PVa=Kyb(this))}};var RCb={H7:()=>{},onError:()=>{}},SCb=class{H7(a){this.closed||this.o.H7(this.f(a))}onError(a){this.closed||(this.closed=!0,this.o.onError(a))}constructor(a,b){this.o=a;this.f=b;this.closed=!1}};var TCb;TCb=class{Lyb(a,b,c,d){return this.aJ(a,b,c,e=>e,void 0,d)}Fyb(a,b,c){const d=this.Lyb({[PCb]:PCb,metrics:{}.metrics},a,c??RCb);b?.subscribe({next:e=>d.ji(e),complete:()=>d.destroy(d.snapshot())});return d.mutable}create(a){return this.Fyb(a,void 0,RCb)}Ze(a){return this.domain.Ze(a)}};
ox=__c.ox=class extends TCb{Gpb(a){return this.Po(a,this.Oi)}map(a,b,c,d,e,f){c=Lyb(c);d=Lyb(d);return new UCb(this,a,b,c,d,e,f,sw({serialize:b,deserialize:a},this.bE),sw({serialize:d,deserialize:c},this.Oi))}constructor(a,b){super();this.bE=a;this.Oi=b}};ox.prototype.vs=ba(124);
var px=class extends ox{aJ(a,b,c,d,e,f){f=f?.pmc||"eager";switch(f){case "eager":return this.createContext(a,a.metrics?.LMe,c,d,e,b);case "lazy":return new NCb(a,this.domain,this.createContext,b,c,d,e);case "transient":return new OCb(a,this.domain,this.createContext,b,c,d,e);default:throw new n(f);}}snapshot(a){return a.snapshot()}constructor(a,b,c){super(b,c);this.tf=a;this.createContext=(d,e,f,h,k,l)=>new QCb(this.tf,d,e,f,h,this.domain,k,this.dJ,l)}},UCb=class extends ox{aJ(a,b,c,d,e,f){c=new SCb(c,
d);a=this.component.aJ(a,this.DV(b),c,this.hR,e,f);return new VCb(a,this.IM,this.bY,this.DV,this.qfb)}snapshot(a){return this.bY(this.component.snapshot(this.qKc(a)))}Po(a,b){return new UCb(this.component,this.hR,this.IM,this.bY,this.DV,this.qfb,this.qKc,a,b)}constructor(a,b,c,d,e,f,h,k,l){super(k,l);this.component=a;this.hR=b;this.IM=c;this.bY=d;this.DV=e;this.qfb=f;this.qKc=h;this.domain=this.component.domain.map(this.hR,this.IM,this.bY,this.DV)}},VCb=class{get yj(){return this.aOa.yj}get mutable(){return this.qfb(this.aOa.mutable)}destroy(a){this.aOa.destroy(this.DV(a))}ji(a){this.aOa.ji(this.IM(a))}snapshot(){return this.bY(this.aOa.snapshot())}constructor(a,
b,c,d,e){this.aOa=a;this.IM=b;this.bY=c;this.DV=d;this.qfb=Lyb(e)}};var WCb=class{fj(){this.vf?.fj()}get yj(){return this.grid.$F}snapshot(){return this.ve.snapshot()}ZM(){const a=this.domain.og();for(let b=0;b<=this.tw;b++){const c=a.$s();let d={};for(let e=0;e<=this.Tn;e++){const f=this.grid.get(b,e);for(const h of Pyb(d,f))c.tc(h,f?.[h]);d=f;c.iy(1)}c.finish();a.rows(1)}return a.build()}destroy(a){const b=this.ve.snapshot();nv(this.domain,b,a)}ji(a){this.Kub(a.x);this.Lub(a.y);Nyb(this,a.attrs);Cw(this.ve)}Kub(a){if(a.pre!==0||a.post!==0){var b=0;a=a.Fc();for(var c=
a.head;c;)c.type===0?b+=a.xu(c.length):(c=tv(a,c.length),hyb(this.grid,b,c),b+=c),c=a.head}}Lub(a){let b=0;a=a.Fc();for(var c=a.head;c;)c.type===0?b+=a.xu(c.length):(c=tv(a,c.length),iyb(this.grid,b,c),b+=c),c=a.head}get Tn(){return this.grid.Tn}get tw(){return this.grid.tw}get(a,b,c){b=this.grid.get(b,c);if(b!=null&&(a=this.Pk.cyc(a,b),Object.keys(a).length!==0))return a}set(a,b,c){const {E_d:d,y_d:e,Ymd:f=d,Xmd:h=e}=b;b=new Set;const k=wv(this.domain);k.rows(d);for(let r=d;r<=f;r++){const u=k.$s();
u.iy(e);for(let w=e;w<=h;w++){var l=this.grid.get(r,w);l=Oyb(this,a,l,c);for(const y of b)u.tc(y,void 0);u.attrs(l);for(const y of Object.keys(l))b.add(y);u.iy(1)}for(const w of b)u.tc(w,void 0);u.finish();k.rows(1)}a=k.$s();a.iy(e);for(c=e;c<=h;c++){for(var m of b)a.tc(m,void 0);a.iy(1)}for(const r of b)a.tc(r,void 0);a.finish();m=this.domain.he({attrs:k.build()});this.ve.tu(m)}write(a,b,c){c==null||Object.keys(c).length===0?this.grid.delete(a,b):this.grid.set(a,b,c)}constructor(a,b,c,d,e){this.Pk=
a;this.domain=b;this.ve=c;this.vf=d;this.grid=new JCb(this.vf?this:void 0);Gwb(e,a.HH,(f,h,k)=>{Xw(()=>this.grid.set(h,k,f))});nv(this.domain,e,Xw(()=>this.ZM()))}},Qyb=class extends px{og(){return this.domain.og()}Ze(a){return this.domain.Ze(a,b=>this.Pk.HH(b))}Po(a,b){return new Qyb(this.tf,this.domain,this.Pk,a,b)}constructor(a,b,c,d,e){super(a,d,e);this.domain=b;this.Pk=c;this.dJ=(f,h,k)=>new WCb(this.Pk,this.domain,f,h,k)}};var XCb=class{fj(){this.vf?.fj()}get yj(){return this._value.$F}ji(a){if(a!=null){switch(a.type){case 1:na(this.H1b.As(this._value.get(),a.oldState));this._value.set(a.newState);break;case 0:na(a.delta==null);break;default:throw new n(a);}Cw(this.ve)}}snapshot(){return this.value}ZM(){return this.value}destroy(a){nv(this.domain,this.value,a)}get value(){return this._value.get()}set value(a){this.H1b.lpa(a);const b=this._value.get();this.ve.tu(this.domain.replace(b,this.H1b.Ze(a)))}constructor(a,b,
c,d,e){this.H1b=a;this.domain=b;this.ve=c;this.vf=d;this._value=new mx(e,this.vf?this:void 0)}},Uyb=class extends px{Po(a,b){return new Uyb(this.tf,this.domain,this.type,a,b)}constructor(a,b,c,d,e){super(a,d,e);this.domain=b;this.type=c;this.dJ=(f,h,k)=>new XCb(this.type,this.domain,f,h,k)}},YCb=class extends XCb{get value(){return super.value}set value(a){throw Error("Attribute is unmodifiable");}},Wyb=class extends Uyb{Po(a,b){return new Wyb(this.tf,this.domain,this.type,a,b)}constructor(...a){super(...a);
this.dJ=(b,c,d)=>new YCb(this.type,this.domain,b,c,d)}},ZCb=class{fj(){this.vf?.fj()}get yj(){return Xw(()=>this.Cg.$F||this.Cg.get().yj)}yf(a){this.Cg.set(this.ve.yf(this.type,a,Tyb,this.vf?this:void 0))}ji(a){if(a!=null){switch(a.type){case 0:this.Cg.get().ji(a.delta);break;case 1:var b=a.oldState;this.Cg.get().destroy(b);this.yf(a.newState);break;default:throw Error();}Cw(this.ve)}}snapshot(){return this.ve.snapshot()}ZM(){return this.Cg.get().snapshot()}destroy(a){this.Cg.get().destroy(a)}get ref(){return this.Cg.get().mutable}set(a){this.ve.tu(new fBb(this.Cg.get().snapshot(),
this.type.Ze(a)))}constructor(a,b,c,d){this.type=a;this.ve=b;this.vf=c;this.Cg=new mx(this.ve.yf(this.type,d,Tyb,this.vf?this:void 0),this.vf?this:void 0)}},Vyb=class extends px{Po(a,b){return new Vyb(this.tf,this.domain,this.type,a,b)}constructor(a,b,c,d,e){super(a,d,e);this.domain=b;this.type=c;this.dJ=(f,h,k)=>new ZCb(this.type,f,h,k)}};var $Cb=class{fj(){this.vf?.fj()}get yj(){return Xw(()=>{if(this.grid.$F)return!0;let a=!1;this.grid.forEach(b=>a||(a=b.Cg.yj||b.Dia.$F));return a})}tQa(a,b,c){oa(a.span.left===c.left);oa(a.span.top===c.top);oa(a.span.right===c.right);oa(a.span.bottom===c.bottom);for(let d=c.top;d<=c.bottom;d++)for(let e=c.left;e<=c.right;e++)oa(this.grid.get(d,e)===a),this.grid.delete(d,e);a.Cg.destroy(b)}ji(a){this.Kub(a.x);this.Lub(a.y);a.cells.forEach((b,c,d)=>{switch(d.type){case 1:var e=g(this.grid.get(c,b));
d.delta&&e.Cg.ji(d.delta);if(d.bounds){oa(e.span.left===b&&e.span.top===c);const k=d.bounds.o;var f=d.bounds.n;oa(e.span.right===k.right&&e.span.bottom===k.bottom);if(k.right!==f.right||k.bottom!==f.bottom){d=Math.min(k.right,f.right);f=Math.min(k.bottom,f.bottom);for(var h=f+1;h<=k.bottom;h++)for(let l=b;l<=k.right;l++)oa(this.grid.get(h,l)===e),this.grid.delete(h,l);for(b=d+1;b<=k.right;b++)for(h=c;h<=f;h++)oa(this.grid.get(h,b)===e),this.grid.delete(h,b);e.Dia.right=pw(this.grid,d);e.Dia.bottom=
ow(this.grid,f)}}break;case 0:d.o&&(e=g(this.grid.get(c,b)),this.tQa(e,d.o.state,{left:b,top:c,right:d.o.right,bottom:d.o.bottom}));break;default:throw new n(d);}});a.cells.forEach((b,c,d)=>{switch(d.type){case 1:if(d.bounds){const h=g(this.grid.get(c,b));var e=d.bounds.o;d=d.bounds.n;var f=Math.min(e.right,d.right);e=Math.min(e.bottom,d.bottom);for(let k=e+1;k<=d.bottom;k++)for(let l=b;l<=d.right;l++)oa(this.grid.get(k,l)==null),this.grid.set(k,l,h);for(b=f+1;b<=d.right;b++)for(f=c;f<=e;f++)oa(this.grid.get(f,
b)==null),this.grid.set(f,b,h);h.Dia.right=pw(this.grid,d.right);h.Dia.bottom=ow(this.grid,d.bottom)}break;case 0:d.n&&azb(this,d.n.state,{left:b,top:c,right:d.n.right,bottom:d.n.bottom});break;default:throw new n(d);}});Cw(this.ve)}Kub(a){if(a.pre!==0||a.post!==0){var b=0;a=a.Fc();for(var c=a.head;c;)c.type===0?b+=a.xu(c.length):(c=tv(a,c.length),hyb(this.grid,b,c,d=>d.span.right!==b-1),b+=c),c=a.head}}Lub(a){let b=0;a=a.Fc();for(var c=a.head;c;)c.type===0?b+=a.xu(c.length):(c=tv(a,c.length),iyb(this.grid,
b,c,d=>d.span.bottom!==b-1),b+=c),c=a.head}snapshot(){return this.ve.snapshot()}ZM(){const a=this.domain.og();for(let b=0;b<this.grid.tw;b++)for(let c=0;c<this.grid.Tn;c++){const d=this.grid.get(b,c);d!=null&&d.span.top===b&&d.span.left===c&&a.add(d.span,d.Cg.snapshot())}return a.build()}destroy(a){let b=0,c=0;a.forEach(()=>c++);for(let d=0;d<this.grid.tw;d++)for(let e=0;e<this.grid.Tn;e++){const f=this.grid.get(d,e);if(f==null||f.span.top!==d||f.span.left!==e)continue;const h=g(a.get(f.span.left,
f.span.top));oa(h.span.right===f.span.right&&h.span.bottom===f.span.bottom);f.Cg.destroy(h.state);b++}oa(c===b)}get(a,b){a=this.grid.get(a,b);if(a!=null)return{span:a.span,ref:a.Cg.mutable}}forEach(a){this.grid.forEach((b,c,d)=>{b.Dia.left===d&&b.Dia.top===c&&a(b.Cg.mutable,b.span)})}set(a,b){b=(new Hv).add(a.left,a.top,this.domain.replace(void 0,{right:a.right,bottom:a.bottom,state:this.type.Ze(b)})).build();this.ve.tu(this.domain.lg(bzb(this,a),this.domain.he({cells:b})));return g(this.get(a.top,
a.left))}delete(a){this.ve.tu(bzb(this,a))}constructor(a,b,c,d,e){this.type=a;this.domain=b;this.ve=c;this.vf=d;this.grid=new JCb(this.vf?this:void 0);e.forEach((f,h)=>{Xw(()=>azb(this,f,h))})}},$yb=class{get span(){return this.Dia.Kwc.get()}constructor(a,b){this.Cg=a;this.Dia=b}},Zyb=class{get $F(){return this.ctb.$F||this.Ssb.$F}get right(){return this.ctb.get()}set right(a){this.ctb.set(a)}get bottom(){return this.Ssb.get()}set bottom(a){this.Ssb.set(a)}constructor(a,b,c){this.Vcb=a;this.Kwc=Ww(()=>
({left:g(this.Vcb.Exb.get(this.left)),top:g(this.Vcb.bVb.get(this.top)),right:g(this.Vcb.Exb.get(this.right)),bottom:g(this.Vcb.bVb.get(this.bottom))}),{equals:zw.structural});this.left=b.left;this.top=b.top;this.ctb=new mx(b.right,c);this.Ssb=new mx(b.bottom,c)}},czb=class extends px{Po(a,b){return new czb(this.tf,this.domain,this.type,a,b)}constructor(a,b,c,d,e){super(a,d,e);this.domain=b;this.type=c;this.dJ=(f,h,k)=>new $Cb(this.type,this.domain,f,h,k)}};var aDb=class{fj(){this.vf?.fj()}get yj(){return this._value.$F}ji(a){this._value.set(this.domain.apply(this._value.get(),a));Cw(this.ve)}snapshot(){return this.ve.snapshot()}ZM(){return this.value}destroy(a){nv(this.domain,this.value,a)}get value(){return this._value.get()}increment(a){this.ve.tu(this.domain.increment(a))}constructor(a,b,c,d){this.domain=a;this.ve=b;this.vf=c;this._value=new mx(d,this.vf?this:void 0)}},bDb=class extends px{constructor(...a){super(...a);this.dJ=(b,c,d)=>new aDb(this.domain,
b,c,d)}},ezb=class extends bDb{Po(a,b){return new ezb(this.tf,this.domain,a,b)}constructor(a,b,c,d){super(a,c,d);this.domain=b}},fzb=class extends bDb{Po(a,b){return new fzb(this.tf,this.domain,a,b)}constructor(a,b,c,d){super(a,c,d);this.domain=b}};var cDb;cDb=Symbol.iterator;
var dDb=class{get cB(){return this.Ecc.get()}fj(){this.vf?.fj()}get yj(){return Xw(()=>{if(this.Ecc.$F)return!0;for(const a of this.cB.values())if(a.yj)return!0;return!1})}snapshot(){return this.ve.snapshot()}ZM(){return di(this.cB,a=>a.snapshot())}destroy(a){na(this.cB.size===a.size);this.forEach((b,c)=>{b=g(a.get(c));g(this.cB.get(c)).destroy(b)})}ji(a){a.forEach((b,c)=>{if(b!=null)switch(b.type){case 0:b.delta!=null&&g(this.cB.get(c)).ji(b.delta);break;case 1:if(b.oldState!=null){var d=b.oldState;
g(this.cB.get(c)).destroy(d);this.cB.delete(c)}else na(!this.cB.has(c));b.newState!=null&&this.cB.set(c,hzb(this,c,b.newState));break;default:throw new n(b);}});Cw(this.ve)}get size(){return this.cB.size}set(a,b){this.keyType.lpa(a);var c=this.cB.get(a);c=c!=null?this.domain.replace(a,c.snapshot(),this.valueType.Ze(b)):this.domain.create(a,this.valueType.Ze(b));this.ve.tu(c);c=this.cB.get(a);if(c==null)throw Error(`Unable to set key "${a}" to value "${b}"`);return c.mutable}get(a){return this.cB.get(a)?.mutable}has(a){return this.cB.has(a)}delete(a){const b=
this.cB.get(a);b!=null&&(a=this.domain.delete(a,b.snapshot()),this.ve.tu(a))}forEach(a){this.cB.forEach((b,c)=>a(b.mutable,c))}map(a){return[...this.cB].map(([b,c])=>a(c.mutable,b))}every(a){return[...this.cB.entries()].every(([b,c])=>a(c.mutable,b))}*entries(){for(const [a,b]of this.cB)yield[a,b.mutable]}keys(){return this.cB.keys()}*values(){for(const a of this.cB.values())yield a.mutable}NKa(){return di(this.cB,a=>a.mutable)}[cDb](){return this.NKa()[Symbol.iterator]()}constructor(a,b,c,d,e,f){this.keyType=
a;this.valueType=b;this.domain=c;this.ve=d;this.vf=e;const h=Yw.map(new Map,{deep:!1});f.forEach((k,l)=>{this.keyType.lpa(l);h.set(l,hzb(this,l,k))});this.Ecc=new mx(h,this.vf?this:void 0)}},kzb=class extends px{Gpb(a){return new kzb(this.tf,this.domain,this.keyType,this.valueType,a,this.Oi)}Po(a,b){return new kzb(this.tf,this.domain,this.keyType,this.valueType,a,b)}constructor(a,b,c,d,e,f){super(a,e,f);this.domain=b;this.keyType=c;this.valueType=d;this.dJ=(h,k,l)=>new dDb(this.keyType,this.valueType,
this.domain,h,k,l)}};var eDb;Kw=__c.Kw=class{lpa(a){na(this.yE(a),"invalid value: {}",a);return a}z7a(a,b){if(!this.As(a,b))throw Error(`Invalid argument: ${this.stringify(a)} != ${this.stringify(b)}`);}constructor(a){this.serializer=a}};Kw.prototype.vs=ba(123);eDb=class extends Kw{As(a,b){return a===b}Ze(a){return a}stringify(a){return JSON.stringify(a)}};__c.Uw=class extends eDb{yE(a){return this.values.has(a)}At(a){return new __c.Uw(this.values,a)}constructor(a,b){super(b);this.values=a}};__c.Uw.prototype.vs=ba(122);
var Tw=class extends eDb{At(a){return new Tw(this.yE,a)}constructor(a,b){super(b);this.yE=a}},mAb=class extends Kw{yE(a){return a.every(b=>this.type.yE(b))&&(!this.Ena||this.Ena(a))}As(a,b){return a.length===b.length&&a.every((c,d)=>d in b&&this.type.As(c,b[d]))&&a.reduce(c=>c+1,0)===b.reduce(c=>c+1,0)}Ze(a){return Object.freeze(a.map(b=>this.type.Ze(b)))}stringify(a){return a.length?"[ "+a.map(b=>this.type.stringify(b)).join(", ")+" ]":"[]"}At(a){return new mAb(this.type,this.Ena,a)}constructor(a,
b,c){super(c);this.type=a;this.Ena=b}},nAb=class extends Kw{yE(a){return[...a].every(this.fzd)}As(a,b){if(a.size!==b.size)return!1;for(const [c,d]of a)if(a=b.get(c),a==null||!this.valueType.As(d,a))return!1;return!0}Ze(a){const b=new Map;for(const [c,d]of a)b.set(c,this.valueType.Ze(d));return b}stringify(a){return a.size?`{ ${[...a].map(([b,c])=>`${this.keyType.stringify(b)} => ${this.valueType.stringify(c)}`).join(", ")} }`:"{}"}At(a){return new nAb(this.keyType,this.valueType,a)}constructor(a,
b,c){super(c);this.keyType=a;this.valueType=b;this.fzd=([d,e])=>fDb.every(f=>!d.includes(f))&&this.keyType.yE(d)&&this.valueType.yE(e)}},fDb=["$",".","\x00"],oAb=class extends Kw{yE(a){return this.keys.every(b=>this.fields[b].yE(a[b]))&&(!this.Ena||this.Ena(a))}As(a,b){return this.keys.every(c=>this.fields[c].As(a[c],b[c]))}Ze(a){return Object.freeze(qw(this.fields,(b,c)=>b.Ze(a[c])))}stringify(a){return this.keys.length?"{ "+this.keys.map(b=>`${b}: ${this.fields[b].stringify(a[b])}`).join(", ")+
" }":"{}"}At(a){return new oAb(this.fields,this.Ena,a)}Ea(a){var b=qw(this.fields,c=>c.serializer);b=vw(b);return this.At(sw(b,a))}constructor(a,b,c){super(c);this.fields=a;this.Ena=b;this.keys=Object.keys(this.fields)}},pAb=class extends Kw{yE(a){return this.SI[this.zqa(a)].yE(a)}As(a,b){const c=this.zqa(a),d=this.zqa(b);return c===d&&this.SI[c].As(a,b)}Ze(a){return this.SI[this.zqa(a)].Ze(a)}stringify(a){return this.SI[this.zqa(a)].stringify(a)}At(a){return new pAb(this.SI,this.zqa,a)}Jm(a,b){const c=
qw(this.SI,e=>e.serializer),d=kyb(a);return this.At(ww(c,this.zqa,e=>d[b(e)]))}constructor(a,b,c){super(c);this.SI=a;this.zqa=b}},qAb=class extends Kw{yE(a){return a==null||this.type.yE(a)}As(a,b){return a!=null?b!=null&&this.type.As(a,b):b==null}Ze(a){return a!=null?this.type.Ze(a):void 0}stringify(a){return a!=null?this.type.stringify(a):"undefined"}At(a){return new qAb(this.type,a)}constructor(a,b){super(b);this.type=a}},rAb=class extends qAb{As(a,b){return a==null||b==null||super.As(a,b)}},sAb=
class extends eDb{yE(a){return typeof a==="string"&&this.regexp.test(a)}At(a){return new sAb(this.regexp,a)}constructor(a,b){super(b);this.regexp=a}},tAb=class extends Kw{yE(){return!0}As(a,b){return a===b}Ze(a){return a}stringify(a){return String(a)}At(a){return new tAb(a)}};var gDb,ozb;gDb=class{get yj(){return!1}snapshot(){return this.mutable}ji(){}destroy(a){this.type.z7a(this.mutable,a)}constructor(a,b){this.type=a;this.mutable=this.type.lpa(b)}};__c.nzb=class extends ox{aJ(a,b){return new gDb(this.type,b)}snapshot(a){return a}Po(a,b){return new __c.nzb(this.domain,this.type,a,b)}constructor(a,b,c,d){super(c,d);this.domain=a;this.type=b}};
ozb=class extends Kw{yE(){return!0}As(a,b){return this.domain.ni(a,b)}Ze(a){return this.domain.Ze(a)}stringify(a){return JSON.stringify(a)}At(a){return new ozb(this.domain,a)}constructor(a,b){super(b);this.domain=a}};var hDb;hDb=Symbol.iterator;
var iDb=class{static C(a){qb(a,{kH:Ww,empty:Ww,Tic:Ww,Rpc:Ww})}fj(){this.vf?.fj()}get yj(){return Xw(()=>nw(this.cells)||this.cells.some(a=>a!=null&&a.Cg.yj))}dua(a){const b=this.ve.yf(this.type,a,c=>this.domain.Bd().Ob(Iw(this,b.mutable)).update(c).build(),this.vf?this:void 0);return{Cg:b,id:String(this.TNb++)}}tQa(a,b){b.Cg.destroy(a)}ji(a){const b=this.cells,c=new Map,d=new Map;var e=0;b.length<a.pre&&(b.length=a.pre);for(var f of a.Jb)switch(f.type){case 0:case 2:e+=f.length;break;case 1:b.spliceWithArray(e,
0,Array(f.length));e+=f.length;break;case 3:var h=f.state,k=f.shift;b.splice(e,0,h!=null?this.dua(h):void 0);k&&(d.set(k.La,b[e]),c.set(k.zj,e));e++;break;case 4:var l=f.delta;h=f.shift;if(l)switch(l.type){case 0:k=l.delta;k!=null&&g(b[e]).Cg.ji(k);break;case 1:k=l.oldState;l=l.newState;k==null?oa(b[e]==null):this.tQa(k,g(b[e]));b[e]=l!=null?this.dua(l):void 0;break;default:throw new n(l);}h&&(d.set(h.La,b[e]),c.set(h.zj,e));e++;break;default:throw new n(f);}oa(d.size===a.Nva);oa(c.size===a.Nva);
for(e=0;e<a.Nva;e++)oa(d.has(e)),f=g(c.get(e)),b[f]=d.get(e);for(;b.length&&b[b.length-1]==null;)b.length--;Cw(this.ve)}snapshot(){return this.ve.snapshot()}ZM(){const a=[];this.cells.forEach((b,c)=>{b!=null&&(a[c]=b.Cg.snapshot())});return Object.freeze(a)}destroy(a){let b=0;this.cells.forEach((d,e)=>{d!=null&&(na(e in a),d.Cg.destroy(a[e]),b++)});const c=a.reduce(d=>d+1,0);na(b===c)}get kH(){return this.cells.filter(__c.eb)}get(a){return this.cells[a]?.Cg.mutable}get empty(){return!this.kH.length}count(){return this.kH.length}toArray(){return this.kH.map(a=>
a.Cg.mutable)}NKa(){return new Map(this.map((a,b)=>[b,a]))}[hDb](){return this.toArray()[Symbol.iterator]()}get Tic(){return this.kH[0]?.Cg.mutable}get Rpc(){return this.kH[this.kH.length-1]?.Cg.mutable}first(a){return a?this.kH.find(b=>a(b.Cg.mutable))?.Cg.mutable:this.Tic}last(a){if(!a)return this.Rpc;const b=this.kH;for(let c=b.length-1;c>=0;c--){const d=b[c];if(a(d.Cg.mutable))return d.Cg.mutable}}next(a,b){const c=this.cells;for(a=Iw(this,a)+1;a<c.length;a++){const d=c[a];if(d&&(!b||b(d.Cg.mutable)))return d.Cg.mutable}}previous(a,
b){const c=this.cells;for(a=Iw(this,a)-1;a>=0;a--){const d=c[a];if(d&&(!b||b(d.Cg.mutable)))return d.Cg.mutable}}has(a){return this.idb.get().has(a)}insertAt(a,b){this.ve.tu(this.domain.Bd().Ob(a).insert(this.type.Ze(b)).build());return this.cells[a].Cg.mutable}set(a,b){na(a>=0);a>=this.cells.length&&(this.cells.length=a+1);var c=this.cells[a];c=c!=null?c.Cg.snapshot():void 0;this.ve.tu(this.domain.Bd().Ob(a).jp(c,this.type.Ze(b)).build());return this.cells[a].Cg.mutable}replace(a,b){a=Iw(this,a);
return this.set(a,b)}append(a){return this.insertBefore(void 0,a)}prepend(a){return this.qdb(void 0,a)}qdb(a,b){return this.insertAt(a?Iw(this,a)+1:0,b)}insertBefore(a,b){return this.insertAt(a?Iw(this,a):this.cells.length,b)}delete(a){a=this.domain.Bd().Ob(Iw(this,a)).rQ(this.type.snapshot(a)).build();this.ve.tu(a)}moveTo(a,b){const c=Iw(this,b);if(c===a)return b;this.ve.tu(c<a?this.domain.Bd().Ob(c).Ob({La:0,zj:1}).Ob(a-c-1).expand({La:1,zj:0}).build():this.domain.Bd().Ob(a).expand({La:0,zj:1}).Ob(c-
a).Ob({La:1,zj:0}).build());return b}moveBefore(a,b){a=a!=null?Iw(this,a):this.cells.length;this.moveTo(a,b)}map(a){return this.kH.map(b=>a(b.Cg.mutable,b.id))}flatMap(a){return this.kH.flatMap(b=>a(b.Cg.mutable,b.id))}filter(a){return this.kH.filter(b=>a(b.Cg.mutable,b.id)).map(b=>b.Cg.mutable)}forEach(a){this.kH.forEach(b=>b!=null&&a(b.Cg.mutable,b.id))}reduce(a,b){return this.kH.reduce((c,d)=>a(c,d.Cg.mutable,d.id),b)}some(a){return this.kH.some(b=>a(b.Cg.mutable,b.id))}every(a){return this.kH.every(b=>
a(b.Cg.mutable,b.id))}constructor(a,b,c,d,e){this.type=a;this.domain=b;this.ve=c;this.vf=d;this.cells=(iDb.C(this),void 0);this.TNb=0;this.idb=Ww(()=>{const f=new Map;this.cells.forEach((h,k)=>h&&f.set(h.Cg.mutable,k));return f});na(!e.length||e[e.length-1]!=null);this.cells=Yw.array([...e.map(f=>this.dua(f))],{deep:!1});zAb(this.cells,()=>this.fj());Bw(this.cells,()=>this.fj())}},rzb=class extends px{Bd(){return this.domain.Bd()}Po(a,b){return new rzb(this.tf,this.domain,this.type,a,b)}constructor(a,
b,c,d,e){super(a,d,e);this.domain=b;this.type=c;this.dJ=(f,h,k)=>new iDb(this.type,this.domain,f,h,k)}};var jDb=class{get yj(){return!1}get mutable(){throw new n(this.never);}snapshot(){throw new n(this.never);}ji(){throw new n(this.never);}destroy(){throw new n(this.never);}constructor(a){this.never=a;throw new n(a);}},wzb=class extends ox{aJ(a,b){return new jDb(b)}snapshot(a){throw new n(a);}Po(a,b){return new wzb(this.domain,a,b)}constructor(a,b,c){super(b,c);this.domain=a}};var lDb=class{static instance(){return kDb}get yj(){return!1}get mutable(){}destroy(a){na(a==null)}ji(a){na(a==null)}snapshot(){}},kDb=new lDb,mDb=class{ji(a){this.Cg.ji(g(a))}get yj(){return this.Cg.yj}destroy(a){this.Cg.destroy(g(a))}get mutable(){return this.Cg.mutable}snapshot(){return this.Cg.snapshot()}constructor(a){this.Cg=a}},yzb=class extends ox{aJ(a,b,c,d,e,f){return b==null?lDb.instance():new mDb(this.type.aJ(a,b,c,d,e,f))}snapshot(a){return a!=null?this.type.snapshot(a):void 0}Po(a,b){return new yzb(this.domain,
this.type,a,b)}constructor(a,b,c,d){super(c,d);this.domain=a;this.type=b}};var nDb=class{static C(a){qb(a,{tpc:Ww})}fj(){this.vf?.fj()}get yj(){return this.zAc.$F||nw(this.items)}ji(a){if(!this.domain.isIdentity(a)){var b=a.axis;if(!b.isEmpty()){var c=0;this.items.length<b.pre&&(this.items.length=b.pre);b=b.Fc();for(var d=b.head;d;)d.type===0?c+=b.xu(d.length):(d=tv(b,d.length),this.items.spliceWithArray(c,0,Array(d)),c+=d),d=b.head}for(const [e,f]of a.Fj)switch(f.type){case 0:f.oldValue!=null?(a=g(this.refs.get(e)),c=Lw(this,f.oldValue),na(a===c)):na(!this.refs.has(e));
f.newValue!=null?this.refs.set(e,Lw(this,f.newValue)):this.refs.delete(e);break;case 1:a=g(this.refs.get(e));c=Lw(this,f.oldValue);na(a===c);this.refs.set(e,Lw(this,f.newValue));break;default:throw new n(f);}Cw(this.ve)}}snapshot(){return this.ve.snapshot()}ZM(){const a=this.domain.og();for(const [b,c]of this.refs)a.ordinal(b,Mw(this,c));return a.build()}destroy(a){oa(this.refs.size===a.size);for(const [b,c]of this.refs)oa(a.has(b)),oa(Mw(this,c)===a.get(b))}get refs(){return this.zAc.get()}get tpc(){const a=
new Map;this.items.forEach((b,c)=>a.set(b,c));return a}get(a){return Mw(this,this.refs.get(a))}has(a){return this.get(a)!=null}forEach(a){for(const [b,c]of this.refs)a(Mw(this,c),b)}create(a,b){a=this.domain.replace(a,this.get(a),b);this.ve.tu(a)}update(a,b){const c=g(Mw(this,this.refs.get(a)));a=this.domain.update(a,c,b);this.ve.tu(a)}delete(a){const b=Mw(this,this.refs.get(a));b!=null&&(a=this.domain.replace(a,b,void 0),this.ve.tu(a))}constructor(a,b,c,d){this.domain=a;this.ve=b;this.vf=c;this.items=
(nDb.C(this),Yw.array([],{deep:!1}));const e=Yw.map(new Map,{deep:!1});Xw(()=>{for(const [f,h]of d)e.set(f,Lw(this,h))});this.zAc=new mx(e,c?this:void 0);this.vf!=null&&(zAb(this.items,()=>this.fj()),Bw(this.items,()=>this.fj()))}},Azb=class extends px{Po(a,b){return new Azb(this.tf,this.domain,a,b)}constructor(a,b,c,d){super(a,c,d);this.domain=b;this.dJ=(e,f,h)=>new nDb(this.domain,e,f,h)}};var oDb;oDb=class{forEach(a,b=this.pre,c=this.post){this.Jb.forEach(d=>{switch(d.type){case 0:a.Ob?.(d.ud);break;case 2:a.insert?.(d.ud);break;case 1:a.delete?.(d.ud);break;default:throw new n(d);}});(b=Math.max(0,b-this.pre,c-this.post))&&a.Ob?.(b)}static un(){return new Ow}constructor(a,b,c){this.pre=a;this.post=b;this.Jb=c}};
Ow=__c.Ow=class{static insert(a,b){return(new Ow).Ob(a).insert(b).build()}static delete(a,b){return(new Ow).Ob(a).delete(b).build()}Ob(a){na(a>=0);a>0&&(this.qZ(0),this.QIa+=a);return this}insert(a){a.length>0&&(this.qZ(2),this.$Ua+=a);return this}delete(a){a>0&&(this.qZ(1),this.YAa+=a);return this}qZ(a){if(this.mode!==a){switch(this.mode){case 0:var b=this.Jb,c=b.push,d=this.QIa;na(d>0);c.call(b,{type:0,ud:d});this.pre+=this.QIa;this.post+=this.QIa;this.QIa=0;break;case 2:b=this.Jb;c=b.push;d=this.$Ua;
na(d.length>0);c.call(b,{type:2,ud:d});this.post+=this.$Ua.length;this.$Ua="";break;case 1:b=this.Jb;c=b.push;d=this.YAa;na(d>0);c.call(b,{type:1,ud:d});this.pre+=this.YAa;this.post+=this.YAa;this.YAa=0;break;case void 0:break;default:throw new n(this.mode);}this.mode=a}}build(){this.mode!==0&&this.qZ();return new oDb(this.pre,this.post,this.Jb)}constructor(){this.Jb=[];this.post=this.pre=0;this.mode=void 0;this.QIa=0;this.$Ua="";this.YAa=0}};var pDb=class{static C(a){qb(a,{ud:Ww})}fj(){this.vf?.fj()}get yj(){return this.state.$F||!!this.subscriptions?.size||this.subject.observers.length>0}ji(a){const b=Dzb(this.state.get(),a);this.state.set(this.domain.apply(this.state.get(),a));Cw(this.ve);this.subject.next(b)}snapshot(){return this.ve.snapshot()}ZM(){return this.state.get()}destroy(a){na(this.domain.ni(this.state.get(),a))}get ud(){return this.state.get().ud()}insert(a,b){this.ve.tu(Czb(this.domain,this.state.get(),Ow.insert(a,b)))}delete(a,
b){this.ve.tu(Czb(this.domain,this.state.get(),Ow.delete(a,b)))}constructor(a,b,c,d){this.domain=a;this.ve=b;this.vf=c;this.state=(pDb.C(this),void 0);this.subject=new AAb;this.subscriptions=void 0;this.state=new mx(d,this.vf!=null?this:void 0)}},Ezb=class extends px{Po(a,b){return new Ezb(this.tf,this.domain,a,b)}constructor(a,b,c,d){super(a,c,d);this.domain=b;this.dJ=(e,f,h)=>new pDb(this.domain,e,f,h)}};var Hzb=class{create(a,b){a=this.Tjb.z_b(a);var c=this.base.get(a.start);const d=this.base.get(a.end);if(c==null&&d==null){c=this.base;b=new Map([[a.start,b.start],[a.end,b.end]]);a=c.domain.Bd();for(const [e,f]of b)Tv(a,e,c.get(e),f);c.ve.tu(a.build())}}get(a){var b=this.Tjb.z_b(a);a=this.base.get(b.start);b=this.base.get(b.end);if(a!=null&&b!=null)return{start:a,end:Math.max(a,b)}}has(a){return this.get(a)!=null}forEach(a){const b=new Set;this.base.forEach((c,d)=>{c=this.Tjb.mrd(d);b.has(c)||(b.add(c),
d=g(this.get(c)),a(d,c))})}delete(a){var b=this.Tjb.z_b(a);a=this.base;var c=new Set([b.start,b.end]);b=a.domain.Bd();for(const d of c)c=a.get(d),c!=null&&Tv(b,d,c);a.ve.tu(b.build())}constructor(a,b){this.base=a;this.Tjb=b}};var qDb=class extends Zw{static of(a){return new qDb(a)}isIdentity(a){return a===this.id||Object.entries(a).every(([b,c])=>c==null||this.components[b].isIdentity(c))}constructor(a){super();this.components=a;this.id={}}};var Jzb=class extends $w{static of(a,b){return new Jzb(a,b)}update(a,b){const c={};g(this.components[a]).isIdentity(b)||(c[a]=b);return c}identity(){return this.id}isIdentity(a){return this.base.isIdentity(a)}gj(a){const b={};var c=Object.keys(a);if(!c.length)return a;for(const e of c){var d=a[e];d!=null&&(c=this.components[e],d=c.gj(d),c.isIdentity(d)||(b[e]=d))}return b}lg(a,b){const c={};var d=Object.keys(a),e=Object.keys(b);if(!d.length)return b;if(!e.length)return a;for(const f of new Set([...d,
...e])){e=a[f];const h=b[f];e!=null&&h!=null?(d=this.components[f],e=d.lg(e,h),d.isIdentity(e)||(c[f]=e)):e!=null?c[f]=e:h!=null&&(c[f]=h)}return c}transform(a,b){const c={},d={};var e=Object.keys(a),f=Object.keys(b);if(!e.length||!f.length)return pv(b,a);const h=ov.un();for(const k of new Set([...e,...f])){f=a[k];const l=b[k];f!=null&&l!=null?(e=this.components[k],f=rv(h,e.transform(f,l)),e.isIdentity(f.gq)||(c[k]=f.gq),e.isIdentity(f.Ip)||(d[k]=f.Ip)):f!=null?c[k]=f:l!=null&&(d[k]=l)}return h.build(d,
c)}apply(a,b){var c=Object.keys(b);if(!c.length)return a;const d={...a};for(const e of c)c=b[e],c!=null&&(d[e]=this.components[e].apply(a[e],c));return Object.freeze(d)}rj(a,b){var c=Object.keys(b);if(!c.length)return a;const d={...a};for(const e of c)c=b[e],c!=null&&(d[e]=this.components[e].rj(a[e],c));return Object.freeze(d)}Ze(a){return Object.freeze(Cv(this.components,(b,c)=>b.Ze(a[c])))}ni(a,b){return a===b||Object.keys(this.components).every(c=>this.components[c].ni(a[c],b[c]))}Bi(a,b){if(a===
b)return!0;const c=Object.keys(a),d=Object.keys(b);return!c.length&&!d.length||__c.lv([...c,...d]).every(e=>{const f=a[e],h=b[e];return f!=null&&h!=null&&this.components[e].Bi(f,h)})}equals(a){return this===a?!0:a instanceof Jzb?Object.keys(this.components).length===Object.keys(a.components).length&&Object.keys(this.components).every(b=>b in a.components&&this.components[b].equals(a.components[b])):!1}constructor(a,b){super(a);this.components=b;this.base=new qDb(this.components);this.id={}}};var rDb=class{fj(){this.vf?.fj()}get yj(){if(this.AW!=null)return!0;for(const a in this.ez.Za)if(this.Za[a].yj)return!0;for(const a in this.ez.attributes)if(this.attributes[a].yj)return!0;return!1}ji(a){let b=!1;for(const c in a)a[c]!=null&&(c in this.ez.Za?(this.Za[c].ji(a[c]),b=!0):c in this.ez.attributes&&(this.attributes[c].ji(a[c]),b=!0));b&&Cw(this.ve)}snapshot(){return this.ve.snapshot()}ZM(){const a={};for(const b in this.ez.values)a[b]=this.values[b];for(const b in this.ez.Za)a[b]=this.Za[b].snapshot();
for(const b in this.ez.attributes)a[b]=this.attributes[b].snapshot();return Object.freeze(a)}destroy(a){for(const b in this.ez.values)this.ez.values[b].z7a(this.values[b],a[b]);for(const b in this.ez.Za)this.Za[b].destroy(a[b]);for(const b in this.ez.attributes)this.attributes[b].destroy(a[b]);if(this.AW?.cka)try{this.AW.cka()}catch(b){Promise.reject(b)}}getValue(a){return this.values[a]}getAttribute(a){return this.attributes[a].snapshot()}setAttribute(a,b){this.attributes[a].mutable.value=b}constructor(a,
b,c,d,e,f,h){this.ez=a;this.ve=e;this.vf=f;this.AW=void 0;this.values=qw(a.values,(k,l)=>k.lpa(h[l]));this.Za=qw(a.Za,(k,l)=>this.ve.yf(k,h[l],b[l],this.vf?this:void 0,{pmc:"lazy"}));this.attributes=qw(a.attributes,(k,l)=>this.ve.yf(k,h[l],c[l],this.vf?this:void 0,{pmc:"lazy"}));this.proxy=Nzb(this,d)}},Pw=Symbol("$impl"),sDb=class extends ox{},tDb=class extends px{Po(a,b){return new tDb(this.tf,this.domain,this.ez,a,b)}constructor(a,b,c,d,e){super(a,d,e);this.domain=b;this.ez=c;this.wSd=qw(this.ez.Za,
(f,h)=>k=>({[h]:k}));this.f3c=qw(this.ez.attributes,(f,h)=>k=>({[h]:k}));this.dJ=(f,h,k)=>new rDb(this.ez,this.wSd,this.f3c,this.bRd,f,h,k);a=qw(c.Za,(f,h)=>({enumerable:!0,configurable:!0,get(){return this[Pw].Za[h].mutable}}));b=qw(c.attributes,(f,h)=>({enumerable:!0,configurable:!0,get(){return this[Pw].getAttribute(h)},set(k){this[Pw].setAttribute(h,k)}}));d=qw(c.computed?.Za||{},(f,h)=>({enumerable:!0,configurable:!0,get(){var k=this[Pw];k.AW==null&&(k.AW=Mzb(k),k.fj());return k.AW.Za[h]}}));
c=qw(c.computed?.attributes||{},(f,h)=>({enumerable:!0,configurable:!0,get(){var k=this[Pw];k.AW==null&&(k.AW=Mzb(k),k.fj());return k.AW.attributes[h].value},set(k){var l=this[Pw];l.AW==null&&(l.AW=Mzb(l),l.fj());l.AW.attributes[h].value=k}}));this.bRd={...a,...d,...b,...c}}},uDb=class{get mutable(){return this.base.mutable.proxy}get yj(){return this.base.yj}destroy(a){this.base.destroy(a)}ji(a){this.base.ji(a)}snapshot(){return this.base.snapshot()}constructor(a){this.base=a}},Ozb=class extends sDb{aJ(a,
b,c,d,e,f){a=this.base.aJ(a,b,c,d,e,f);return new uDb(a)}snapshot(a){return this.base.snapshot(a[Pw])}Po(a,b){return new Ozb(this.tf,this.values,this.Za,this.attributes,this.computed,this.qzb,a,b)}Ea(a,b){const c=vw({...qw(this.Za,e=>xw(e.bE)),...qw(this.attributes,e=>e.bE)}),d=vw({...qw(this.values,e=>e.serializer),...qw(this.Za,e=>e.Oi),...qw(this.attributes,e=>e.Oi)});return this.Po(sw(c,a),sw(d,b))}constructor(a,b,c,d,e,f,h,k){super(h,k);this.tf=a;this.values=b;this.Za=c;this.attributes=d;this.computed=
e;this.qzb=f;this.domain=Kzb(this.tf,qw(this.values,l=>this.qzb((m,r)=>l.As(m,r),m=>l.Ze(m))),qw(this.Za,l=>l.domain),qw(this.attributes,l=>l.domain));Lzb(b,{...c,...e?.Za},{...d,...e?.attributes});this.base=new tDb(this.tf,this.domain,this,h,k)}};var Rzb;Rzb=class extends ox{get type(){typeof this.ref==="function"&&(this.ref=this.ref());return this.ref}aJ(a,b,c,d,e,f){return this.type.aJ(a,b,c,d,e,f)}snapshot(a){return this.type.snapshot(a)}Po(a,b){return this.map(c=>c,c=>c,c=>c,c=>c,c=>c,c=>c).Po(a,b)}constructor(a,b){super(new KCb(()=>this.type.bE),new KCb(()=>this.type.Oi));this.ref=b;this.domain=a(()=>this.type.domain)}};
__c.Szb=class extends Kw{get value(){typeof this.ref==="function"&&(this.ref=this.ref());return this.ref}yE(a){return this.value.yE(a)}As(a,b){return this.value.As(a,b)}Ze(a){return this.value.Ze(a)}stringify(a){return this.value.stringify(a)}lpa(a){return this.value.lpa(a)}z7a(a,b){this.value.z7a(a,b)}At(a){return this.value.At(a)}constructor(a){super(new KCb(()=>this.value.serializer));this.ref=a}};__c.Szb.prototype.vs=ba(121);__c.vDb=class{forEach(a){const b=this.BY.Bd();this.Gf.forEach({Ob:c=>b.Ob(c),insert:c=>b.insert(c),delete:c=>b.eV(c)},this.pre,this.post);(new lx(b.build(),this.attrs)).forEach({Ob:(c,d)=>a.Ob?.(c,d),insert:(c,d)=>c.type!==2&&a.insert?.(c.state,d),jp:(c,d,e)=>a.delete?.(c.length,e)})}constructor(a,b,c){this.BY=a;this.Gf=b;this.attrs=c;this.pre=Math.max(this.Gf.pre,this.attrs.pre);this.post=Math.max(this.Gf.post,this.attrs.post)}};var wDb,xDb,Uzb,yDb,zDb;
wDb=class{static C(a){qb(a,{charLength:Ww,ud:Ww,isEmpty:Ww,i3c:Ww})}fj(){this.vf?.fj()}get yj(){return this._state.$F||!!this.subscriptions?.size||this.subject.observers.length>0}ji(a){const b=Vzb(this.domain.cells,this._state.get(),a);this._state.set(this.domain.apply(this._state.get(),a));Cw(this.ve);this.subject.next(b)}onError(a){this.subject.error(a)}snapshot(){return this.ve.snapshot()}ZM(){return this.state}destroy(a){na(this.domain.ni(this._state.get(),a));this.subject.complete()}get charLength(){return this._state.get().cells.nga}get ud(){return this._state.get().cells.ud()}get isEmpty(){const a=this.charLength;
return a===0||a===1&&Txb(this._state.get().cells)}get i3c(){const a=[];this._state.get().forEach({...Nw,ud:(b,c,d)=>a.push({ud:b,attributes:{...d}})});return a}bvb(){const a=this._state.get();return this.domain.attrs.zC(a.attrs,a.length,this.Pk)}setAttribute(a,b,c){const d={};d[a]=b;this.setAttributes(d,c)}setAttributes(a,b){b=Wzb(this,b);if(b.length!==0&&Object.keys(a).length!==0){a=this.Pk.Ogb(a);var c=this._state.get(),d=this.bvb();c=c.cells.cursor(c.length,{...Nw,ud:e=>d.Ob(e.length),lm:e=>d.Ob(e)});
c.Bja(b.index);c.tgb();d.S7(a);c.Bja(b.length);c.tgb();d.bN(a);Xzb(this,d.build())}}zC(){return this.domain.zC(this._state.get(),this.Pk)}Tva(a){if(a.length){na(a.every((e,f)=>{f=a[f+1];return e.length>0&&(f==null||e.index+e.length<=f.index)}));var b=this.zC(),c=0,d=this._state.get().cursor();for(const {index:e,length:f}of a){const h=e+f;d.Bja(e-c,{...Nw,ud:l=>b.Ob(l.length),lm:l=>b.Ob(l)});let k=!1;d.Bja(f,{...Nw,ud:(l,m,r)=>{k||(b.S7(r),b.insert(void 0),b.bN(r),k=!0);b.delete(l)},lm:l=>b.Ob(l)});
c=h}this.ve.tu(b.build())}}get state(){return this._state.get()}constructor(a,b,c,d,e,f){this.domain=a;this.Pk=b;this.lZb=c;this.ve=d;this.vf=e;this._state=(wDb.C(this),void 0);this.subject=new AAb;this.subscriptions=void 0;this._state=new mx(f,this.vf?this:void 0)}};
xDb=class{Gf(a){a.length>0&&(this.ohc=a.endsWith("\n"),this.un.Gf(a));return this}tc(a,b){this.un.tc(a,this.Pk.normalize(a,b));return this}attrs(a){this.un.attrs(this.Pk.Ogb(a));return this}build(){const a=this.un.build();oa(a.length===0||this.ohc);return a}constructor(a,b){this.un=a;this.Pk=b;this.ohc=!1}};
Uzb=class{jp(a){this.attrs.jp(a);return this}Ob(a,b){this.Gf.Ob(a);this.attrs.Ob(a,b);return this}insert(a,b){this.Gf.insert(a);this.attrs.insert(a.length,b);return this}delete(a,b){this.Gf.delete(a);this.attrs.Ob(a,b);return this}build(){return new __c.vDb(this.BY,this.Gf.build(),this.attrs.build())}constructor(a){this.BY=a;this.Gf=new Ow;this.attrs=new QAb}};
yDb=class{Ob(a){this.Gf.Ob(a);this.attrs.Ob(a);return this}insert(a){this.Gf.insert(a);this.attrs.insert(a.length);return this}delete(a){this.Gf.delete(a);this.attrs.Ob(a);return this}open(a,b){this.attrs.open(a,this.Pk.normalize(a,b));return this}S7(a){this.attrs.S7(this.Pk.Ogb(a))}close(a){this.attrs.close(a);return this}bN(a){this.attrs.bN(a);return this}build(){return new __c.vDb(this.BY,this.Gf.build(),this.attrs.build())}constructor(a,b,c){this.BY=a;this.Pk=b;this.attrs=c;this.Gf=new Ow}};
zDb=class extends px{};Sw=__c.Sw=class extends zDb{og(){return this.uAb()}uAb(){return new xDb(this.domain.og(this.Pk),this.Pk)}zC(a){a=this.domain.bvb(a,this.Pk);return new yDb(this.domain.cells,this.Pk,a)}Ze(a){return this.domain.Ze(a,b=>this.Pk.HH(b))}Po(a,b){return new Sw(this.tf,this.domain,this.Pk,this.lZb,a,b)}constructor(a,b,c,d,e,f){super(a,e,f);this.domain=b;this.Pk=c;this.lZb=d;this.dJ=(h,k,l)=>{Yzb(l,this.Pk);return new wDb(this.domain,this.Pk,this.lZb,h,k,l)}}};Sw.prototype.Lmb=ba(126);
Sw.prototype.X8a=ba(125);Sw.prototype.WD=ba(116);var ADb,BDb;
ADb=class{static C(a){qb(a,{vlb:Ww.struct,isEmpty:Ww,items:Ww({equals:zw.shallow}),P2c:Ww})}fj(){this.vf?.fj()}get yj(){return Xw(()=>this.cells.$F||this.attrs.$F||this.wc.$F||this.cells.get().items.some(a=>a.yj)||!!this.subscriptions?.size||this.subject.observers.length>0)}tu(a){this.ve.tu(this.t4c?this.t4c(a):a)}onError(a){this.subject.error(a)}dua(a){const b=this.ve.yf(this.type,a,c=>{a:{var d=this.cells.get();let e=0,f=0;for(const h of d.sequence){if(Vv(h)===1){if(d.items[f]===b){d=e;break a}f++}e+=
Math.abs(h)||1}d=-1}oa(d>=0,"cell not found");return this.domain.Bd().Ob(d).update(c).build()},this.vf?this:void 0);return b}tQa(a,b){a.destroy(b)}ji(a){var b=a.TI,c=a.MI;a=a.xA;const d=new bCb(h=>h);if(!this.domain.cells.isIdentity(b)){const h=new VBb,k=this.cells.get().Fc(b.pre);for(b=b.Fc(this.cells.get().length,0);;){let l=k.head;var e=b.head;if(!e)break;if(e.type===2)l=void 0,e=$v(b);else if(l){var f=Math.min(l.length,e.U1);l=k.fl(f);e=aw(b,f)}if(e.type===2)l=e.state.NJ(m=>this.dua(m)),h.region(l),
d.I6(l);else if(l)switch(e.type){case 0:h.region(l);d.Ob(e.length);break;case 1:na(l.type===1);l.state.ji(e.delta);h.region(l);d.Ob(1);break;case 3:f=e.oldState;e=e.newState;l.type===1?(na(l.type===f.type,"{} != {}",l.type,f.type),this.tQa(l.state,f.state)):Zxb(this.domain.cells,l,f);f=l;l=e.NJ(m=>this.dua(m));h.region(l);Zv(d,f,l);break;default:throw new n(e);}else throw Error("reader exhausted prematurely");}k.finish();b.finish();this.cells.set(h.build())}this.attrs.set(this.domain.attrs.apply(this.attrs.get(),
c));this.wc.set(this.domain.wc.apply(this.wc.get(),g(a)));Cw(this.ve);c=new lx(d.build(),c,a);this.subject.next(c)}snapshot(){return this.ve.snapshot()}ZM(){return(new kx(this.cells.get(),this.attrs.get(),this.wc.get(),this.domain.wc)).NJ(a=>a.snapshot())}destroy(a){na(this.domain.ni(this.snapshot(),a));this.subject.complete()}get vlb(){return this.wc.get().Ve}get isEmpty(){const {Wp:a,nga:b}=this.cells.get();return a===0&&(b===0||b===1&&Txb(this.cells.get()))}get items(){return new Set(this.cells.get().items.map(a=>
a.mutable))}get P2c(){if(this.cells.get().nga<4E3){const a=Math.ceil(Math.log(this.cells.get().nga)/Math.log(2));return Math.pow(2,a)}return Math.round(this.cells.get().nga/1E3)*1E3}get length(){return Math.max(this.cells.get().length,this.attrs.get().length)}zC(){return new mCb(new bCb(()=>!0),this.domain.attrs.zC(this.attrs.get(),this.cells.get().length,this.Pk),this.domain.wc?.Bd())}insertAt(a,b){a=a.resolve(this.cells.get());na(0<=a&&a<=Math.max(0,this.cells.get().length-1),"Position {} is not in range [0, {}]",
a,Math.max(0,this.cells.get().length-1));a===this.cells.get().length&&na(typeof b==="string"&&b.endsWith("\n"));this.tu(this.domain.Bd().Ob(a).insert(typeof b==="string"?b:this.type.Ze(b)).build());if(typeof b!=="string"){b=this.cells.get().WKb(a);if(b==null||typeof b==="string")throw Error(`item expected at ${a}, found: ${b}`);return b.mutable}}qFc(a,b){const c=this.wc.get().Ve.get(a);var d=b?.resolve(this.cells.get());b=this.domain.Bd();d=d&&[d.start,d.end];b.wc?.B_a(a,c,d);a=b.build();this.tu(a)}cursor(a,
b){return(new kx(this.cells.get(),this.attrs.get(),this.wc.get(),this.domain.wc)).NJ(c=>c.mutable).cursor(a,b)}forEach(a){(new kx(this.cells.get(),this.attrs.get(),this.wc.get(),this.domain.wc)).forEach({...a,item:(b,c,d,e,f)=>a.item(b.mutable,c,d,e,f)})}constructor(a,b,c,d,e,f){this.Pk=a;this.type=b;this.domain=c;this.ve=d;this.vf=e;this.cells=(ADb.C(this),void 0);this.subject=new AAb;this.subscriptions=void 0;g(c.wc);this.cells=new mx(f.cells.NJ(k=>this.dua(k)),this.vf?this:void 0);this.attrs=new mx(f.attrs,
this.vf?this:void 0);this.wc=new mx(g(f.wc),this.vf?this:void 0);f.attrs.forEach(0,{grad:k=>a.xD(k)});const h=BAb(k=>this.Pk.HH(k)&&this.attrs.get().attributes[k]||new Set,{equals:zw.shallow});this.attributes=new Proxy({},{get:(k,l)=>h(l),has:(k,l)=>this.Pk.HH(l),ownKeys:()=>Object.keys(this.attrs.get().attributes),getOwnPropertyDescriptor:(k,l)=>{k=this.Pk.HH(l)?this.attrs.get().attributes[l]:void 0;if(k!=null)return{enumerable:!0,configurable:!0,value:k}}})}};BDb=class extends px{};
__c.$zb=class extends BDb{Bd(){return this.domain.Bd(this.Pk)}og(){return this.domain.og(this.Pk)}Ze(a){return this.domain.Ze(a,b=>this.Pk.HH(b))}Po(a,b){return new __c.$zb(this.tf,this.domain,this.Pk,this.type,a,b)}constructor(a,b,c,d,e,f){super(a,e,f);this.domain=b;this.Pk=c;this.type=d;this.dJ=(h,k,l)=>new ADb(this.Pk,this.type,this.domain,h,k,l)}};__c.$zb.prototype.WD=ba(115);var GDb=class{fj(){this.vf?.fj()}get yj(){return this.W_a.yj||this.jPa.yj||this.VIa.yj||this.XIa.yj||this.fAa.yj||this.gAa.yj||this.kpa.yj||this.ooa.yj}ji(a){const b=jw(this.domain,a.rows),c=jw(this.domain,a.cols);this.W_a.ji(a.rows);this.jPa.ji(a.cols);this.VIa.ji(this.fib.domain.he(b,a.Jn));this.XIa.ji(this.qj.he(b,a.Kn));this.fAa.ji(this.fib.domain.he(c,a.vn));this.gAa.ji(this.qj.he(c,a.wn));this.kpa.ji(this.domain.cells.he({...a.cells,y:b,x:c}));this.ooa.ji(this.domain.attrs.he({...a.attrs,y:b,
x:c}));Cw(this.ve)}snapshot(){return this.ve.snapshot()}ZM(){const a={rows:this.W_a.snapshot(),cols:this.jPa.snapshot(),Jn:this.VIa.snapshot(),Kn:this.XIa.snapshot(),vn:this.fAa.snapshot(),wn:this.gAa.snapshot(),cells:this.kpa.snapshot(),attrs:this.ooa.snapshot()};return Object.freeze(a)}destroy(a){this.W_a.destroy(a.rows);this.jPa.destroy(a.cols);this.VIa.destroy(a.Jn);this.XIa.destroy(a.Kn);this.fAa.destroy(a.vn);this.gAa.destroy(a.wn);this.kpa.destroy(a.cells);this.ooa.destroy(a.attrs)}constructor(a,
b,c,d,e,f,h,k,l,m,r){this.PUd=a;this.fib=f;this.domain=h;this.qj=k;this.ve=l;this.vf=m;this.gV=u=>this.rows.idb.get().get(u);this.cT=u=>this.cols.idb.get().get(u);this.fia=u=>this.rows.get(u);this.eia=u=>this.cols.get(u);this.Xbb=()=>{var u=this.rows.last();if(u==null)return 0;u=this.gV(u);return u!=null?u+1:0};this.wbb=()=>{var u=this.cols.last();if(u==null)return 0;u=this.cT(u);return u!=null?u+1:0};this.W_a=this.ve.yf(this.PUd,r.rows,u=>{const w=jw(this.domain,u);h.axis.isIdentity(w)||(this.kpa.ji(this.domain.cells.he({y:w})),
this.ooa.ji(this.domain.attrs.he({y:w})),this.VIa.ji(this.fib.domain.he(w,new Map)),this.XIa.ji(this.qj.he(w,new Map)));return this.domain.he({rows:u})},this.vf?this:void 0);this.rows=this.W_a.mutable;this.jPa=this.ve.yf(b,r.cols,u=>{const w=jw(this.domain,u);h.axis.isIdentity(w)||(this.kpa.ji(this.domain.cells.he({x:w})),this.ooa.ji(this.domain.attrs.he({x:w})),this.fAa.ji(this.fib.domain.he(w,new Map)),this.gAa.ji(this.qj.he(w,new Map)));return this.domain.he({cols:u})},this.vf?this:void 0);this.cols=
this.jPa.mutable;this.VIa=this.ve.yf(f,r.Jn,u=>{na(h.axis.isIdentity(u.axis));return this.domain.he({Jn:u.Fj})},this.vf?this:void 0);this.Jn=new CDb(this.VIa.mutable,this.gV,this.fia);this.XIa=this.ve.yf(e,r.Kn,u=>{na(h.axis.isIdentity(u.axis));return this.domain.he({Kn:u.Ve})},this.vf?this:void 0);this.Kn=new DDb(this.XIa.mutable,this.gV,this.fia);this.fAa=this.ve.yf(f,r.vn,u=>{na(h.axis.isIdentity(u.axis));return this.domain.he({vn:u.Fj})},this.vf?this:void 0);this.vn=new CDb(this.fAa.mutable,this.cT,
this.eia);this.gAa=this.ve.yf(e,r.wn,u=>{na(h.axis.isIdentity(u.axis));return this.domain.he({wn:u.Ve})},this.vf?this:void 0);this.wn=new DDb(this.gAa.mutable,this.cT,this.eia);this.kpa=this.ve.yf(c,r.cells,u=>{na(h.axis.isIdentity(u.x));na(h.axis.isIdentity(u.y));return this.domain.he({cells:u})},this.vf?this:void 0);this.cells=new EDb(this.kpa.mutable,this.gV,this.cT,this.fia,this.eia,this.Xbb,this.wbb);this.ooa=this.ve.yf(d,r.attrs,u=>{na(h.axis.isIdentity(u.x));na(h.axis.isIdentity(u.y));return this.domain.he({attrs:u})},
this.vf?this:void 0);this.attrs=new FDb(this.ooa.mutable,this.gV,this.cT,this.fia,this.eia,this.Xbb,this.wbb)}},EDb=class{get(a,b){a=this.gV(a);b=this.cT(b);if(a!=null&&b!=null&&(b=this.grid.get(a,b),b!=null))return{span:{$Ja:g(bAb(this,b.span)),YJa:g(cAb(this,b.span)),CDb:g(dAb(this,b.span)),zDb:g(eAb(this,b.span))},ref:b.ref}}forEach(a){this.grid.forEach((b,c)=>{const d=bAb(this,c),e=cAb(this,c);d!=null&&e!=null&&a(b,{$Ja:d,YJa:e,CDb:g(dAb(this,c)),zDb:g(eAb(this,c))})})}map(a){const b=[];this.forEach((c,
d)=>b.push(a(c,d)));return b}set(a,b){this.grid.set(fAb(this,a),b);return g(this.get(a.$Ja,a.YJa))}delete(a){this.grid.delete(fAb(this,a))}constructor(a,b,c,d,e,f,h){this.grid=a;this.gV=b;this.cT=c;this.fia=d;this.eia=e;this.Xbb=f;this.wbb=h}},FDb=class{get(a,b,c){b=this.gV(b);c=this.cT(c);if(b!=null&&c!=null)return this.grid.get(a,b,c)}set(a,b,c){const d=this.gV(b.$Ja),e=this.cT(b.YJa),f=this.gV(b.CDb||b.$Ja);b=this.cT(b.zDb||b.YJa);d!=null&&e!=null&&f!=null&&b!=null&&this.grid.set(a,{E_d:d,y_d:e,
Ymd:f,Xmd:b},c)}constructor(a,b,c,d,e,f,h){this.grid=a;this.gV=b;this.cT=c;this.fia=d;this.eia=e;this.Xbb=f;this.wbb=h}},CDb=class{get(a){a=this.Fj.get(a);if(a!=null)for(;a>=0;a--){const b=this.Wcb(a);if(b)return b}}forEach(a){this.Fj.forEach((b,c)=>{(b=this.get(c))&&a(b,c)})}create(a,b){b=g(this.Geb(b));this.Fj.create(a,b)}delete(a){this.Fj.delete(a)}constructor(a,b,c){this.Fj=a;this.Geb=b;this.Wcb=c}},DDb=class{get(a){a=this.Ve.get(a);if(a!=null){var b;a:{for(b=a.start;b<=a.end;b++){var c=this.Wcb(b);
if(c){b=c;break a}}b=void 0}a:{for(c=a.end;c>=a.start;c--){const d=this.Wcb(c);if(d){a=d;break a}}a=void 0}if(b!=null&&a!=null)return{start:b,end:a}}}has(a){return this.get(a)!=null}forEach(a){this.Ve.forEach((b,c)=>{(b=this.get(c))&&a(b,c)})}create(a,b){const c=g(this.Geb(b.start));b=g(this.Geb(b.end));this.Ve.create(a,{start:c,end:b})}delete(a){this.Ve.delete(a)}constructor(a,b,c){this.Ve=a;this.Geb=b;this.Wcb=c}},gAb=class extends px{Po(a,b){return new gAb(this.tf,this.domain,this.rows,this.cols,
this.cells,this.attrs,this.bAc,this.qj,this.Jwc,this.axis,a,b)}constructor(a,b,c,d,e,f,h,k,l,m,r,u){super(a,r,u);this.domain=b;this.rows=c;this.cols=d;this.cells=e;this.attrs=f;this.bAc=h;this.qj=k;this.Jwc=l;this.axis=m;this.dJ=(w,y,z)=>new GDb(this.rows,this.cols,this.cells,this.attrs,this.bAc,this.Jwc,this.domain,this.qj,w,y,z)}};var HDb;HDb=class{get mutable(){return this.base.mutable}get yj(){return this.base.yj}destroy(a){mv(this.type,this.Sga(a));this.base.destroy(a)}ji(a){mv(this.type,a.key);this.base.ji(a.value)}snapshot(){return this.base.snapshot()}constructor(a,b,c){this.base=a;this.Sga=b;this.type=c}};
__c.iAb=class extends ox{Fyb(a,b,c){return super.Fyb(a,b,c)}create(a){return super.create(a)}aJ(a,b,c,d,e,f){const h=this.Sga(b);a=this.SI[h].aJ(a,b,new SCb(c,d),this.nMd[h],e,f);return new HDb(a,this.Sga,h)}snapshot(a){const b=this.Rec(a);return this.SI[b].snapshot(a)}Po(a,b){return new __c.iAb(this.domain,this.SI,this.Sga,this.Rec,a,b)}Jm(a,b,c){const d=Cv(this.SI,(h,k)=>sw(new LCb(k),h.bE)),e=Cv(this.SI,h=>h.Oi),f=kyb(a);return this.Po(ww(d,this.xhd,h=>f[b(h)]),ww(e,this.Sga,h=>f[c(h)]))}xhd(a){return a.key}constructor(a,
b,c,d,e,f){super(e,f);this.domain=a;this.SI=b;this.Sga=c;this.Rec=d;this.nMd=Cv(this.SI,(h,k)=>l=>({key:k,value:l}));Cv(this.SI,(h,k)=>l=>{mv(k,l.key);return l.value})}};__c.iAb.prototype.vs=ba(120);var IDb=class{get yj(){return!1}get mutable(){return 1}destroy(a){mv(a,1)}ji(a){mv(a,1)}snapshot(){return 1}};IDb.instance=new IDb;var kAb=class extends ox{aJ(){return IDb.instance}snapshot(a){return a}Po(a,b){return new kAb(this.domain,a,b)}constructor(a,b,c){super(b,c);this.domain=a}};var JDb;JDb=Symbol.iterator;
var KDb=class{static C(a){qb(a,{values:Ww.struct})}fj(){this.vf?.fj()}get yj(){return this.map.$F}ji(a){for(const [b,c]of a)(a=(this.map.get().get(b)||0)+c)?this.map.get().set(b,a):this.map.get().delete(b);Cw(this.ve)}snapshot(){return this.ve.snapshot()}ZM(){return new Map(this.map.get())}destroy(a){na(this.domain.ni(this.snapshot(),a))}add(a){const b=this.map.get().get(a)||0;b>0||this.ve.tu(new Map([[a,-b+1]]))}delete(a){const b=this.map.get().get(a)||0;b&&this.ve.tu(new Map([[a,-b]]))}has(a){return(this.map.get().get(a)||
0)>0}get values(){return[...vAb(this.map.get(),a=>a>0).keys()]}[JDb](){return this.values[Symbol.iterator]()}constructor(a,b,c,d){this.domain=a;this.ve=b;this.vf=c;this.map=(KDb.C(this),void 0);this.map=new mx(Yw.map(d,{deep:!1}),this.vf?this:void 0)}},wAb=class extends px{Po(a,b){return new wAb(this.tf,this.domain,a,b)}constructor(a,b,c,d){super(a,c,d);this.domain=b;this.dJ=(e,f,h)=>new KDb(this.domain,e,f,h)}};Y=__c.Y=function({Mz:a,tf:b}){a={Mz:a,tf:b};b=Bzb(a);const c=Izb({...a,Ci:b}),d=uAb(),e=zzb({...a,Ci:d});return{...Ryb(a),...Xyb({...a,Ci:{...e,...d}}),...dzb(a),...gzb(a),...lzb({...a,Ci:d}),...pzb(a),...vzb(a),...xzb(a),...e,...b,...Fzb(a),...c,...Qzb(a),...Tzb(a),...Zzb(a),...aAb(a),...hAb({...a,Ci:{...b,...c}}),...jAb(a),...lAb(a),...xAb(a),...d}}({Mz:function(a){const b=a?.tf||new HCb,c=new IAb(b);a=new DCb(b);const d=(C,F)=>new FCb(b,C,F);var e=()=>d((C,F)=>C===F,C=>C);const f=e(),h=e();e=e();
const k=C=>new hBb(b,C,new gBb(C)),l=k(h),m=k(f),r=C=>new BCb(b,C,new GCb(C)),u=new MBb(b),w=new QBb(b,c),y=hCb.create(b,w,c),z=new __c.zCb(b),A=new sBb(b,new JAb(b,(C,F,G)=>F===G,c),c);return{axis:c,unit:a,value:d,literal:()=>d((C,F)=>C===F,C=>C),union:(C,F)=>new CCb(b,r(C),F),number:f,string:h,boolean:e,box:k,Jyf:l,Gcf:m,sum:r,Au:C=>new ABb(b,k(new bx(b,C))),reference:C=>new iCb(b,C),option:C=>new bx(b,C),list:C=>new LBb(b,k(new bx(b,C))),never:u,sheet:(C,F,G,K)=>new ACb(b,C,F,G,K,c,y,w),qk:w,qj:y,
Zza:C=>new rBb(b,C,A,c),cvb:C=>new JAb(b,C,c),nve:()=>new $Ab(b),selection:z,BY:C=>new __c.gx(b,C),PBc:(C,F)=>new __c.pCb(b,new __c.gx(b,C),new $Ab(b),F),Hv:A,counter:new wBb(b),ltc:new xBb(b),w$c:()=>new zBb(b)}}({tf:ICb}),tf:ICb});__c.LDb=/^#[0-9a-f]{6}$/;na(/^[0-9a-zA-Z]+$/.test("none"));__c.MDb=RegExp("^none$|^XB[0-9b-df-hj-np-tv-zB-DF-HJ-NP-TV-Z]{14}$");__c.qx=B(()=>({oldState:__c.R(1),newState:__c.R(2)}));__c.rx=B(()=>({oldState:__c.oj(1),newState:__c.oj(2)}));__c.sx=B(()=>({oldState:__c.rj(1),newState:__c.rj(2)}));__c.tx=B(()=>({oldState:pj(1),newState:pj(2)}));__c.ux=B(()=>({oldState:__c.sj(1),newState:__c.sj(2)}));__c.vx=B(()=>({oldState:__c.qj(1),newState:__c.qj(2)}));__c.NDb=B(()=>({oldState:__c.tj(1),newState:__c.tj(2)}));__c.ODb=B(()=>({oldState:__c.uj(1),newState:__c.uj(2)}));__c.wx=B(()=>({oldState:__c.O(1),newState:__c.O(2)}));__c.xx=B(()=>({oldState:__c.P(1),newState:__c.P(2)}));__c.PDb=B(()=>({oldState:__c.yj(1),newState:__c.yj(2)}));__c.yx=B(()=>({oldState:__c.xj(1),newState:__c.xj(2)}));__c.zx=B(()=>({oldState:(0,__c.Ej)(1),newState:(0,__c.Ej)(2)}));__c.QDb=B(()=>({oldState:q(1,__c.Agb),newState:q(2,__c.Agb)}));__c.RDb=B(()=>({oldState:t(1,__c.kq),newState:t(2,__c.kq)}));__c.SDb=B(()=>({L4:t(2,__c.zx)}));__c.TDb=B(()=>({oldState:__c.vj(1),newState:__c.vj(2)}));var UDb=B(()=>({type:p("A?",1,"UPDATE")}));var VDb=B(()=>({type:p("A?",2,"REPLACE"),oldState:__c.P(1),newState:__c.P(2)}));var WDb=__c.D(()=>({type:[1,UDb,2,VDb]}),()=>({}));__c.XDb=B(()=>({Jb:(0,__c.Gj)(1,WDb)}));__c.YDb=B(()=>({Ymc:(0,__c.Cj)(1)}));__c.ZDb=B(()=>({}));var $Db=B(()=>({type:p("A?",1,"UPDATE"),delta:t(1,__c.ZDb)}));var aEb=B(()=>({type:p("A?",2,"REPLACE"),oldState:t(1,__c.Kq),newState:t(2,__c.Kq)}));var bEb=__c.D(()=>({type:[1,$Db,2,aEb]}),()=>({}));var cEb=B(()=>({Jb:(0,__c.Gj)(1,bEb)}));__c.dEb=B(()=>({oldState:x(1,__c.Or),newState:x(2,__c.Or)}));__c.eEb=B(()=>({oldState:t(1,__c.lq),newState:t(2,__c.lq)}));__c.Ax=B(()=>({oldState:x(1,__c.bq),newState:x(2,__c.bq)}));__c.fEb=B(()=>({oldState:q(1,Zp),newState:q(2,Zp)}));__c.gEb=B(()=>({oldState:t(1,Zp),newState:t(2,Zp)}));__c.hEb=B(()=>({oldState:t(1,__c.Yr),newState:t(2,__c.Yr)}));__c.iEb=B(()=>({oldState:q(1,__c.ls),newState:q(2,__c.ls)}));var sEb,tEb,uEb,wEb,Lx,zEb,AEb,Ox,BEb,CEb,DEb,NEb,WEb,YEb,cFb;__c.Bx=Ew(Y.tc(Y.boolean),T(__c.qx));__c.Cx=Ew(Y.tc(Y.double),T(__c.rx));__c.Dx=Ew(Y.pf(Y.double),T(__c.sx));__c.Ex=Ew(Y.tc(Y.VC),T(__c.tx));__c.jEb=Ew(Y.pf(Y.VC),T(__c.ux));__c.kEb=Ew(Y.tc(Y.P1),T(__c.vx));__c.lEb=Ew(Y.pf(Y.P1),T(__c.NDb));Ew(Y.tc(Y.double),T(__c.vx));__c.mEb=Ew(Y.pf(Y.double),T(__c.NDb));__c.Fx=Ew(Y.tc(Y.cA),T(__c.rx));__c.nEb=Ew(Y.tc(Y.yyc),T(__c.rx));__c.Gx=Ew(Y.pf(Y.cA),T(__c.sx));__c.oEb=Ew(Y.tc(Y.Xtc),T(__c.ODb));
__c.Hx=Ew(Y.tc(Y.string),T(__c.wx));__c.Ix=Ew(Y.pf(Y.string),T(__c.xx));__c.pEb=Ew(Y.pf(Y.boolean),T(__c.PDb));__c.Jx=Ew(Y.tc(Y.yHc),T(__c.yx));__c.qEb=Ew(Y.tc(Y.n9a(Y.string,Y.string)),T(__c.zx));__c.rEb=Y.ce({id:Y.string,version:Y.VC}).Ea(T(__c.kq));sEb=Y.ce({type:Y.literal("RESOLVED"),id:Y.string,version:Y.VC}).Ea(T(__c.jq));tEb=Y.ce({type:Y.literal("UNRESOLVED"),token:Y.string}).Ea(__c.yw(__c.zgb));
uEb=Y.DZ({RESOLVED:sEb,UNRESOLVED:tEb},a=>a.type).Jm({RESOLVED:"RESOLVED",UNRESOLVED:"UNRESOLVED"},a=>a.type);__c.vEb=Ew(Y.tc(uEb),T(__c.QDb));wEb=__c.Hw(Y.literal("font","media","video","audio","embed","scene","blueprint"),{font:1,media:2,video:3,audio:4,embed:5,scene:6,blueprint:7});__c.xEb=Y.ce({type:wEb,id:Y.string,version:Y.VC}).Ea(T(__c.Rhb));__c.yEb=Ew(Y.pf(__c.rEb),T(__c.RDb));__c.Kx=Y.La({values:{app:__c.rEb},attributes:{L4:__c.qEb}}).Ea(T(__c.SDb),T(__c.Nq));Lx=Y.number(-1,1);
zEb=Y.number(0,100);AEb=Y.number(-100,100);__c.Mx=Y.number(0,1);__c.Nx=Y.number(-180,180);Ox=T(__c.rx);BEb=T(__c.sx);CEb=T(__c.xx);DEb=T(__c.TDb);Ew(Y.tc(Lx),Ox);__c.Px=Ew(Y.tc(zEb),Ox);__c.Qx=Ew(Y.tc(AEb),Ox);__c.Rx=Ew(Y.tc(__c.Mx),Ox);__c.EEb=Ew(Y.tc(__c.Nx),Ox);Ew(Y.pf(__c.Nx),BEb);__c.Sx=Y.regexp(__c.LDb);__c.FEb=Ew(Y.tc(__c.Sx),T(__c.wx));__c.GEb=Ew(Y.tc(Y.xF(__c.Sx)),T(__c.yx));__c.HEb=Y.optional(__c.Sx);__c.IEb=Ew(Y.tc(__c.HEb),CEb);__c.JEb=Y.regexp(/^100%$/);__c.KEb=Y.regexp(/^[0-9]+(\.[0-9]+)?%$/);
__c.LEb=Y.regexp(/^[0-9]+(\.[0-9]+)?px/);__c.Tx=__c.Gw(Y.Au(Y.Lv(Y.string)),T(__c.XDb),tw({delta:void 0},new UDb({})),T(VDb));__c.MEb=Y.a0d.Po({serialize:a=>new __c.YDb({Ymc:a}),deserialize:a=>a.Ymc},rw);__c.Gw(Y.Au(Y.unit),T(cEb),tw({delta:void 0},new $Db({})),tw({oldState:void 0,newState:void 0},new aEb({})));NEb=Y.Uxd(0,10);__c.OEb=Y.xF(NEb,a=>a.length<=10);__c.PEb=Ew(Y.tc(__c.OEb),DEb);__c.QEb=Y.regexp(yAb("L"));__c.REb=Y.regexp(yAb("T"));__c.SEb=Y.regexp(yAb("X"));
__c.TEb=Ew(Y.tc(Y.literal(1,2,3)),T(__c.dEb));__c.UEb=Y.ce({text:Y.string,Tcc:Y.boolean}).Ea(T(__c.lq));__c.VEb=Ew(Y.pf(__c.UEb),T(__c.eEb));WEb=Y.literal(1,2);__c.XEb=Ew(Y.tc(WEb),T(__c.Ax));YEb=Y.ce({top:Y.double,left:Y.double}).Ea(T(Zp));__c.ZEb=Ew(Y.tc(YEb),T(__c.fEb));__c.$Eb=Ew(Y.pf(YEb),T(__c.gEb));__c.aFb=Y.ce({width:Y.cA,height:Y.cA}).Ea(T(__c.Yr));__c.bFb=Ew(Y.pf(__c.aFb),T(__c.hEb));cFb=Y.ce({top:Y.double,left:Y.double,height:Y.cA,width:Y.cA}).Ea(T(__c.ls));__c.dFb=Ew(Y.tc(cFb),T(__c.iEb));
__c.eFb=Y.ce({text:Y.string,user:Y.string,brand:Y.string}).Ea(T(__c.$r));__c.fFb=Y.ce({text:Y.string,url:Y.string}).Ea(T(__c.Ekb));__c.nx=B(()=>({La:pj(1),zj:pj(2)}));__c.gFb=B(()=>({type:p("A?",1,"REPLACE"),oldState:t(1,__c.Hhb),newState:t(2,__c.Hhb)}));var hFb=B(()=>({oldState:t(1,__c.Fq),newState:t(2,__c.Fq)}));var iFb=B(()=>({oldState:t(1,__c.Gq),newState:t(2,__c.Gq)}));var jFb=B(()=>({oldState:t(1,__c.Hq),newState:t(2,__c.Hq)}));var kFb=B(()=>({oldState:t(1,__c.Iq),newState:t(2,__c.Iq)}));var lFb=B(()=>({rotate:t(1,hFb),tFb:t(2,iFb),lTb:t(3,jFb),r2b:t(4,kFb)}));__c.mFb=B(()=>({type:p("A?",2,"UPDATE"),delta:t(1,lFb)}));__c.nFb=B(()=>({type:p("A?",1,"REPLACE"),oldState:t(1,__c.Jq),newState:t(2,__c.Jq)}));var oFb=B(()=>({oldState:x(1,__c.qgb),newState:x(2,__c.qgb)}));var pFb=B(()=>({oldState:x(1,__c.rgb),newState:x(2,__c.rgb)}));var qFb=B(()=>({trigger:t(2,oFb),Hac:t(3,pFb)}));var rFb=B(()=>({type:p("A?",1,"RETAIN"),length:pj(1)}));var sFb=B(()=>({type:p("A?",2,"EXPAND"),length:pj(1)}));var tFb=B(()=>({type:p("A?",3,"RETOMB"),length:pj(1)}));var uFb=B(()=>({type:p("A?",4,"INSERT"),state:t(1,__c.$p),shift:t(2,__c.nx)}));var vFb=B(()=>({type:p("A?",5,"UPDATE"),delta:t(1,qFb),shift:t(2,__c.nx)}));var wFb=B(()=>({type:p("A?",6,"CHANGE"),oldState:t(1,__c.$p),newState:t(2,__c.$p),shift:t(3,__c.nx)}));var xFb=__c.D(()=>({type:[1,rFb,2,sFb,3,tFb,4,uFb,5,vFb,6,wFb]}),()=>({}));var yFb=B(()=>({Jb:__c.v(1,xFb)}));var zFb,AFb,BFb,CFb,EFb,FFb,GFb,HFb,JFb,KFb,LFb,MFb,NFb,OFb,PFb,QFb,RFb,TFb;zFb=Y.ce({video:Y.string}).Ea(T(__c.Ahb));AFb=Y.ce({Dg:Y.Cwc,mask:Y.optional(zFb)}).Ea(T(__c.Bhb));BFb=Y.ce({Dg:Y.Cwc,mask:Y.optional(zFb),reverse:Y.SLd}).Ea(T(__c.Chb));CFb=Y.ce({vfc:Y.xF(Y.int32),xfc:Y.xF(Y.int32),rfc:Y.xF(Y.VC),easing:Y.literal(1,2,3,4,5),Dg:Y.ULd,Qwc:Y.boolean}).Ea(T(__c.Ehb));
__c.DFb=Y.ce({DH:Y.d2,scale:Y.d2,direction:Y.optional(Y.literal(1,2,3,4,5)),GIc:Y.optional(Y.literal(1,2,3,4,5)),color:Y.T7,Fo:Y.optional(AFb),ada:Y.optional(BFb),$6b:Y.optional(CFb)}).Ea(T(__c.Eq));EFb=Y.ce({type:Y.literal("none")}).Ea(T(__c.xhb));FFb=Y.ce({type:Y.literal("sequenced"),animation:Y.VC,SA:Y.optional(__c.DFb)}).Ea(T(__c.Fhb));GFb=Y.ce({type:Y.literal("independent"),animation:Y.VC,SA:Y.optional(__c.DFb)}).Ea(T(__c.Ghb));
HFb=Y.DZ({none:EFb,sequenced:FFb,independent:GFb},a=>a.type).Jm({none:"NONE",sequenced:"SEQUENCED",independent:"INDEPENDENT"},a=>a.type);__c.IFb=Ew(Y.pf(HFb),T(__c.gFb));JFb=Y.ce({DH:Lx,direction:Y.literal(1,2)}).Ea(T(__c.Fq));KFb=Ew(Y.pf(JFb),T(hFb));LFb=Y.ce({DH:Lx,IRd:Y.boolean}).Ea(T(__c.Gq));MFb=Ew(Y.pf(LFb),T(iFb));NFb=Y.ce({DH:Lx,direction:Y.literal(1,2)}).Ea(T(__c.Hq));OFb=Ew(Y.pf(NFb),T(jFb));PFb=Y.ce({DH:Lx}).Ea(T(__c.Iq));QFb=Ew(Y.pf(PFb),T(kFb));
RFb=Y.La({attributes:{rotate:KFb,tFb:MFb,lTb:OFb,r2b:QFb}}).Ea(T(lFb),T(__c.Jq));__c.SFb=__c.Fw(Y.box(Y.optional(RFb)),T(__c.mFb),T(__c.nFb));TFb=Y.La({values:{RA:Y.string},attributes:{trigger:Ew(Y.tc(Y.literal(1)),T(oFb)),Hac:Ew(Y.tc(Y.literal(1)),T(pFb))}}).Ea(T(qFb),T(__c.$p));__c.UFb=__c.Jw(Y.list(TFb),T(yFb),T(rFb),T(sFb),T(tFb),T(uFb),T(vFb),T(wFb));
}).call(globalThis, globalThis._456c437108d2d2713799e19380be528d);}

}])
//# sourceMappingURL=sourcemaps/fff6c80551543fb2.js.map