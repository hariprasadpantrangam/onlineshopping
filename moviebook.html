<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Movie Booking</title>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>

  <style>
    .movies {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }
    .movie {
      text-align: center;
    }
    .seat-row {
      margin-bottom: 10px;
    }
    .seat {
      padding: 10px;
      margin: 3px;
      background-color: lightgray;
      cursor: pointer;
    }
    .seat.selected {
      background-color: green;
      color: white;
    }
    .scanner {
      border: 2px dashed black;
      padding: 20px;
      margin-top: 20px;
    }
    .back-btn {
      margin-top: 15px;
      padding: 8px 15px;
      background: crimson;
      color: white;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <script>
    const movies = [
      { id: 1, name: "Avengers", image: "../onlineshopping/public/avengers.jpg"},
      { id: 2, name: "Baahubali", image: "../onlineshopping/public/avengers.jpg" },
      { id: 3, name: "KGF", image: "../onlineshopping/public/avengers.jpg" },
      { id: 4, name: "Pushpa", image: "../onlineshopping/public/avengers.jpg" }
    ];

    const seatRows = ["A","B","C","D","E"];
    const seatsPerRow = 10;

    let selectedMovie = null;
    let selectedSeats = [];
    let selectedDateTime = "";

    const app = document.getElementById("app");

    function renderMovies() {
      app.innerHTML = "<h2>Select a Movie</h2>";
      const movieContainer = document.createElement("div");
      movieContainer.className = "movies";

      movies.forEach((movie) => {
        const div = document.createElement("div");
        div.className = "movie";
        div.innerHTML = `
          <img src="${movie.image}" alt="${movie.name}" width="150" height="200" />
          <h3>${movie.name}</h3>
          <button>Book</button>
        `;
        div.querySelector("button").addEventListener("click", () => {
          selectedMovie = movie;
          selectedSeats = [];
          selectedDateTime = "";
          renderSeats();
        });
        movieContainer.appendChild(div);
      });

      app.appendChild(movieContainer);
    }

    function getSeatPrice(seat) {
      const row = seat.charAt(0);
      if (row === "A" || row === "B") return 300;
      return 200;
    }

    function renderSeats() {
      app.innerHTML = `<h2>Select Seats for ${selectedMovie.name}</h2>`;
      seatRows.forEach((row) => {
        const rowDiv = document.createElement("div");
        rowDiv.className = "seat-row";
        for (let i = 1; i <= seatsPerRow; i++) {
          const seat = row + i;
          const btn = document.createElement("button");
          btn.textContent = seat;
          btn.className = "seat";
          btn.addEventListener("click", () => {
            if (selectedSeats.includes(seat)) {
              selectedSeats = selectedSeats.filter((s) => s !== seat);
              btn.classList.remove("selected");
            } else {
              selectedSeats.push(seat);
              btn.classList.add("selected");
            }
            renderBookButton();
          });
          rowDiv.appendChild(btn);
        }
        app.appendChild(rowDiv);
      });

      const backBtn = document.createElement("button");
      backBtn.textContent = "‚¨Ö Back to Movies";
      backBtn.className = "back-btn";
      backBtn.onclick = () => {
        selectedMovie = null;
        renderMovies();
      };
      app.appendChild(backBtn);
    }

    function renderBookButton() {
      let bookDiv = document.getElementById("bookDiv");
      if (!bookDiv) {
        bookDiv = document.createElement("div");
        bookDiv.id = "bookDiv";
        app.appendChild(bookDiv);
      }
      if (selectedSeats.length > 0) {
        const totalPrice = selectedSeats.reduce((sum, seat) => sum + getSeatPrice(seat), 0);
        bookDiv.innerHTML = `
          <h3>Total Price: ‚Çπ${totalPrice}</h3>
        <img src="../onlineshopping/public/gpay.jpg" width="100" height="100" />
          <label>Select Date & Time: </label>
          <input type="datetime-local" id="dateTimeInput" />
          <button id="bookBtn">Book</button>
        `;
        document.getElementById("bookBtn").addEventListener("click", () => {
          const dateTimeInput = document.getElementById("dateTimeInput");
          selectedDateTime = dateTimeInput.value;
          if (!selectedDateTime) {
            alert("Please select date and time before booking!");
            return;
          }
          const confirmBooking = confirm("Do you want to confirm payment?");
          if (confirmBooking) {
            renderScanner(totalPrice);
          } else {
            app.innerHTML = "<h2>‚ùå Payment Cancelled</h2>";
            const backBtn = document.createElement("button");
            backBtn.textContent = "‚¨Ö Back to Movies";
            backBtn.className = "back-btn";
            backBtn.onclick = () => {
              selectedMovie = null;
              renderMovies();
            };
            app.appendChild(backBtn);
          }
        });
      } else {
        bookDiv.innerHTML = "";
      }
    }

    function renderScanner(totalPrice) {
      app.innerHTML = `
        <div class="scanner">
          <h2>üì∑ Booking confirmed!</h2>
          <p><strong>Movie:</strong> ${selectedMovie.name}</p>
          <p><strong>Seats:</strong> ${selectedSeats.join(", ")}</p>
          <p><strong>Total Price:</strong> ‚Çπ${totalPrice}</p>
          <p><strong>Date & Time:</strong> ${selectedDateTime}</p>
          
          <img src="${selectedMovie.image}" alt="scanner" width="200" height="250" />
        </div>
      `;
      const backBtn = document.createElement("button");
      backBtn.textContent = "‚¨Ö Back to Movies";
      backBtn.className = "back-btn";
      backBtn.onclick = () => {
        selectedMovie = null;
        renderMovies();
      };
      app.appendChild(backBtn);
    }

    // Initial render
    renderMovies();
  </script>
  <a href="index.html">back to home</a>
</body>
</html>
